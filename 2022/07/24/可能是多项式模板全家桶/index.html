<!DOCTYPE html>
<html>
  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  <meta name="description" content="iinattr&#39;s blog">
  <meta name="keyword" content="iinattr">
  
    <link rel="shortcut icon" href="/css/images/logo.png">
  
  <title>
    
      iinattr
    
  </title>
  <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <link href="//cdnjs.cloudflare.com/ajax/libs/nprogress/0.2.0/nprogress.min.css" rel="stylesheet">
  <link href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/tomorrow.min.css" rel="stylesheet">
  
<link rel="stylesheet" href="/css/style.css">

  
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/geopattern/1.2.3/js/geopattern.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/nprogress/0.2.0/nprogress.min.js"></script>
  
  
  
  


  
  
    
<script src="/js/local-search.js"></script>


<meta name="generator" content="Hexo 6.2.0"></head>
<div class="wechat-share">
  <img src="/css/images/logo.png" />
</div>
  <body>
    <header class="header fixed-header">
  <div class="header-container">
    <a class="home-link" href="/">
      <div class="logo"></div>
      <span>iinattr</span>
    </a>
    <ul class="right-list">
      
        <li class="list-item">
          
            <a href="/" class="item-link">Home</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/series/" class="item-link">Series</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/tags/" class="item-link">Tags</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/archives/" class="item-link">Archives</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/project/" class="item-link">Projects</a>
          
        </li>
      
        <li class="list-item">
          
            <a href="/about/" class="item-link">About</a>
          
        </li>
      
      
        <li class="menu-item menu-item-search right-list">
    <a role="button" class="popup-trigger">
        <i class="fa fa-search fa-fw"></i>
    </a>
</li>
      
    </ul>
    <div class="menu">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </div>
    <div class="menu-mask">
      <ul class="menu-list">
        
          <li class="menu-item">
            
              <a href="/" class="menu-link">Home</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/series/" class="menu-link">Series</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/tags/" class="menu-link">Tags</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/archives/" class="menu-link">Archives</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/project/" class="menu-link">Projects</a>
            
          </li>
        
          <li class="menu-item">
            
              <a href="/about/" class="menu-link">About</a>
            
          </li>
        
      </ul>
    </div>
    
      <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
            <span class="search-icon">
                <i class="fa fa-search"></i>
            </span>
            <div class="search-input-container">
                <input autocomplete="off" autocapitalize="off"
                    placeholder="Please enter your keyword(s) to search." spellcheck="false"
                    type="search" class="search-input">
            </div>
            <span class="popup-btn-close">
                <i class="fa fa-times-circle"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>
    
  </div>
</header>

    <div id="article-banner">
  <h2></h2>
  <p class="post-date">2022-07-24</p>
  <div class="arrow-down">
    <a href="javascript:;"></a>
  </div>
</div>
<main class="app-body flex-box">
  <!-- Article START -->
  <article class="post-article">
    <section class="markdown-content"><h1 id="可能是多项式模板全家桶"><a href="#可能是多项式模板全家桶" class="headerlink" title="可能是多项式模板全家桶"></a>可能是多项式模板全家桶</h1><h1 id="不到-万字长文"><a href="#不到-万字长文" class="headerlink" title="(不到)万字长文"></a>(不到)万字长文</h1><h1 id="或许是较好理解的板子讲解"><a href="#或许是较好理解的板子讲解" class="headerlink" title="或许是较好理解的板子讲解"></a>或许是较好理解的板子讲解</h1><p>本文无代码 否则您将学习每天一个常数爆炸小技巧</p>
<p>qwq</p>
<p>阅读本文约需9分钟:</p>
<p><img src="https://i.loli.net/2021/07/10/5n41cEs3UOlhH69.png" alt="image-20210710093833431"></p>
<h2 id="前置知识"><a href="#前置知识" class="headerlink" title="前置知识:"></a>前置知识:</h2><h3 id="复数"><a href="#复数" class="headerlink" title="复数"></a>复数</h3><h4 id="虚数单位"><a href="#虚数单位" class="headerlink" title="虚数单位"></a>虚数单位</h4><p>虚数单位$i&#x3D;\sqrt{(-1)}$</p>
<h4 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h4><p>复数是形如$a+bi$的数</p>
<h4 id="运算"><a href="#运算" class="headerlink" title="运算"></a>运算</h4><h5 id="加法"><a href="#加法" class="headerlink" title="加法"></a>加法</h5><p>复数 $x&#x3D;(a+bi),y&#x3D;(c+di)$的和定义为 $x+y&#x3D;(a+bi)+(c+di)&#x3D;a+c+(d+b)i$</p>
<h5 id="乘法"><a href="#乘法" class="headerlink" title="乘法"></a>乘法</h5><p>复数 $x&#x3D;(a+bi),y&#x3D;(c+di)$的积定义为$xy&#x3D;(a+bi)(c+di)&#x3D;ac-bd+(ad+cb)i$</p>
<p>发现复数可以用座标表示 如$x&#x3D;(a+bi)$可表示为$(a,b)$ 这样也可以表示为向量 我们记模长为$r&#x3D;\sqrt{a^2+b^2}$ 俯角为$\alpha$ 于是向量表示为$(rcos\alpha,rsin\alpha)$ 发现一个性质 两向量的积$(rcos\alpha,rsin\alpha)(Rcos\beta,Rsin\beta)$等于$(rRcos(\alpha+\beta),rRsin(\alpha+\beta))$ 模长相乘俯角相加</p>
<h3 id="单位根"><a href="#单位根" class="headerlink" title="单位根"></a>单位根</h3><p>单位根是形如这样的方程的所有的根:<br>$$<br>x^n&#x3D;1<br>$$<br>根据算数基本定理 这样的根在复数域上有n个</p>
<p>我们记第一个为$w_n$ 它应当是某个复数 我们知道 复数乘法满足模长相差俯角相加 那么它在复数域上的几何表示就是单位圆$n$等分后从(0,1)开始转的第一份</p>
<p>我么发现 第一个单位根的k次方$(0&lt;&#x3D;k&lt;&#x3D;n-1)$也是一个单位根</p>
<p>单位根具有以下性质 希望读者自行验证:</p>
<p>1 $w_n^k&#x3D;w_{n&#x2F;2}^{k&#x2F;2}$</p>
<p>2 $w_n^{k+n}&#x3D;w_n^k$</p>
<p>3 $w_n^{k+n&#x2F;2}&#x3D;-w_n^k$</p>
<p>4 $w_n^0&#x3D;w_n^n&#x3D;1$</p>
<h3 id="原根"><a href="#原根" class="headerlink" title="原根"></a>原根</h3><h4 id="阶"><a href="#阶" class="headerlink" title="阶"></a>阶</h4><p>对于一个数 a 一个模数 p 存在最小的 y使得<br>$$<br>a^y\equiv1\pmod p<br>$$</p>
<h4 id="定义-1"><a href="#定义-1" class="headerlink" title="定义"></a>定义</h4><p>若对于一个模数p 存在一个a使得a对p的阶等于phi(p) 那么a就叫做p的原根</p>
<h4 id="性质"><a href="#性质" class="headerlink" title="性质"></a>性质</h4><p>$a^0,a^1,a^2,⋯,a^{\varphi(p)}$ 模 p 两两不同余，且 $a^k\equiv a^{k+\varphi(p)}\pmod p$</p>
<h3 id="泰勒展开"><a href="#泰勒展开" class="headerlink" title="泰勒展开"></a>泰勒展开</h3><p>回忆微分法</p>
<p>熟知对于一点$x_0$ 我们试图寻找其邻域的某点$x$及其函数值$f(x)$ 我们应该构造关于$(x-x_0)$的一次多项式 $p(x)&#x3D;f(x_0)+f’(x_0)(x-x_0)$  使得$p’(x-x_0)&#x3D;f’(x_0)$</p>
<p>发现该微分法存在以下突出问题:</p>
<ul>
<li>精度损失不确定</li>
<li>精度损失较大</li>
</ul>
<p>于是我们期望能够得到一个多项式$p(x)$ 使得<br>$$<br>p(x)&#x3D;\sum_{i&#x3D;0}^{n}a_i(x-x_0)^i<br>$$<br>并且$p^{(i)}(x-x_0)&#x3D;f^{(n)}(x_0)$</p>
<p>于是设x&#x3D;0连续求导后 $a_i&#x3D;\frac{f^{(i)}(x)}{i!}$</p>
<h3 id="牛顿迭代"><a href="#牛顿迭代" class="headerlink" title="牛顿迭代"></a>牛顿迭代</h3><p>发现我们在对精度要求不高时可以使用导数(直线)近似代替原函数来近似求解函数根</p>
<p>若对精度要求更高重复使用即可 </p>
<p>这样我们引出迭代公式<br>$$<br>在(x_0,f(x_0))处的切线方程为y-f(x_0)&#x3D;f’(x_0)(x-x_0)<br>\<br>于是x&#x3D;x_0-\frac{f(x_0)}{f’(x_0)}<br>$$</p>
<h2 id="FFT"><a href="#FFT" class="headerlink" title="FFT"></a>FFT</h2><p>fft是解决多项式乘法(加法卷积)的一种方法</p>
<p>我们发现加法卷积复杂度极高 这是不能被我们承受的</p>
<p>考虑讲要卷的两个多项式求出点值表示 然后把点值相乘 然后插值回答案多项式</p>
<h3 id="DFT"><a href="#DFT" class="headerlink" title="DFT"></a>DFT</h3><p>dft是进行多项式多点求值的算法 我们发现多项式<br>$$<br>f(x)&#x3D;a_0+a_1x^1+a_2x^2+a_3x^3+a_4x^4+a_5x^5…<br>\<br>可以拆分为<br>\<br>fl(x)&#x3D;a_0+a_2x^1+a_4x^2+a_6x^3…<br>\和\<br>fr(x)&#x3D;a_1+a_3x^1+a_5x^2+a7x^3…<br>\于是\<br>f(x)&#x3D;fl(x^2)+xfr(x^2)<br>\我们试着将单位根带入\<br>f(w_n^k)&#x3D;fl(w_n^{2k})+w_n^kfr(w_n^{2k})&#x3D;fl(w_{n&#x2F;2}^{k})+w_n^kfr(w_{n&#x2F;2}^{k})<br>\并且有\<br>f(w_n^{k+n&#x2F;2})&#x3D;fl(w_n^{2k+n})+w_n^{k+n&#x2F;2}fr(w_n^{2k+n})&#x3D;fl(w_{n&#x2F;2}^{k})-w_n^kfr(w_{n&#x2F;2}^{k})<br>$$<br>我们可以分治求解 复杂度$O(nlogn)$</p>
<h3 id="IDFT"><a href="#IDFT" class="headerlink" title="IDFT"></a>IDFT</h3><p>idft是进行多项式多点插值的算法</p>
<p>$(y_0,y_1,y_2…y_{n-1})$为$(a_0,a_1,a_2,…a_{n-1})$的点值表示</p>
<p>那么设另一组数列${c_k}$满足$c_k&#x3D;\sum_{i&#x3D;0}^{n-1}y_i(w_n^{-k})^i$</p>
<p>那么<br>$$<br>c_k&#x3D;\sum_{i&#x3D;0}^{n-1}y_i(w_n^{-k})^i<br>\<br>&#x3D;\sum^{n-1}<em>{i&#x3D;0}(\sum^{n-1}</em>{j&#x3D;0}a_j(w^i_n)^j)(w_n^{-k})^i<br>\<br>&#x3D;\sum^{n-1}<em>{i&#x3D;0}(\sum^{n-1}</em>{j&#x3D;0}a_j(w^j_n)^i)(w_n^{-k})^i<br>\<br>&#x3D;\sum^{n-1}<em>{i&#x3D;0}\sum^{n-1}</em>{j&#x3D;0}a_j(w^{j-k}<em>n)^i<br>\<br>&#x3D;\sum^{n-1}</em>{j&#x3D;0}a_j(\sum^{n-1}_{i&#x3D;0}(w^{j-k}_n)^i)<br>$$</p>
<p>那么 我们发现 对于后半个合式 若$j&#x3D;k$ 取值为$n$</p>
<p>若不等呢:</p>
<p>设$j-k&#x3D;s$</p>
<p>利用等比数列求和公式 </p>
<p>后半个合式等于$\frac{(w_n^s)^n-1}{w_n^s}$</p>
<p>上半部等于0</p>
<p>于是$c_k&#x3D;na_k$</p>
<p>把n除过去即可</p>
<h2 id="NTT"><a href="#NTT" class="headerlink" title="NTT"></a>NTT</h2><p>发现整个fft的过程中都是在做实数运算 精度误差存在且不小 并且复数运算很慢 甚至某些时候需要蝴蝶优化减少递归带来的巨大常数 我们的推导用到了单位根的如下性质:</p>
<p>1 $w_n^k&#x3D;w_{n&#x2F;2}^{k&#x2F;2}$</p>
<p>2 $w_n^{k+n}&#x3D;w_n^k$</p>
<p>3 $w_n^{k+n&#x2F;2}&#x3D;-w_n^k$</p>
<p>4 $w_n^0&#x3D;w_n^n&#x3D;1$</p>
<p>5 n次方内互不相等</p>
<p>惊喜的发现这些性质在模意义下的时原根也具有 </p>
<p>于是在代码中将复数全部换为原根即可</p>
<h2 id="FWT"><a href="#FWT" class="headerlink" title="FWT"></a>FWT</h2><p>fwt是用于解决一类位运算卷积的算法</p>
<h3 id="基本思想与概览"><a href="#基本思想与概览" class="headerlink" title="基本思想与概览"></a>基本思想与概览</h3><p>熟知fft是线性的 我们期望fwt也可以得到一个线性函数</p>
<p>我们首先写出位运算卷积的一般形式:<br>$$<br>S[k]&#x3D;\sum_{i\oplus j&#x3D;k}A[i]B[j]<br>$$<br>记作<br>$$<br>S&#x3D;A*B<br>$$<br>其中$\oplus$是某种位运算</p>
<p>设FWT变换系数为$c(i,j)$ 我们设FWT(A)是A经过FWT变换后的数列</p>
<p>需满足:<br>$$<br>A*B&#x3D;C \iff FWT(A)\cdot FWT(B)&#x3D;FWT(B)<br>$$<br>于是<br>$$<br>FWT(A)[i]&#x3D;\sum^{n-1}<em>{j&#x3D;0}c(i,j)A_j<br>$$<br>依<br>$$<br>FWT(A)\cdot FWT(B)&#x3D;FWT(B)<br>$$<br>得<br>$$<br>FWT(A)[i]FWT(B)[i]&#x3D;FWT(c)[I]<br>\<br>\sum^{n-1}</em>{j&#x3D;0}c(i,j)A[j]\sum^{n-1}<em>{k&#x3D;0}c(i,k)B[k]&#x3D;\sum^{n-1}</em>{p&#x3D;0}c(i,p)C[p]<br>\<br>\sum^{n-1}<em>{j&#x3D;0}\sum^{n-1}</em>{k&#x3D;0}c(i,j)c(i,k)A[j]B[k]&#x3D;\sum^{n-1}<em>{p&#x3D;0}c(i,p)C[p]<br>$$<br>依<br>$$<br>C[p]&#x3D;\sum</em>{t_1\oplus t_2&#x3D;p}A[t_1]B[t_2]<br>$$<br>又得<br>$$<br>\sum^{n-1}<em>{p&#x3D;0}c(i,p)C[p]&#x3D;\sum^{n-1}</em>{p&#x3D;0}c(i,p)\sum_{t_1\oplus t_2&#x3D;p}A[t_1]B[t_2]<br>\<br>\sum^{n-1}<em>{j&#x3D;0}\sum^{n-1}</em>{k&#x3D;0}c(i,j)c(i,k)A[j]B[k]&#x3D;\sum^{n-1}<em>{p&#x3D;0}c(i,p)\sum</em>{t_1\oplus t_2&#x3D;p}A[t_1]B[t_2]<br>\<br>\sum^{n-1}<em>{j&#x3D;0}\sum^{n-1}</em>{k&#x3D;0}c(i,j)c(i,k)A[j]B[k]&#x3D;\sum^{n-1}<em>{t_1&#x3D;0}\sum</em>{t_2&#x3D;0}^{n-1}A[t_1]B[t_2]c(i,t_1\oplus t_2)<br>$$<br>对比发现只需使$c(i,j)c(i,k)&#x3D;c(i,j\oplus k)$</p>
<p>另外 由位运算只考虑独立位的特殊性 我们有:</p>
<p>对于一个二进制数a 它的每一位表示为$a_0,a_1,a_2,a_3,a_4,….$</p>
<p>设我们已经知道所有满足要求的c([0,1],[0,1])</p>
<p>那么<br>$$<br>c(i,j)&#x3D;c(i_0,j_0)c(i_1,j_1)c(i_2,j_2),…<br>$$<br>于是<br>$$<br>\prod_p c(i_p,j_p)c(i_p,k_p)&#x3D;\prod_p c(i_p,j_p\oplus k_p)<br>\<br>c(i,j)c(i,k)&#x3D;c(i,j\oplus k)<br>$$<br>由此 只要我们构造出单位的c函数 我们就可以构造出所有数的c函数</p>
<p>我们如何快速求位运算卷积呢</p>
<p>依然考虑分治</p>
<p>首先折半<br>$$<br>FWT(A)[i]&#x3D;\sum_{j&#x3D;0}^{(n&#x2F;2)-1}c(i,j)A[j]+\sum_{j&#x3D;(n&#x2F;2)}^{n-1}c(i,j)A[j]<br>$$<br>对于i,j的首位 我们分开考虑 设i’为i去掉二进制首位的数</p>
<p>于是<br>$$<br>&#x3D;\sum_{j&#x3D;0}^{(n&#x2F;2)-1}c(i_0,j_0)c(i’,j’)A[j]+\sum_{j&#x3D;(n&#x2F;2)}^{n-1}c(i_0,j_0)c(i’,j’)A[j]<br>\<br>&#x3D;c(i_0,0)\sum_{j&#x3D;0}^{(n&#x2F;2)-1}c(i’,j’)A[j]+c(i_0,1)\sum_{j&#x3D;(n&#x2F;2)}^{n-1}c(i_0,j_0)c(i’,j’)A[j]<br>$$<br>加号两边柿子分别递归处理 我们成功缩小了问题的规模</p>
<h3 id="一些例子"><a href="#一些例子" class="headerlink" title="一些例子"></a>一些例子</h3><p>针对不同位运算 我们需要构造出不同的c([0,1],[0,1]) 再结合上面的推导 问题就得到了解决</p>
<h4 id="Or卷积"><a href="#Or卷积" class="headerlink" title="Or卷积"></a>Or卷积</h4><p>c([0&#x2F;1],[0&#x2F;1])的矩阵<br>$$<br>\begin{bmatrix}<br>c(0,0)&amp;c(0,1)\<br>c(1,0)&amp;c(1,1)<br>\end{bmatrix}<br>$$</p>
<p>应满足条件 $c(i,j)c(i,k)&#x3D;c(i,j|k)$ </p>
<ul>
<li>$c(0,0)&#x3D;c(0,0|0)\Rightarrow c(0,0)&#x3D;1或0$</li>
<li>$c(0,1)c(0,0)&#x3D; c(0,1|0)\Rightarrow c(0,1)&#x3D;0或c(0,0)&#x3D;c(0,1)&#x3D;1$</li>
<li>$c(1,1)c(1,0)&#x3D;c(1,1|0)\Rightarrow c(1,1)&#x3D;0或c(1,0)&#x3D;c(1,1)&#x3D;1$</li>
</ul>
<p>并且这个矩阵应当是有逆的 否则就无法回去 我们最终选取</p>
<p>$c(0,0)&#x3D;1,c(0,1)&#x3D;0,c(1,0)&#x3D;1,c(1,1)&#x3D;1$</p>
<p>逆变换其实只需矩阵求逆即可 </p>
<p>或者考虑算式的反算式即可</p>
<p>那么同理对于</p>
<h4 id="And卷积"><a href="#And卷积" class="headerlink" title="And卷积"></a>And卷积</h4><p>有矩阵<br>$$<br>\begin{bmatrix}<br>1&amp;1\<br>0&amp;1<br>\end{bmatrix}<br>$$</p>
<p>和</p>
<h4 id="Xor卷积"><a href="#Xor卷积" class="headerlink" title="Xor卷积"></a>Xor卷积</h4><p>有矩阵<br>$$<br>\begin{bmatrix}<br>1&amp;1\<br>1&amp;-1<br>\end{bmatrix}<br>$$<br>既得易见平凡 仿照上例显然 留作习题答案略 读者自证不难</p>
<p>反之亦然同理 推论自然成立 略去过程Q E D  由上可知证毕 </p>
<p>​	西江月&#x2F;证明</p>
<h2 id="多项式乘法逆"><a href="#多项式乘法逆" class="headerlink" title="多项式乘法逆"></a>多项式乘法逆</h2><p>多项式求逆即对于多项式$f(x)$</p>
<p>我们求一个$g(x)$</p>
<p>使得<br>$$<br>g(x)*f(x)\equiv1 \pmod {x^n}<br>$$</p>
<h3 id="倍增法"><a href="#倍增法" class="headerlink" title="倍增法"></a>倍增法</h3><h4 id="边界"><a href="#边界" class="headerlink" title="边界"></a>边界</h4><p>当界为$\pmod{x^1}$ 即多项式只有常数项时 直接数字逆元即可</p>
<h4 id="转移"><a href="#转移" class="headerlink" title="转移"></a>转移</h4><p>假设我们得到了$T(x)\equiv F(x)^{-1} \pmod {x^{n&#x2F;2}}$</p>
<p>显然有$G(x)\equiv T(x)\pmod{x^{n&#x2F;2}}$</p>
<p>那么 $(G(x)-T(x))^2\equiv0\pmod{x^n}$</p>
<p>$G(x)^2-2G(x)T(x)+T(x)^2\equiv0\pmod{x^n}$</p>
<p>同乘$F(x)$</p>
<p>$R(x)-2G(x)-G(x)^2F(x)\equiv0\pmod{x^n}$</p>
<p>运用多项式乘法倍增即可</p>
<h2 id="多项式开根"><a href="#多项式开根" class="headerlink" title="多项式开根"></a>多项式开根</h2><p>给定$g(x)$ 求$f(x)$满足<br>$$<br>f^2(x)\equiv g(x)\pmod{x^n}<br>$$</p>
<h3 id="倍增法-1"><a href="#倍增法-1" class="headerlink" title="倍增法"></a>倍增法</h3><p>假设已求出$g(x)$在模$x^{[n&#x2F;2]}$意义下的平方根$f_0(x)$ 则有<br>$$<br>f_0^2(x)\equiv g(x) \pmod{x^{[n&#x2F;2]}}<br>\<br>f_0^2(x)-g(x)\equiv 0\pmod{x^{[n&#x2F;2]}}<br>\<br>(f_0^2(x)-g(x))^2\equiv 0\pmod{x^{n}}<br>\<br>(f_0^2(x)+g(x))^2\equiv 4f_0^2(x)g(x)\pmod{x^{n}}<br>\<br>(\frac{f_0^2(x)+g(x)}{2f_0(x)})\equiv g(x)\pmod{x^{n}}<br>\<br>\frac{f_0^2(x)+g(x)}{2f_0(x)}\equiv f(x) \pmod{x^n}<br>\<br>\frac 1 2f_0(x)+2^{-1}f_0^{-1}(x)g(x)\equiv f(x) \pmod{x^n}<br>$$</p>
<h2 id="多项式除法"><a href="#多项式除法" class="headerlink" title="多项式除法"></a>多项式除法</h2><p>给定多项式$f(x),g(x)$ 求$g(x)$除$f(x)$的商$q(x)$和余数$r(x)$</p>
<p>若能消去$r(x)$的影响则可直接多项式乘法逆</p>
<p>考虑构造<br>$$<br>f_r(x)&#x3D;x^nf(\frac 1 x)<br>$$<br>容易发现其为反转$f(x)$系数</p>
<p>设$n&#x3D;\deg f,m&#x3D;\deg g$</p>
<p>则<br>$$<br>f(x)&#x3D;q(x)g(x)+r(x)\Rightarrow<br>\<br>x^nf(\frac 1 x)&#x3D;x^{n-m}q(\frac 1 x)x^mg(\frac 1 x)+x^{n-m+1}x^{m-1}r(\frac 1 x)<br>\<br>f_r(x)&#x3D;q_r(x)g_r(x)+x^{n-m+1}r_r(x)<br>\<br>于是<br>\<br>f_r(x)\equiv q_r(x)g_r(x)\pmod{x^{n-m+1}}<br>$$<br>多项式求逆$g_r(x)$即可 然后求出$q_r(x)$和$r_r(x)$</p>
<h2 id="多项式ln"><a href="#多项式ln" class="headerlink" title="多项式ln"></a>多项式ln</h2><p>给定多项式$f(x)$ 求模$x^n$意义下$lnf(x)$</p>
<p>解法本质就是暴力</p>
<p>对多项式先求导再积分即可<br>$$<br>\frac {\text{d}\ln f(x)}{dx}\equiv \frac {1}{f(x)} f’(x)\pmod{x^n}<br>$$</p>
<h2 id="多项式牛顿迭代"><a href="#多项式牛顿迭代" class="headerlink" title="多项式牛顿迭代"></a>多项式牛顿迭代</h2><p>对于给定$g(x)$ 求$f(x)$ 使得其满足$g(f(x))\equiv 0 \pmod{ x^n}$</p>
<p>假设已经得到了模$x^{[n&#x2F;2]}$次方的解$f_0(x)$ 要求模$x^n$的解$f(x)$</p>
<p>跟据定义我们知道 $f(x)$与$f_0(x)$在前$[n&#x2F;2]-1$位上相等 </p>
<p>那么我们写出$g(f(x))$在$f_0(x)$处的泰勒展开 </p>
<p><img src="https://i.loli.net/2021/07/10/AreopyjgdDlhbU6.png" alt="image-20210710085546653"></p>
<p>发现从第三项往后全部被模掉了 没有意义 我们即可直接用牛顿迭代式计算</p>
<p><img src="https://i.loli.net/2021/07/10/jq9MTVmktfgHaus.png" alt="image-20210710085712805"></p>
<h3 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h3><h4 id="多项式求逆"><a href="#多项式求逆" class="headerlink" title="多项式求逆"></a>多项式求逆</h4><p>给定多项式$h(x)$ 有方程<br>$$<br>g(f(x))&#x3D;\frac1 {f(x)}-h(x)\equiv0\pmod0<br>$$<br>应用牛顿迭代有<br>$$<br>\begin{aligned}<br>    f\left(x\right)&amp;\equiv f_{0}\left(x\right)-\frac{\frac{1}{f_{0}\left(x\right)}-h\left(x\right)}{-\frac{1}{f_{0}^{2}\left(x\right)}}&amp;\pmod{x^{n}}\<br>    &amp;\equiv 2f_{0}\left(x\right)-f_{0}^{2}\left(x\right)h\left(x\right)&amp;\pmod{x^{n}}<br>\end{aligned}<br>$$</p>
<h4 id="多项式开方"><a href="#多项式开方" class="headerlink" title="多项式开方"></a>多项式开方</h4><p>给定多项式$h(x)$ 有方程<br>$$<br>g(f(x))&#x3D;f^2(x)-h(x)\equiv0\pmod{x^n}<br>$$<br>应用牛顿迭代有<br>$$<br>f(x)\equiv f_0(x)-\frac{f_0^2(x)-h(x)}{2f_0(x)}\pmod{x^n}<br>\<br>\equiv\frac{f_0^2(x)+h(x)}{2f_0(x)}\pmod{x^n}<br>$$</p>
<h4 id="多项式exp"><a href="#多项式exp" class="headerlink" title="多项式exp"></a>多项式exp</h4><p>给定多项式$h(x)$ 有方程<br>$$<br>g(f(x))&#x3D;\ln f(x)-h(x)\pmod {x^n}<br>$$<br>应用牛顿迭代有.<br>$$<br>f(x)\equiv f_0(x)-\frac{\ln f_0(x)-h(x)}{\frac1{f_0(x)}}<br>\<br>f_0(x)(1-ln f_0(x)+h(x))\pmod{x^n}<br>$$</p>
<h1 id="可能是多项式模板全家桶-1"><a href="#可能是多项式模板全家桶-1" class="headerlink" title="可能是多项式模板全家桶"></a>可能是多项式模板全家桶</h1><h1 id="不到-万字长文-1"><a href="#不到-万字长文-1" class="headerlink" title="(不到)万字长文"></a>(不到)万字长文</h1><h1 id="或许是较好理解的板子讲解-1"><a href="#或许是较好理解的板子讲解-1" class="headerlink" title="或许是较好理解的板子讲解"></a>或许是较好理解的板子讲解</h1><p>本文无代码 否则您将学习每天一个常数爆炸小技巧</p>
<p>qwq</p>
<p>阅读本文约需9分钟:</p>
<p><img src="https://i.loli.net/2021/07/10/5n41cEs3UOlhH69.png" alt="image-20210710093833431"></p>
<h2 id="前置知识-1"><a href="#前置知识-1" class="headerlink" title="前置知识:"></a>前置知识:</h2><h3 id="复数-1"><a href="#复数-1" class="headerlink" title="复数"></a>复数</h3><h4 id="虚数单位-1"><a href="#虚数单位-1" class="headerlink" title="虚数单位"></a>虚数单位</h4><p>虚数单位$i&#x3D;\sqrt{(-1)}$</p>
<h4 id="定义-2"><a href="#定义-2" class="headerlink" title="定义"></a>定义</h4><p>复数是形如$a+bi$的数</p>
<h4 id="运算-1"><a href="#运算-1" class="headerlink" title="运算"></a>运算</h4><h5 id="加法-1"><a href="#加法-1" class="headerlink" title="加法"></a>加法</h5><p>复数 $x&#x3D;(a+bi),y&#x3D;(c+di)$的和定义为 $x+y&#x3D;(a+bi)+(c+di)&#x3D;a+c+(d+b)i$</p>
<h5 id="乘法-1"><a href="#乘法-1" class="headerlink" title="乘法"></a>乘法</h5><p>复数 $x&#x3D;(a+bi),y&#x3D;(c+di)$的积定义为$xy&#x3D;(a+bi)(c+di)&#x3D;ac-bd+(ad+cb)i$</p>
<p>发现复数可以用座标表示 如$x&#x3D;(a+bi)$可表示为$(a,b)$ 这样也可以表示为向量 我们记模长为$r&#x3D;\sqrt{a^2+b^2}$ 俯角为$\alpha$ 于是向量表示为$(rcos\alpha,rsin\alpha)$ 发现一个性质 两向量的积$(rcos\alpha,rsin\alpha)(Rcos\beta,Rsin\beta)$等于$(rRcos(\alpha+\beta),rRsin(\alpha+\beta))$ 模长相乘俯角相加</p>
<h3 id="单位根-1"><a href="#单位根-1" class="headerlink" title="单位根"></a>单位根</h3><p>单位根是形如这样的方程的所有的根:<br>$$<br>x^n&#x3D;1<br>$$<br>根据算数基本定理 这样的根在复数域上有n个</p>
<p>我们记第一个为$w_n$ 它应当是某个复数 我们知道 复数乘法满足模长相差俯角相加 那么它在复数域上的几何表示就是单位圆$n$等分后从(0,1)开始转的第一份</p>
<p>我么发现 第一个单位根的k次方$(0&lt;&#x3D;k&lt;&#x3D;n-1)$也是一个单位根</p>
<p>单位根具有以下性质 希望读者自行验证:</p>
<p>1 $w_n^k&#x3D;w_{n&#x2F;2}^{k&#x2F;2}$</p>
<p>2 $w_n^{k+n}&#x3D;w_n^k$</p>
<p>3 $w_n^{k+n&#x2F;2}&#x3D;-w_n^k$</p>
<p>4 $w_n^0&#x3D;w_n^n&#x3D;1$</p>
<h3 id="原根-1"><a href="#原根-1" class="headerlink" title="原根"></a>原根</h3><h4 id="阶-1"><a href="#阶-1" class="headerlink" title="阶"></a>阶</h4><p>对于一个数 a 一个模数 p 存在最小的 y使得<br>$$<br>a^y\equiv1\pmod p<br>$$</p>
<h4 id="定义-3"><a href="#定义-3" class="headerlink" title="定义"></a>定义</h4><p>若对于一个模数p 存在一个a使得a对p的阶等于phi(p) 那么a就叫做p的原根</p>
<h4 id="性质-1"><a href="#性质-1" class="headerlink" title="性质"></a>性质</h4><p>$a^0,a^1,a^2,⋯,a^{\varphi(p)}$ 模 p 两两不同余，且 $a^k\equiv a^{k+\varphi(p)}\pmod p$</p>
<h3 id="泰勒展开-1"><a href="#泰勒展开-1" class="headerlink" title="泰勒展开"></a>泰勒展开</h3><p>回忆微分法</p>
<p>熟知对于一点$x_0$ 我们试图寻找其邻域的某点$x$及其函数值$f(x)$ 我们应该构造关于$(x-x_0)$的一次多项式 $p(x)&#x3D;f(x_0)+f’(x_0)(x-x_0)$  使得$p’(x-x_0)&#x3D;f’(x_0)$</p>
<p>发现该微分法存在以下突出问题:</p>
<ul>
<li>精度损失不确定</li>
<li>精度损失较大</li>
</ul>
<p>于是我们期望能够得到一个多项式$p(x)$ 使得<br>$$<br>p(x)&#x3D;\sum_{i&#x3D;0}^{n}a_i(x-x_0)^i<br>$$<br>并且$p^{(i)}(x-x_0)&#x3D;f^{(n)}(x_0)$</p>
<p>于是设x&#x3D;0连续求导后 $a_i&#x3D;\frac{f^{(i)}(x)}{i!}$</p>
<h3 id="牛顿迭代-1"><a href="#牛顿迭代-1" class="headerlink" title="牛顿迭代"></a>牛顿迭代</h3><p>发现我们在对精度要求不高时可以使用导数(直线)近似代替原函数来近似求解函数根</p>
<p>若对精度要求更高重复使用即可 </p>
<p>这样我们引出迭代公式<br>$$<br>在(x_0,f(x_0))处的切线方程为y-f(x_0)&#x3D;f’(x_0)(x-x_0)<br>\<br>于是x&#x3D;x_0-\frac{f(x_0)}{f’(x_0)}<br>$$</p>
<h2 id="FFT-1"><a href="#FFT-1" class="headerlink" title="FFT"></a>FFT</h2><p>fft是解决多项式乘法(加法卷积)的一种方法</p>
<p>我们发现加法卷积复杂度极高 这是不能被我们承受的</p>
<p>考虑讲要卷的两个多项式求出点值表示 然后把点值相乘 然后插值回答案多项式</p>
<h3 id="DFT-1"><a href="#DFT-1" class="headerlink" title="DFT"></a>DFT</h3><p>dft是进行多项式多点求值的算法 我们发现多项式<br>$$<br>f(x)&#x3D;a_0+a_1x^1+a_2x^2+a_3x^3+a_4x^4+a_5x^5…<br>\<br>可以拆分为<br>\<br>fl(x)&#x3D;a_0+a_2x^1+a_4x^2+a_6x^3…<br>\和\<br>fr(x)&#x3D;a_1+a_3x^1+a_5x^2+a7x^3…<br>\于是\<br>f(x)&#x3D;fl(x^2)+xfr(x^2)<br>\我们试着将单位根带入\<br>f(w_n^k)&#x3D;fl(w_n^{2k})+w_n^kfr(w_n^{2k})&#x3D;fl(w_{n&#x2F;2}^{k})+w_n^kfr(w_{n&#x2F;2}^{k})<br>\并且有\<br>f(w_n^{k+n&#x2F;2})&#x3D;fl(w_n^{2k+n})+w_n^{k+n&#x2F;2}fr(w_n^{2k+n})&#x3D;fl(w_{n&#x2F;2}^{k})-w_n^kfr(w_{n&#x2F;2}^{k})<br>$$<br>我们可以分治求解 复杂度$O(nlogn)$</p>
<h3 id="IDFT-1"><a href="#IDFT-1" class="headerlink" title="IDFT"></a>IDFT</h3><p>idft是进行多项式多点插值的算法</p>
<p>$(y_0,y_1,y_2…y_{n-1})$为$(a_0,a_1,a_2,…a_{n-1})$的点值表示</p>
<p>那么设另一组数列${c_k}$满足$c_k&#x3D;\sum_{i&#x3D;0}^{n-1}y_i(w_n^{-k})^i$</p>
<p>那么<br>$$<br>c_k&#x3D;\sum_{i&#x3D;0}^{n-1}y_i(w_n^{-k})^i<br>\<br>&#x3D;\sum^{n-1}<em>{i&#x3D;0}(\sum^{n-1}</em>{j&#x3D;0}a_j(w^i_n)^j)(w_n^{-k})^i<br>\<br>&#x3D;\sum^{n-1}<em>{i&#x3D;0}(\sum^{n-1}</em>{j&#x3D;0}a_j(w^j_n)^i)(w_n^{-k})^i<br>\<br>&#x3D;\sum^{n-1}<em>{i&#x3D;0}\sum^{n-1}</em>{j&#x3D;0}a_j(w^{j-k}<em>n)^i<br>\<br>&#x3D;\sum^{n-1}</em>{j&#x3D;0}a_j(\sum^{n-1}_{i&#x3D;0}(w^{j-k}_n)^i)<br>$$</p>
<p>那么 我们发现 对于后半个合式 若$j&#x3D;k$ 取值为$n$</p>
<p>若不等呢:</p>
<p>设$j-k&#x3D;s$</p>
<p>利用等比数列求和公式 </p>
<p>后半个合式等于$\frac{(w_n^s)^n-1}{w_n^s}$</p>
<p>上半部等于0</p>
<p>于是$c_k&#x3D;na_k$</p>
<p>把n除过去即可</p>
<h2 id="NTT-1"><a href="#NTT-1" class="headerlink" title="NTT"></a>NTT</h2><p>发现整个fft的过程中都是在做实数运算 精度误差存在且不小 并且复数运算很慢 甚至某些时候需要蝴蝶优化减少递归带来的巨大常数 我们的推导用到了单位根的如下性质:</p>
<p>1 $w_n^k&#x3D;w_{n&#x2F;2}^{k&#x2F;2}$</p>
<p>2 $w_n^{k+n}&#x3D;w_n^k$</p>
<p>3 $w_n^{k+n&#x2F;2}&#x3D;-w_n^k$</p>
<p>4 $w_n^0&#x3D;w_n^n&#x3D;1$</p>
<p>5 n次方内互不相等</p>
<p>惊喜的发现这些性质在模意义下的时原根也具有 </p>
<p>于是在代码中将复数全部换为原根即可</p>
<h2 id="FWT-1"><a href="#FWT-1" class="headerlink" title="FWT"></a>FWT</h2><p>fwt是用于解决一类位运算卷积的算法</p>
<h3 id="基本思想与概览-1"><a href="#基本思想与概览-1" class="headerlink" title="基本思想与概览"></a>基本思想与概览</h3><p>熟知fft是线性的 我们期望fwt也可以得到一个线性函数</p>
<p>我们首先写出位运算卷积的一般形式:<br>$$<br>S[k]&#x3D;\sum_{i\oplus j&#x3D;k}A[i]B[j]<br>$$<br>记作<br>$$<br>S&#x3D;A*B<br>$$<br>其中$\oplus$是某种位运算</p>
<p>设FWT变换系数为$c(i,j)$ 我们设FWT(A)是A经过FWT变换后的数列</p>
<p>需满足:<br>$$<br>A*B&#x3D;C \iff FWT(A)\cdot FWT(B)&#x3D;FWT(B)<br>$$<br>于是<br>$$<br>FWT(A)[i]&#x3D;\sum^{n-1}<em>{j&#x3D;0}c(i,j)A_j<br>$$<br>依<br>$$<br>FWT(A)\cdot FWT(B)&#x3D;FWT(B)<br>$$<br>得<br>$$<br>FWT(A)[i]FWT(B)[i]&#x3D;FWT(c)[I]<br>\<br>\sum^{n-1}</em>{j&#x3D;0}c(i,j)A[j]\sum^{n-1}<em>{k&#x3D;0}c(i,k)B[k]&#x3D;\sum^{n-1}</em>{p&#x3D;0}c(i,p)C[p]<br>\<br>\sum^{n-1}<em>{j&#x3D;0}\sum^{n-1}</em>{k&#x3D;0}c(i,j)c(i,k)A[j]B[k]&#x3D;\sum^{n-1}<em>{p&#x3D;0}c(i,p)C[p]<br>$$<br>依<br>$$<br>C[p]&#x3D;\sum</em>{t_1\oplus t_2&#x3D;p}A[t_1]B[t_2]<br>$$<br>又得<br>$$<br>\sum^{n-1}<em>{p&#x3D;0}c(i,p)C[p]&#x3D;\sum^{n-1}</em>{p&#x3D;0}c(i,p)\sum_{t_1\oplus t_2&#x3D;p}A[t_1]B[t_2]<br>\<br>\sum^{n-1}<em>{j&#x3D;0}\sum^{n-1}</em>{k&#x3D;0}c(i,j)c(i,k)A[j]B[k]&#x3D;\sum^{n-1}<em>{p&#x3D;0}c(i,p)\sum</em>{t_1\oplus t_2&#x3D;p}A[t_1]B[t_2]<br>\<br>\sum^{n-1}<em>{j&#x3D;0}\sum^{n-1}</em>{k&#x3D;0}c(i,j)c(i,k)A[j]B[k]&#x3D;\sum^{n-1}<em>{t_1&#x3D;0}\sum</em>{t_2&#x3D;0}^{n-1}A[t_1]B[t_2]c(i,t_1\oplus t_2)<br>$$<br>对比发现只需使$c(i,j)c(i,k)&#x3D;c(i,j\oplus k)$</p>
<p>另外 由位运算只考虑独立位的特殊性 我们有:</p>
<p>对于一个二进制数a 它的每一位表示为$a_0,a_1,a_2,a_3,a_4,….$</p>
<p>设我们已经知道所有满足要求的c([0,1],[0,1])</p>
<p>那么<br>$$<br>c(i,j)&#x3D;c(i_0,j_0)c(i_1,j_1)c(i_2,j_2),…<br>$$<br>于是<br>$$<br>\prod_p c(i_p,j_p)c(i_p,k_p)&#x3D;\prod_p c(i_p,j_p\oplus k_p)<br>\<br>c(i,j)c(i,k)&#x3D;c(i,j\oplus k)<br>$$<br>由此 只要我们构造出单位的c函数 我们就可以构造出所有数的c函数</p>
<p>我们如何快速求位运算卷积呢</p>
<p>依然考虑分治</p>
<p>首先折半<br>$$<br>FWT(A)[i]&#x3D;\sum_{j&#x3D;0}^{(n&#x2F;2)-1}c(i,j)A[j]+\sum_{j&#x3D;(n&#x2F;2)}^{n-1}c(i,j)A[j]<br>$$<br>对于i,j的首位 我们分开考虑 设i’为i去掉二进制首位的数</p>
<p>于是<br>$$<br>&#x3D;\sum_{j&#x3D;0}^{(n&#x2F;2)-1}c(i_0,j_0)c(i’,j’)A[j]+\sum_{j&#x3D;(n&#x2F;2)}^{n-1}c(i_0,j_0)c(i’,j’)A[j]<br>\<br>&#x3D;c(i_0,0)\sum_{j&#x3D;0}^{(n&#x2F;2)-1}c(i’,j’)A[j]+c(i_0,1)\sum_{j&#x3D;(n&#x2F;2)}^{n-1}c(i_0,j_0)c(i’,j’)A[j]<br>$$<br>加号两边柿子分别递归处理 我们成功缩小了问题的规模</p>
<h3 id="一些例子-1"><a href="#一些例子-1" class="headerlink" title="一些例子"></a>一些例子</h3><p>针对不同位运算 我们需要构造出不同的c([0,1],[0,1]) 再结合上面的推导 问题就得到了解决</p>
<h4 id="Or卷积-1"><a href="#Or卷积-1" class="headerlink" title="Or卷积"></a>Or卷积</h4><p>c([0&#x2F;1],[0&#x2F;1])的矩阵<br>$$<br>\begin{bmatrix}<br>c(0,0)&amp;c(0,1)\<br>c(1,0)&amp;c(1,1)<br>\end{bmatrix}<br>$$</p>
<p>应满足条件 $c(i,j)c(i,k)&#x3D;c(i,j|k)$ </p>
<ul>
<li>$c(0,0)&#x3D;c(0,0|0)\Rightarrow c(0,0)&#x3D;1或0$</li>
<li>$c(0,1)c(0,0)&#x3D; c(0,1|0)\Rightarrow c(0,1)&#x3D;0或c(0,0)&#x3D;c(0,1)&#x3D;1$</li>
<li>$c(1,1)c(1,0)&#x3D;c(1,1|0)\Rightarrow c(1,1)&#x3D;0或c(1,0)&#x3D;c(1,1)&#x3D;1$</li>
</ul>
<p>并且这个矩阵应当是有逆的 否则就无法回去 我们最终选取</p>
<p>$c(0,0)&#x3D;1,c(0,1)&#x3D;0,c(1,0)&#x3D;1,c(1,1)&#x3D;1$</p>
<p>逆变换其实只需矩阵求逆即可 </p>
<p>或者考虑算式的反算式即可</p>
<p>那么同理对于</p>
<h4 id="And卷积-1"><a href="#And卷积-1" class="headerlink" title="And卷积"></a>And卷积</h4><p>有矩阵<br>$$<br>\begin{bmatrix}<br>1&amp;1\<br>0&amp;1<br>\end{bmatrix}<br>$$</p>
<p>和</p>
<h4 id="Xor卷积-1"><a href="#Xor卷积-1" class="headerlink" title="Xor卷积"></a>Xor卷积</h4><p>有矩阵<br>$$<br>\begin{bmatrix}<br>1&amp;1\<br>1&amp;-1<br>\end{bmatrix}<br>$$<br>既得易见平凡 仿照上例显然 留作习题答案略 读者自证不难</p>
<p>反之亦然同理 推论自然成立 略去过程Q E D  由上可知证毕 </p>
<p>​	西江月&#x2F;证明</p>
<h2 id="多项式乘法逆-1"><a href="#多项式乘法逆-1" class="headerlink" title="多项式乘法逆"></a>多项式乘法逆</h2><p>多项式求逆即对于多项式$f(x)$</p>
<p>我们求一个$g(x)$</p>
<p>使得<br>$$<br>g(x)*f(x)\equiv1 \pmod {x^n}<br>$$</p>
<h3 id="倍增法-2"><a href="#倍增法-2" class="headerlink" title="倍增法"></a>倍增法</h3><h4 id="边界-1"><a href="#边界-1" class="headerlink" title="边界"></a>边界</h4><p>当界为$\pmod{x^1}$ 即多项式只有常数项时 直接数字逆元即可</p>
<h4 id="转移-1"><a href="#转移-1" class="headerlink" title="转移"></a>转移</h4><p>假设我们得到了$T(x)\equiv F(x)^{-1} \pmod {x^{n&#x2F;2}}$</p>
<p>显然有$G(x)\equiv T(x)\pmod{x^{n&#x2F;2}}$</p>
<p>那么 $(G(x)-T(x))^2\equiv0\pmod{x^n}$</p>
<p>$G(x)^2-2G(x)T(x)+T(x)^2\equiv0\pmod{x^n}$</p>
<p>同乘$F(x)$</p>
<p>$R(x)-2G(x)-G(x)^2F(x)\equiv0\pmod{x^n}$</p>
<p>运用多项式乘法倍增即可</p>
<h2 id="多项式开根-1"><a href="#多项式开根-1" class="headerlink" title="多项式开根"></a>多项式开根</h2><p>给定$g(x)$ 求$f(x)$满足<br>$$<br>f^2(x)\equiv g(x)\pmod{x^n}<br>$$</p>
<h3 id="倍增法-3"><a href="#倍增法-3" class="headerlink" title="倍增法"></a>倍增法</h3><p>假设已求出$g(x)$在模$x^{[n&#x2F;2]}$意义下的平方根$f_0(x)$ 则有<br>$$<br>f_0^2(x)\equiv g(x) \pmod{x^{[n&#x2F;2]}}<br>\<br>f_0^2(x)-g(x)\equiv 0\pmod{x^{[n&#x2F;2]}}<br>\<br>(f_0^2(x)-g(x))^2\equiv 0\pmod{x^{n}}<br>\<br>(f_0^2(x)+g(x))^2\equiv 4f_0^2(x)g(x)\pmod{x^{n}}<br>\<br>(\frac{f_0^2(x)+g(x)}{2f_0(x)})\equiv g(x)\pmod{x^{n}}<br>\<br>\frac{f_0^2(x)+g(x)}{2f_0(x)}\equiv f(x) \pmod{x^n}<br>\<br>\frac 1 2f_0(x)+2^{-1}f_0^{-1}(x)g(x)\equiv f(x) \pmod{x^n}<br>$$</p>
<h2 id="多项式除法-1"><a href="#多项式除法-1" class="headerlink" title="多项式除法"></a>多项式除法</h2><p>给定多项式$f(x),g(x)$ 求$g(x)$除$f(x)$的商$q(x)$和余数$r(x)$</p>
<p>若能消去$r(x)$的影响则可直接多项式乘法逆</p>
<p>考虑构造<br>$$<br>f_r(x)&#x3D;x^nf(\frac 1 x)<br>$$<br>容易发现其为反转$f(x)$系数</p>
<p>设$n&#x3D;\deg f,m&#x3D;\deg g$</p>
<p>则<br>$$<br>f(x)&#x3D;q(x)g(x)+r(x)\Rightarrow<br>\<br>x^nf(\frac 1 x)&#x3D;x^{n-m}q(\frac 1 x)x^mg(\frac 1 x)+x^{n-m+1}x^{m-1}r(\frac 1 x)<br>\<br>f_r(x)&#x3D;q_r(x)g_r(x)+x^{n-m+1}r_r(x)<br>\<br>于是<br>\<br>f_r(x)\equiv q_r(x)g_r(x)\pmod{x^{n-m+1}}<br>$$<br>多项式求逆$g_r(x)$即可 然后求出$q_r(x)$和$r_r(x)$</p>
<h2 id="多项式ln-1"><a href="#多项式ln-1" class="headerlink" title="多项式ln"></a>多项式ln</h2><p>给定多项式$f(x)$ 求模$x^n$意义下$lnf(x)$</p>
<p>解法本质就是暴力</p>
<p>对多项式先求导再积分即可<br>$$<br>\frac {\text{d}\ln f(x)}{dx}\equiv \frac {1}{f(x)} f’(x)\pmod{x^n}<br>$$</p>
<h2 id="多项式牛顿迭代-1"><a href="#多项式牛顿迭代-1" class="headerlink" title="多项式牛顿迭代"></a>多项式牛顿迭代</h2><p>对于给定$g(x)$ 求$f(x)$ 使得其满足$g(f(x))\equiv 0 \pmod{ x^n}$</p>
<p>假设已经得到了模$x^{[n&#x2F;2]}$次方的解$f_0(x)$ 要求模$x^n$的解$f(x)$</p>
<p>跟据定义我们知道 $f(x)$与$f_0(x)$在前$[n&#x2F;2]-1$位上相等 </p>
<p>那么我们写出$g(f(x))$在$f_0(x)$处的泰勒展开 </p>
<p><img src="https://i.loli.net/2021/07/10/AreopyjgdDlhbU6.png" alt="image-20210710085546653"></p>
<p>发现从第三项往后全部被模掉了 没有意义 我们即可直接用牛顿迭代式计算</p>
<p><img src="https://i.loli.net/2021/07/10/jq9MTVmktfgHaus.png" alt="image-20210710085712805"></p>
<h3 id="应用-1"><a href="#应用-1" class="headerlink" title="应用"></a>应用</h3><h4 id="多项式求逆-1"><a href="#多项式求逆-1" class="headerlink" title="多项式求逆"></a>多项式求逆</h4><p>给定多项式$h(x)$ 有方程<br>$$<br>g(f(x))&#x3D;\frac1 {f(x)}-h(x)\equiv0\pmod0<br>$$<br>应用牛顿迭代有<br>$$<br>\begin{aligned}<br>    f\left(x\right)&amp;\equiv f_{0}\left(x\right)-\frac{\frac{1}{f_{0}\left(x\right)}-h\left(x\right)}{-\frac{1}{f_{0}^{2}\left(x\right)}}&amp;\pmod{x^{n}}\<br>    &amp;\equiv 2f_{0}\left(x\right)-f_{0}^{2}\left(x\right)h\left(x\right)&amp;\pmod{x^{n}}<br>\end{aligned}<br>$$</p>
<h4 id="多项式开方-1"><a href="#多项式开方-1" class="headerlink" title="多项式开方"></a>多项式开方</h4><p>给定多项式$h(x)$ 有方程<br>$$<br>g(f(x))&#x3D;f^2(x)-h(x)\equiv0\pmod{x^n}<br>$$<br>应用牛顿迭代有<br>$$<br>f(x)\equiv f_0(x)-\frac{f_0^2(x)-h(x)}{2f_0(x)}\pmod{x^n}<br>\<br>\equiv\frac{f_0^2(x)+h(x)}{2f_0(x)}\pmod{x^n}<br>$$</p>
<h4 id="多项式exp-1"><a href="#多项式exp-1" class="headerlink" title="多项式exp"></a>多项式exp</h4><p>给定多项式$h(x)$ 有方程<br>$$<br>g(f(x))&#x3D;\ln f(x)-h(x)\pmod {x^n}<br>$$<br>应用牛顿迭代有.<br>$$<br>f(x)\equiv f_0(x)-\frac{\ln f_0(x)-h(x)}{\frac1{f_0(x)}}<br>\<br>f_0(x)(1-ln f_0(x)+h(x))\pmod{x^n}<br>$$</p>
<h1 id="可能是多项式模板全家桶-2"><a href="#可能是多项式模板全家桶-2" class="headerlink" title="可能是多项式模板全家桶"></a>可能是多项式模板全家桶</h1><h1 id="不到-万字长文-2"><a href="#不到-万字长文-2" class="headerlink" title="(不到)万字长文"></a>(不到)万字长文</h1><h1 id="或许是较好理解的板子讲解-2"><a href="#或许是较好理解的板子讲解-2" class="headerlink" title="或许是较好理解的板子讲解"></a>或许是较好理解的板子讲解</h1><p>本文无代码 否则您将学习每天一个常数爆炸小技巧</p>
<p>qwq</p>
<p>阅读本文约需9分钟:</p>
<p><img src="https://i.loli.net/2021/07/10/5n41cEs3UOlhH69.png" alt="image-20210710093833431"></p>
<h2 id="前置知识-2"><a href="#前置知识-2" class="headerlink" title="前置知识:"></a>前置知识:</h2><h3 id="复数-2"><a href="#复数-2" class="headerlink" title="复数"></a>复数</h3><h4 id="虚数单位-2"><a href="#虚数单位-2" class="headerlink" title="虚数单位"></a>虚数单位</h4><p>虚数单位$i&#x3D;\sqrt{(-1)}$</p>
<h4 id="定义-4"><a href="#定义-4" class="headerlink" title="定义"></a>定义</h4><p>复数是形如$a+bi$的数</p>
<h4 id="运算-2"><a href="#运算-2" class="headerlink" title="运算"></a>运算</h4><h5 id="加法-2"><a href="#加法-2" class="headerlink" title="加法"></a>加法</h5><p>复数 $x&#x3D;(a+bi),y&#x3D;(c+di)$的和定义为 $x+y&#x3D;(a+bi)+(c+di)&#x3D;a+c+(d+b)i$</p>
<h5 id="乘法-2"><a href="#乘法-2" class="headerlink" title="乘法"></a>乘法</h5><p>复数 $x&#x3D;(a+bi),y&#x3D;(c+di)$的积定义为$xy&#x3D;(a+bi)(c+di)&#x3D;ac-bd+(ad+cb)i$</p>
<p>发现复数可以用座标表示 如$x&#x3D;(a+bi)$可表示为$(a,b)$ 这样也可以表示为向量 我们记模长为$r&#x3D;\sqrt{a^2+b^2}$ 俯角为$\alpha$ 于是向量表示为$(rcos\alpha,rsin\alpha)$ 发现一个性质 两向量的积$(rcos\alpha,rsin\alpha)(Rcos\beta,Rsin\beta)$等于$(rRcos(\alpha+\beta),rRsin(\alpha+\beta))$ 模长相乘俯角相加</p>
<h3 id="单位根-2"><a href="#单位根-2" class="headerlink" title="单位根"></a>单位根</h3><p>单位根是形如这样的方程的所有的根:<br>$$<br>x^n&#x3D;1<br>$$<br>根据算数基本定理 这样的根在复数域上有n个</p>
<p>我们记第一个为$w_n$ 它应当是某个复数 我们知道 复数乘法满足模长相差俯角相加 那么它在复数域上的几何表示就是单位圆$n$等分后从(0,1)开始转的第一份</p>
<p>我么发现 第一个单位根的k次方$(0&lt;&#x3D;k&lt;&#x3D;n-1)$也是一个单位根</p>
<p>单位根具有以下性质 希望读者自行验证:</p>
<p>1 $w_n^k&#x3D;w_{n&#x2F;2}^{k&#x2F;2}$</p>
<p>2 $w_n^{k+n}&#x3D;w_n^k$</p>
<p>3 $w_n^{k+n&#x2F;2}&#x3D;-w_n^k$</p>
<p>4 $w_n^0&#x3D;w_n^n&#x3D;1$</p>
<h3 id="原根-2"><a href="#原根-2" class="headerlink" title="原根"></a>原根</h3><h4 id="阶-2"><a href="#阶-2" class="headerlink" title="阶"></a>阶</h4><p>对于一个数 a 一个模数 p 存在最小的 y使得<br>$$<br>a^y\equiv1\pmod p<br>$$</p>
<h4 id="定义-5"><a href="#定义-5" class="headerlink" title="定义"></a>定义</h4><p>若对于一个模数p 存在一个a使得a对p的阶等于phi(p) 那么a就叫做p的原根</p>
<h4 id="性质-2"><a href="#性质-2" class="headerlink" title="性质"></a>性质</h4><p>$a^0,a^1,a^2,⋯,a^{\varphi(p)}$ 模 p 两两不同余，且 $a^k\equiv a^{k+\varphi(p)}\pmod p$</p>
<h3 id="泰勒展开-2"><a href="#泰勒展开-2" class="headerlink" title="泰勒展开"></a>泰勒展开</h3><p>回忆微分法</p>
<p>熟知对于一点$x_0$ 我们试图寻找其邻域的某点$x$及其函数值$f(x)$ 我们应该构造关于$(x-x_0)$的一次多项式 $p(x)&#x3D;f(x_0)+f’(x_0)(x-x_0)$  使得$p’(x-x_0)&#x3D;f’(x_0)$</p>
<p>发现该微分法存在以下突出问题:</p>
<ul>
<li>精度损失不确定</li>
<li>精度损失较大</li>
</ul>
<p>于是我们期望能够得到一个多项式$p(x)$ 使得<br>$$<br>p(x)&#x3D;\sum_{i&#x3D;0}^{n}a_i(x-x_0)^i<br>$$<br>并且$p^{(i)}(x-x_0)&#x3D;f^{(n)}(x_0)$</p>
<p>于是设x&#x3D;0连续求导后 $a_i&#x3D;\frac{f^{(i)}(x)}{i!}$</p>
<h3 id="牛顿迭代-2"><a href="#牛顿迭代-2" class="headerlink" title="牛顿迭代"></a>牛顿迭代</h3><p>发现我们在对精度要求不高时可以使用导数(直线)近似代替原函数来近似求解函数根</p>
<p>若对精度要求更高重复使用即可 </p>
<p>这样我们引出迭代公式<br>$$<br>在(x_0,f(x_0))处的切线方程为y-f(x_0)&#x3D;f’(x_0)(x-x_0)<br>\<br>于是x&#x3D;x_0-\frac{f(x_0)}{f’(x_0)}<br>$$</p>
<h2 id="FFT-2"><a href="#FFT-2" class="headerlink" title="FFT"></a>FFT</h2><p>fft是解决多项式乘法(加法卷积)的一种方法</p>
<p>我们发现加法卷积复杂度极高 这是不能被我们承受的</p>
<p>考虑讲要卷的两个多项式求出点值表示 然后把点值相乘 然后插值回答案多项式</p>
<h3 id="DFT-2"><a href="#DFT-2" class="headerlink" title="DFT"></a>DFT</h3><p>dft是进行多项式多点求值的算法 我们发现多项式<br>$$<br>f(x)&#x3D;a_0+a_1x^1+a_2x^2+a_3x^3+a_4x^4+a_5x^5…<br>\<br>可以拆分为<br>\<br>fl(x)&#x3D;a_0+a_2x^1+a_4x^2+a_6x^3…<br>\和\<br>fr(x)&#x3D;a_1+a_3x^1+a_5x^2+a7x^3…<br>\于是\<br>f(x)&#x3D;fl(x^2)+xfr(x^2)<br>\我们试着将单位根带入\<br>f(w_n^k)&#x3D;fl(w_n^{2k})+w_n^kfr(w_n^{2k})&#x3D;fl(w_{n&#x2F;2}^{k})+w_n^kfr(w_{n&#x2F;2}^{k})<br>\并且有\<br>f(w_n^{k+n&#x2F;2})&#x3D;fl(w_n^{2k+n})+w_n^{k+n&#x2F;2}fr(w_n^{2k+n})&#x3D;fl(w_{n&#x2F;2}^{k})-w_n^kfr(w_{n&#x2F;2}^{k})<br>$$<br>我们可以分治求解 复杂度$O(nlogn)$</p>
<h3 id="IDFT-2"><a href="#IDFT-2" class="headerlink" title="IDFT"></a>IDFT</h3><p>idft是进行多项式多点插值的算法</p>
<p>$(y_0,y_1,y_2…y_{n-1})$为$(a_0,a_1,a_2,…a_{n-1})$的点值表示</p>
<p>那么设另一组数列${c_k}$满足$c_k&#x3D;\sum_{i&#x3D;0}^{n-1}y_i(w_n^{-k})^i$</p>
<p>那么<br>$$<br>c_k&#x3D;\sum_{i&#x3D;0}^{n-1}y_i(w_n^{-k})^i<br>\<br>&#x3D;\sum^{n-1}<em>{i&#x3D;0}(\sum^{n-1}</em>{j&#x3D;0}a_j(w^i_n)^j)(w_n^{-k})^i<br>\<br>&#x3D;\sum^{n-1}<em>{i&#x3D;0}(\sum^{n-1}</em>{j&#x3D;0}a_j(w^j_n)^i)(w_n^{-k})^i<br>\<br>&#x3D;\sum^{n-1}<em>{i&#x3D;0}\sum^{n-1}</em>{j&#x3D;0}a_j(w^{j-k}<em>n)^i<br>\<br>&#x3D;\sum^{n-1}</em>{j&#x3D;0}a_j(\sum^{n-1}_{i&#x3D;0}(w^{j-k}_n)^i)<br>$$</p>
<p>那么 我们发现 对于后半个合式 若$j&#x3D;k$ 取值为$n$</p>
<p>若不等呢:</p>
<p>设$j-k&#x3D;s$</p>
<p>利用等比数列求和公式 </p>
<p>后半个合式等于$\frac{(w_n^s)^n-1}{w_n^s}$</p>
<p>上半部等于0</p>
<p>于是$c_k&#x3D;na_k$</p>
<p>把n除过去即可</p>
<h2 id="NTT-2"><a href="#NTT-2" class="headerlink" title="NTT"></a>NTT</h2><p>发现整个fft的过程中都是在做实数运算 精度误差存在且不小 并且复数运算很慢 甚至某些时候需要蝴蝶优化减少递归带来的巨大常数 我们的推导用到了单位根的如下性质:</p>
<p>1 $w_n^k&#x3D;w_{n&#x2F;2}^{k&#x2F;2}$</p>
<p>2 $w_n^{k+n}&#x3D;w_n^k$</p>
<p>3 $w_n^{k+n&#x2F;2}&#x3D;-w_n^k$</p>
<p>4 $w_n^0&#x3D;w_n^n&#x3D;1$</p>
<p>5 n次方内互不相等</p>
<p>惊喜的发现这些性质在模意义下的时原根也具有 </p>
<p>于是在代码中将复数全部换为原根即可</p>
<h2 id="FWT-2"><a href="#FWT-2" class="headerlink" title="FWT"></a>FWT</h2><p>fwt是用于解决一类位运算卷积的算法</p>
<h3 id="基本思想与概览-2"><a href="#基本思想与概览-2" class="headerlink" title="基本思想与概览"></a>基本思想与概览</h3><p>熟知fft是线性的 我们期望fwt也可以得到一个线性函数</p>
<p>我们首先写出位运算卷积的一般形式:<br>$$<br>S[k]&#x3D;\sum_{i\oplus j&#x3D;k}A[i]B[j]<br>$$<br>记作<br>$$<br>S&#x3D;A*B<br>$$<br>其中$\oplus$是某种位运算</p>
<p>设FWT变换系数为$c(i,j)$ 我们设FWT(A)是A经过FWT变换后的数列</p>
<p>需满足:<br>$$<br>A*B&#x3D;C \iff FWT(A)\cdot FWT(B)&#x3D;FWT(B)<br>$$<br>于是<br>$$<br>FWT(A)[i]&#x3D;\sum^{n-1}<em>{j&#x3D;0}c(i,j)A_j<br>$$<br>依<br>$$<br>FWT(A)\cdot FWT(B)&#x3D;FWT(B)<br>$$<br>得<br>$$<br>FWT(A)[i]FWT(B)[i]&#x3D;FWT(c)[I]<br>\<br>\sum^{n-1}</em>{j&#x3D;0}c(i,j)A[j]\sum^{n-1}<em>{k&#x3D;0}c(i,k)B[k]&#x3D;\sum^{n-1}</em>{p&#x3D;0}c(i,p)C[p]<br>\<br>\sum^{n-1}<em>{j&#x3D;0}\sum^{n-1}</em>{k&#x3D;0}c(i,j)c(i,k)A[j]B[k]&#x3D;\sum^{n-1}<em>{p&#x3D;0}c(i,p)C[p]<br>$$<br>依<br>$$<br>C[p]&#x3D;\sum</em>{t_1\oplus t_2&#x3D;p}A[t_1]B[t_2]<br>$$<br>又得<br>$$<br>\sum^{n-1}<em>{p&#x3D;0}c(i,p)C[p]&#x3D;\sum^{n-1}</em>{p&#x3D;0}c(i,p)\sum_{t_1\oplus t_2&#x3D;p}A[t_1]B[t_2]<br>\<br>\sum^{n-1}<em>{j&#x3D;0}\sum^{n-1}</em>{k&#x3D;0}c(i,j)c(i,k)A[j]B[k]&#x3D;\sum^{n-1}<em>{p&#x3D;0}c(i,p)\sum</em>{t_1\oplus t_2&#x3D;p}A[t_1]B[t_2]<br>\<br>\sum^{n-1}<em>{j&#x3D;0}\sum^{n-1}</em>{k&#x3D;0}c(i,j)c(i,k)A[j]B[k]&#x3D;\sum^{n-1}<em>{t_1&#x3D;0}\sum</em>{t_2&#x3D;0}^{n-1}A[t_1]B[t_2]c(i,t_1\oplus t_2)<br>$$<br>对比发现只需使$c(i,j)c(i,k)&#x3D;c(i,j\oplus k)$</p>
<p>另外 由位运算只考虑独立位的特殊性 我们有:</p>
<p>对于一个二进制数a 它的每一位表示为$a_0,a_1,a_2,a_3,a_4,….$</p>
<p>设我们已经知道所有满足要求的c([0,1],[0,1])</p>
<p>那么<br>$$<br>c(i,j)&#x3D;c(i_0,j_0)c(i_1,j_1)c(i_2,j_2),…<br>$$<br>于是<br>$$<br>\prod_p c(i_p,j_p)c(i_p,k_p)&#x3D;\prod_p c(i_p,j_p\oplus k_p)<br>\<br>c(i,j)c(i,k)&#x3D;c(i,j\oplus k)<br>$$<br>由此 只要我们构造出单位的c函数 我们就可以构造出所有数的c函数</p>
<p>我们如何快速求位运算卷积呢</p>
<p>依然考虑分治</p>
<p>首先折半<br>$$<br>FWT(A)[i]&#x3D;\sum_{j&#x3D;0}^{(n&#x2F;2)-1}c(i,j)A[j]+\sum_{j&#x3D;(n&#x2F;2)}^{n-1}c(i,j)A[j]<br>$$<br>对于i,j的首位 我们分开考虑 设i’为i去掉二进制首位的数</p>
<p>于是<br>$$<br>&#x3D;\sum_{j&#x3D;0}^{(n&#x2F;2)-1}c(i_0,j_0)c(i’,j’)A[j]+\sum_{j&#x3D;(n&#x2F;2)}^{n-1}c(i_0,j_0)c(i’,j’)A[j]<br>\<br>&#x3D;c(i_0,0)\sum_{j&#x3D;0}^{(n&#x2F;2)-1}c(i’,j’)A[j]+c(i_0,1)\sum_{j&#x3D;(n&#x2F;2)}^{n-1}c(i_0,j_0)c(i’,j’)A[j]<br>$$<br>加号两边柿子分别递归处理 我们成功缩小了问题的规模</p>
<h3 id="一些例子-2"><a href="#一些例子-2" class="headerlink" title="一些例子"></a>一些例子</h3><p>针对不同位运算 我们需要构造出不同的c([0,1],[0,1]) 再结合上面的推导 问题就得到了解决</p>
<h4 id="Or卷积-2"><a href="#Or卷积-2" class="headerlink" title="Or卷积"></a>Or卷积</h4><p>c([0&#x2F;1],[0&#x2F;1])的矩阵<br>$$<br>\begin{bmatrix}<br>c(0,0)&amp;c(0,1)\<br>c(1,0)&amp;c(1,1)<br>\end{bmatrix}<br>$$</p>
<p>应满足条件 $c(i,j)c(i,k)&#x3D;c(i,j|k)$ </p>
<ul>
<li>$c(0,0)&#x3D;c(0,0|0)\Rightarrow c(0,0)&#x3D;1或0$</li>
<li>$c(0,1)c(0,0)&#x3D; c(0,1|0)\Rightarrow c(0,1)&#x3D;0或c(0,0)&#x3D;c(0,1)&#x3D;1$</li>
<li>$c(1,1)c(1,0)&#x3D;c(1,1|0)\Rightarrow c(1,1)&#x3D;0或c(1,0)&#x3D;c(1,1)&#x3D;1$</li>
</ul>
<p>并且这个矩阵应当是有逆的 否则就无法回去 我们最终选取</p>
<p>$c(0,0)&#x3D;1,c(0,1)&#x3D;0,c(1,0)&#x3D;1,c(1,1)&#x3D;1$</p>
<p>逆变换其实只需矩阵求逆即可 </p>
<p>或者考虑算式的反算式即可</p>
<p>那么同理对于</p>
<h4 id="And卷积-2"><a href="#And卷积-2" class="headerlink" title="And卷积"></a>And卷积</h4><p>有矩阵<br>$$<br>\begin{bmatrix}<br>1&amp;1\<br>0&amp;1<br>\end{bmatrix}<br>$$</p>
<p>和</p>
<h4 id="Xor卷积-2"><a href="#Xor卷积-2" class="headerlink" title="Xor卷积"></a>Xor卷积</h4><p>有矩阵<br>$$<br>\begin{bmatrix}<br>1&amp;1\<br>1&amp;-1<br>\end{bmatrix}<br>$$<br>既得易见平凡 仿照上例显然 留作习题答案略 读者自证不难</p>
<p>反之亦然同理 推论自然成立 略去过程Q E D  由上可知证毕 </p>
<p>​	西江月&#x2F;证明</p>
<h2 id="多项式乘法逆-2"><a href="#多项式乘法逆-2" class="headerlink" title="多项式乘法逆"></a>多项式乘法逆</h2><p>多项式求逆即对于多项式$f(x)$</p>
<p>我们求一个$g(x)$</p>
<p>使得<br>$$<br>g(x)*f(x)\equiv1 \pmod {x^n}<br>$$</p>
<h3 id="倍增法-4"><a href="#倍增法-4" class="headerlink" title="倍增法"></a>倍增法</h3><h4 id="边界-2"><a href="#边界-2" class="headerlink" title="边界"></a>边界</h4><p>当界为$\pmod{x^1}$ 即多项式只有常数项时 直接数字逆元即可</p>
<h4 id="转移-2"><a href="#转移-2" class="headerlink" title="转移"></a>转移</h4><p>假设我们得到了$T(x)\equiv F(x)^{-1} \pmod {x^{n&#x2F;2}}$</p>
<p>显然有$G(x)\equiv T(x)\pmod{x^{n&#x2F;2}}$</p>
<p>那么 $(G(x)-T(x))^2\equiv0\pmod{x^n}$</p>
<p>$G(x)^2-2G(x)T(x)+T(x)^2\equiv0\pmod{x^n}$</p>
<p>同乘$F(x)$</p>
<p>$R(x)-2G(x)-G(x)^2F(x)\equiv0\pmod{x^n}$</p>
<p>运用多项式乘法倍增即可</p>
<h2 id="多项式开根-2"><a href="#多项式开根-2" class="headerlink" title="多项式开根"></a>多项式开根</h2><p>给定$g(x)$ 求$f(x)$满足<br>$$<br>f^2(x)\equiv g(x)\pmod{x^n}<br>$$</p>
<h3 id="倍增法-5"><a href="#倍增法-5" class="headerlink" title="倍增法"></a>倍增法</h3><p>假设已求出$g(x)$在模$x^{[n&#x2F;2]}$意义下的平方根$f_0(x)$ 则有<br>$$<br>f_0^2(x)\equiv g(x) \pmod{x^{[n&#x2F;2]}}<br>\<br>f_0^2(x)-g(x)\equiv 0\pmod{x^{[n&#x2F;2]}}<br>\<br>(f_0^2(x)-g(x))^2\equiv 0\pmod{x^{n}}<br>\<br>(f_0^2(x)+g(x))^2\equiv 4f_0^2(x)g(x)\pmod{x^{n}}<br>\<br>(\frac{f_0^2(x)+g(x)}{2f_0(x)})\equiv g(x)\pmod{x^{n}}<br>\<br>\frac{f_0^2(x)+g(x)}{2f_0(x)}\equiv f(x) \pmod{x^n}<br>\<br>\frac 1 2f_0(x)+2^{-1}f_0^{-1}(x)g(x)\equiv f(x) \pmod{x^n}<br>$$</p>
<h2 id="多项式除法-2"><a href="#多项式除法-2" class="headerlink" title="多项式除法"></a>多项式除法</h2><p>给定多项式$f(x),g(x)$ 求$g(x)$除$f(x)$的商$q(x)$和余数$r(x)$</p>
<p>若能消去$r(x)$的影响则可直接多项式乘法逆</p>
<p>考虑构造<br>$$<br>f_r(x)&#x3D;x^nf(\frac 1 x)<br>$$<br>容易发现其为反转$f(x)$系数</p>
<p>设$n&#x3D;\deg f,m&#x3D;\deg g$</p>
<p>则<br>$$<br>f(x)&#x3D;q(x)g(x)+r(x)\Rightarrow<br>\<br>x^nf(\frac 1 x)&#x3D;x^{n-m}q(\frac 1 x)x^mg(\frac 1 x)+x^{n-m+1}x^{m-1}r(\frac 1 x)<br>\<br>f_r(x)&#x3D;q_r(x)g_r(x)+x^{n-m+1}r_r(x)<br>\<br>于是<br>\<br>f_r(x)\equiv q_r(x)g_r(x)\pmod{x^{n-m+1}}<br>$$<br>多项式求逆$g_r(x)$即可 然后求出$q_r(x)$和$r_r(x)$</p>
<h2 id="多项式ln-2"><a href="#多项式ln-2" class="headerlink" title="多项式ln"></a>多项式ln</h2><p>给定多项式$f(x)$ 求模$x^n$意义下$lnf(x)$</p>
<p>解法本质就是暴力</p>
<p>对多项式先求导再积分即可<br>$$<br>\frac {\text{d}\ln f(x)}{dx}\equiv \frac {1}{f(x)} f’(x)\pmod{x^n}<br>$$</p>
<h2 id="多项式牛顿迭代-2"><a href="#多项式牛顿迭代-2" class="headerlink" title="多项式牛顿迭代"></a>多项式牛顿迭代</h2><p>对于给定$g(x)$ 求$f(x)$ 使得其满足$g(f(x))\equiv 0 \pmod{ x^n}$</p>
<p>假设已经得到了模$x^{[n&#x2F;2]}$次方的解$f_0(x)$ 要求模$x^n$的解$f(x)$</p>
<p>跟据定义我们知道 $f(x)$与$f_0(x)$在前$[n&#x2F;2]-1$位上相等 </p>
<p>那么我们写出$g(f(x))$在$f_0(x)$处的泰勒展开 </p>
<p><img src="https://i.loli.net/2021/07/10/AreopyjgdDlhbU6.png" alt="image-20210710085546653"></p>
<p>发现从第三项往后全部被模掉了 没有意义 我们即可直接用牛顿迭代式计算</p>
<p><img src="https://i.loli.net/2021/07/10/jq9MTVmktfgHaus.png" alt="image-20210710085712805"></p>
<h3 id="应用-2"><a href="#应用-2" class="headerlink" title="应用"></a>应用</h3><h4 id="多项式求逆-2"><a href="#多项式求逆-2" class="headerlink" title="多项式求逆"></a>多项式求逆</h4><p>给定多项式$h(x)$ 有方程<br>$$<br>g(f(x))&#x3D;\frac1 {f(x)}-h(x)\equiv0\pmod0<br>$$<br>应用牛顿迭代有<br>$$<br>\begin{aligned}<br>    f\left(x\right)&amp;\equiv f_{0}\left(x\right)-\frac{\frac{1}{f_{0}\left(x\right)}-h\left(x\right)}{-\frac{1}{f_{0}^{2}\left(x\right)}}&amp;\pmod{x^{n}}\<br>    &amp;\equiv 2f_{0}\left(x\right)-f_{0}^{2}\left(x\right)h\left(x\right)&amp;\pmod{x^{n}}<br>\end{aligned}<br>$$</p>
<h4 id="多项式开方-2"><a href="#多项式开方-2" class="headerlink" title="多项式开方"></a>多项式开方</h4><p>给定多项式$h(x)$ 有方程<br>$$<br>g(f(x))&#x3D;f^2(x)-h(x)\equiv0\pmod{x^n}<br>$$<br>应用牛顿迭代有<br>$$<br>f(x)\equiv f_0(x)-\frac{f_0^2(x)-h(x)}{2f_0(x)}\pmod{x^n}<br>\<br>\equiv\frac{f_0^2(x)+h(x)}{2f_0(x)}\pmod{x^n}<br>$$</p>
<h4 id="多项式exp-2"><a href="#多项式exp-2" class="headerlink" title="多项式exp"></a>多项式exp</h4><p>给定多项式$h(x)$ 有方程<br>$$<br>g(f(x))&#x3D;\ln f(x)-h(x)\pmod {x^n}<br>$$<br>应用牛顿迭代有.<br>$$<br>f(x)\equiv f_0(x)-\frac{\ln f_0(x)-h(x)}{\frac1{f_0(x)}}<br>\<br>f_0(x)(1-ln f_0(x)+h(x))\pmod{x^n}<br>$$</p>
<h1 id="可能是多项式模板全家桶-3"><a href="#可能是多项式模板全家桶-3" class="headerlink" title="可能是多项式模板全家桶"></a>可能是多项式模板全家桶</h1><h1 id="不到-万字长文-3"><a href="#不到-万字长文-3" class="headerlink" title="(不到)万字长文"></a>(不到)万字长文</h1><h1 id="或许是较好理解的板子讲解-3"><a href="#或许是较好理解的板子讲解-3" class="headerlink" title="或许是较好理解的板子讲解"></a>或许是较好理解的板子讲解</h1><p>本文无代码 否则您将学习每天一个常数爆炸小技巧</p>
<p>qwq</p>
<p>阅读本文约需9分钟:</p>
<p><img src="https://i.loli.net/2021/07/10/5n41cEs3UOlhH69.png" alt="image-20210710093833431"></p>
<h2 id="前置知识-3"><a href="#前置知识-3" class="headerlink" title="前置知识:"></a>前置知识:</h2><h3 id="复数-3"><a href="#复数-3" class="headerlink" title="复数"></a>复数</h3><h4 id="虚数单位-3"><a href="#虚数单位-3" class="headerlink" title="虚数单位"></a>虚数单位</h4><p>虚数单位$i&#x3D;\sqrt{(-1)}$</p>
<h4 id="定义-6"><a href="#定义-6" class="headerlink" title="定义"></a>定义</h4><p>复数是形如$a+bi$的数</p>
<h4 id="运算-3"><a href="#运算-3" class="headerlink" title="运算"></a>运算</h4><h5 id="加法-3"><a href="#加法-3" class="headerlink" title="加法"></a>加法</h5><p>复数 $x&#x3D;(a+bi),y&#x3D;(c+di)$的和定义为 $x+y&#x3D;(a+bi)+(c+di)&#x3D;a+c+(d+b)i$</p>
<h5 id="乘法-3"><a href="#乘法-3" class="headerlink" title="乘法"></a>乘法</h5><p>复数 $x&#x3D;(a+bi),y&#x3D;(c+di)$的积定义为$xy&#x3D;(a+bi)(c+di)&#x3D;ac-bd+(ad+cb)i$</p>
<p>发现复数可以用座标表示 如$x&#x3D;(a+bi)$可表示为$(a,b)$ 这样也可以表示为向量 我们记模长为$r&#x3D;\sqrt{a^2+b^2}$ 俯角为$\alpha$ 于是向量表示为$(rcos\alpha,rsin\alpha)$ 发现一个性质 两向量的积$(rcos\alpha,rsin\alpha)(Rcos\beta,Rsin\beta)$等于$(rRcos(\alpha+\beta),rRsin(\alpha+\beta))$ 模长相乘俯角相加</p>
<h3 id="单位根-3"><a href="#单位根-3" class="headerlink" title="单位根"></a>单位根</h3><p>单位根是形如这样的方程的所有的根:<br>$$<br>x^n&#x3D;1<br>$$<br>根据算数基本定理 这样的根在复数域上有n个</p>
<p>我们记第一个为$w_n$ 它应当是某个复数 我们知道 复数乘法满足模长相差俯角相加 那么它在复数域上的几何表示就是单位圆$n$等分后从(0,1)开始转的第一份</p>
<p>我么发现 第一个单位根的k次方$(0&lt;&#x3D;k&lt;&#x3D;n-1)$也是一个单位根</p>
<p>单位根具有以下性质 希望读者自行验证:</p>
<p>1 $w_n^k&#x3D;w_{n&#x2F;2}^{k&#x2F;2}$</p>
<p>2 $w_n^{k+n}&#x3D;w_n^k$</p>
<p>3 $w_n^{k+n&#x2F;2}&#x3D;-w_n^k$</p>
<p>4 $w_n^0&#x3D;w_n^n&#x3D;1$</p>
<h3 id="原根-3"><a href="#原根-3" class="headerlink" title="原根"></a>原根</h3><h4 id="阶-3"><a href="#阶-3" class="headerlink" title="阶"></a>阶</h4><p>对于一个数 a 一个模数 p 存在最小的 y使得<br>$$<br>a^y\equiv1\pmod p<br>$$</p>
<h4 id="定义-7"><a href="#定义-7" class="headerlink" title="定义"></a>定义</h4><p>若对于一个模数p 存在一个a使得a对p的阶等于phi(p) 那么a就叫做p的原根</p>
<h4 id="性质-3"><a href="#性质-3" class="headerlink" title="性质"></a>性质</h4><p>$a^0,a^1,a^2,⋯,a^{\varphi(p)}$ 模 p 两两不同余，且 $a^k\equiv a^{k+\varphi(p)}\pmod p$</p>
<h3 id="泰勒展开-3"><a href="#泰勒展开-3" class="headerlink" title="泰勒展开"></a>泰勒展开</h3><p>回忆微分法</p>
<p>熟知对于一点$x_0$ 我们试图寻找其邻域的某点$x$及其函数值$f(x)$ 我们应该构造关于$(x-x_0)$的一次多项式 $p(x)&#x3D;f(x_0)+f’(x_0)(x-x_0)$  使得$p’(x-x_0)&#x3D;f’(x_0)$</p>
<p>发现该微分法存在以下突出问题:</p>
<ul>
<li>精度损失不确定</li>
<li>精度损失较大</li>
</ul>
<p>于是我们期望能够得到一个多项式$p(x)$ 使得<br>$$<br>p(x)&#x3D;\sum_{i&#x3D;0}^{n}a_i(x-x_0)^i<br>$$<br>并且$p^{(i)}(x-x_0)&#x3D;f^{(n)}(x_0)$</p>
<p>于是设x&#x3D;0连续求导后 $a_i&#x3D;\frac{f^{(i)}(x)}{i!}$</p>
<h3 id="牛顿迭代-3"><a href="#牛顿迭代-3" class="headerlink" title="牛顿迭代"></a>牛顿迭代</h3><p>发现我们在对精度要求不高时可以使用导数(直线)近似代替原函数来近似求解函数根</p>
<p>若对精度要求更高重复使用即可 </p>
<p>这样我们引出迭代公式<br>$$<br>在(x_0,f(x_0))处的切线方程为y-f(x_0)&#x3D;f’(x_0)(x-x_0)<br>\<br>于是x&#x3D;x_0-\frac{f(x_0)}{f’(x_0)}<br>$$</p>
<h2 id="FFT-3"><a href="#FFT-3" class="headerlink" title="FFT"></a>FFT</h2><p>fft是解决多项式乘法(加法卷积)的一种方法</p>
<p>我们发现加法卷积复杂度极高 这是不能被我们承受的</p>
<p>考虑讲要卷的两个多项式求出点值表示 然后把点值相乘 然后插值回答案多项式</p>
<h3 id="DFT-3"><a href="#DFT-3" class="headerlink" title="DFT"></a>DFT</h3><p>dft是进行多项式多点求值的算法 我们发现多项式<br>$$<br>f(x)&#x3D;a_0+a_1x^1+a_2x^2+a_3x^3+a_4x^4+a_5x^5…<br>\<br>可以拆分为<br>\<br>fl(x)&#x3D;a_0+a_2x^1+a_4x^2+a_6x^3…<br>\和\<br>fr(x)&#x3D;a_1+a_3x^1+a_5x^2+a7x^3…<br>\于是\<br>f(x)&#x3D;fl(x^2)+xfr(x^2)<br>\我们试着将单位根带入\<br>f(w_n^k)&#x3D;fl(w_n^{2k})+w_n^kfr(w_n^{2k})&#x3D;fl(w_{n&#x2F;2}^{k})+w_n^kfr(w_{n&#x2F;2}^{k})<br>\并且有\<br>f(w_n^{k+n&#x2F;2})&#x3D;fl(w_n^{2k+n})+w_n^{k+n&#x2F;2}fr(w_n^{2k+n})&#x3D;fl(w_{n&#x2F;2}^{k})-w_n^kfr(w_{n&#x2F;2}^{k})<br>$$<br>我们可以分治求解 复杂度$O(nlogn)$</p>
<h3 id="IDFT-3"><a href="#IDFT-3" class="headerlink" title="IDFT"></a>IDFT</h3><p>idft是进行多项式多点插值的算法</p>
<p>$(y_0,y_1,y_2…y_{n-1})$为$(a_0,a_1,a_2,…a_{n-1})$的点值表示</p>
<p>那么设另一组数列${c_k}$满足$c_k&#x3D;\sum_{i&#x3D;0}^{n-1}y_i(w_n^{-k})^i$</p>
<p>那么<br>$$<br>c_k&#x3D;\sum_{i&#x3D;0}^{n-1}y_i(w_n^{-k})^i<br>\<br>&#x3D;\sum^{n-1}<em>{i&#x3D;0}(\sum^{n-1}</em>{j&#x3D;0}a_j(w^i_n)^j)(w_n^{-k})^i<br>\<br>&#x3D;\sum^{n-1}<em>{i&#x3D;0}(\sum^{n-1}</em>{j&#x3D;0}a_j(w^j_n)^i)(w_n^{-k})^i<br>\<br>&#x3D;\sum^{n-1}<em>{i&#x3D;0}\sum^{n-1}</em>{j&#x3D;0}a_j(w^{j-k}<em>n)^i<br>\<br>&#x3D;\sum^{n-1}</em>{j&#x3D;0}a_j(\sum^{n-1}_{i&#x3D;0}(w^{j-k}_n)^i)<br>$$</p>
<p>那么 我们发现 对于后半个合式 若$j&#x3D;k$ 取值为$n$</p>
<p>若不等呢:</p>
<p>设$j-k&#x3D;s$</p>
<p>利用等比数列求和公式 </p>
<p>后半个合式等于$\frac{(w_n^s)^n-1}{w_n^s}$</p>
<p>上半部等于0</p>
<p>于是$c_k&#x3D;na_k$</p>
<p>把n除过去即可</p>
<h2 id="NTT-3"><a href="#NTT-3" class="headerlink" title="NTT"></a>NTT</h2><p>发现整个fft的过程中都是在做实数运算 精度误差存在且不小 并且复数运算很慢 甚至某些时候需要蝴蝶优化减少递归带来的巨大常数 我们的推导用到了单位根的如下性质:</p>
<p>1 $w_n^k&#x3D;w_{n&#x2F;2}^{k&#x2F;2}$</p>
<p>2 $w_n^{k+n}&#x3D;w_n^k$</p>
<p>3 $w_n^{k+n&#x2F;2}&#x3D;-w_n^k$</p>
<p>4 $w_n^0&#x3D;w_n^n&#x3D;1$</p>
<p>5 n次方内互不相等</p>
<p>惊喜的发现这些性质在模意义下的时原根也具有 </p>
<p>于是在代码中将复数全部换为原根即可</p>
<h2 id="FWT-3"><a href="#FWT-3" class="headerlink" title="FWT"></a>FWT</h2><p>fwt是用于解决一类位运算卷积的算法</p>
<h3 id="基本思想与概览-3"><a href="#基本思想与概览-3" class="headerlink" title="基本思想与概览"></a>基本思想与概览</h3><p>熟知fft是线性的 我们期望fwt也可以得到一个线性函数</p>
<p>我们首先写出位运算卷积的一般形式:<br>$$<br>S[k]&#x3D;\sum_{i\oplus j&#x3D;k}A[i]B[j]<br>$$<br>记作<br>$$<br>S&#x3D;A*B<br>$$<br>其中$\oplus$是某种位运算</p>
<p>设FWT变换系数为$c(i,j)$ 我们设FWT(A)是A经过FWT变换后的数列</p>
<p>需满足:<br>$$<br>A*B&#x3D;C \iff FWT(A)\cdot FWT(B)&#x3D;FWT(B)<br>$$<br>于是<br>$$<br>FWT(A)[i]&#x3D;\sum^{n-1}<em>{j&#x3D;0}c(i,j)A_j<br>$$<br>依<br>$$<br>FWT(A)\cdot FWT(B)&#x3D;FWT(B)<br>$$<br>得<br>$$<br>FWT(A)[i]FWT(B)[i]&#x3D;FWT(c)[I]<br>\<br>\sum^{n-1}</em>{j&#x3D;0}c(i,j)A[j]\sum^{n-1}<em>{k&#x3D;0}c(i,k)B[k]&#x3D;\sum^{n-1}</em>{p&#x3D;0}c(i,p)C[p]<br>\<br>\sum^{n-1}<em>{j&#x3D;0}\sum^{n-1}</em>{k&#x3D;0}c(i,j)c(i,k)A[j]B[k]&#x3D;\sum^{n-1}<em>{p&#x3D;0}c(i,p)C[p]<br>$$<br>依<br>$$<br>C[p]&#x3D;\sum</em>{t_1\oplus t_2&#x3D;p}A[t_1]B[t_2]<br>$$<br>又得<br>$$<br>\sum^{n-1}<em>{p&#x3D;0}c(i,p)C[p]&#x3D;\sum^{n-1}</em>{p&#x3D;0}c(i,p)\sum_{t_1\oplus t_2&#x3D;p}A[t_1]B[t_2]<br>\<br>\sum^{n-1}<em>{j&#x3D;0}\sum^{n-1}</em>{k&#x3D;0}c(i,j)c(i,k)A[j]B[k]&#x3D;\sum^{n-1}<em>{p&#x3D;0}c(i,p)\sum</em>{t_1\oplus t_2&#x3D;p}A[t_1]B[t_2]<br>\<br>\sum^{n-1}<em>{j&#x3D;0}\sum^{n-1}</em>{k&#x3D;0}c(i,j)c(i,k)A[j]B[k]&#x3D;\sum^{n-1}<em>{t_1&#x3D;0}\sum</em>{t_2&#x3D;0}^{n-1}A[t_1]B[t_2]c(i,t_1\oplus t_2)<br>$$<br>对比发现只需使$c(i,j)c(i,k)&#x3D;c(i,j\oplus k)$</p>
<p>另外 由位运算只考虑独立位的特殊性 我们有:</p>
<p>对于一个二进制数a 它的每一位表示为$a_0,a_1,a_2,a_3,a_4,….$</p>
<p>设我们已经知道所有满足要求的c([0,1],[0,1])</p>
<p>那么<br>$$<br>c(i,j)&#x3D;c(i_0,j_0)c(i_1,j_1)c(i_2,j_2),…<br>$$<br>于是<br>$$<br>\prod_p c(i_p,j_p)c(i_p,k_p)&#x3D;\prod_p c(i_p,j_p\oplus k_p)<br>\<br>c(i,j)c(i,k)&#x3D;c(i,j\oplus k)<br>$$<br>由此 只要我们构造出单位的c函数 我们就可以构造出所有数的c函数</p>
<p>我们如何快速求位运算卷积呢</p>
<p>依然考虑分治</p>
<p>首先折半<br>$$<br>FWT(A)[i]&#x3D;\sum_{j&#x3D;0}^{(n&#x2F;2)-1}c(i,j)A[j]+\sum_{j&#x3D;(n&#x2F;2)}^{n-1}c(i,j)A[j]<br>$$<br>对于i,j的首位 我们分开考虑 设i’为i去掉二进制首位的数</p>
<p>于是<br>$$<br>&#x3D;\sum_{j&#x3D;0}^{(n&#x2F;2)-1}c(i_0,j_0)c(i’,j’)A[j]+\sum_{j&#x3D;(n&#x2F;2)}^{n-1}c(i_0,j_0)c(i’,j’)A[j]<br>\<br>&#x3D;c(i_0,0)\sum_{j&#x3D;0}^{(n&#x2F;2)-1}c(i’,j’)A[j]+c(i_0,1)\sum_{j&#x3D;(n&#x2F;2)}^{n-1}c(i_0,j_0)c(i’,j’)A[j]<br>$$<br>加号两边柿子分别递归处理 我们成功缩小了问题的规模</p>
<h3 id="一些例子-3"><a href="#一些例子-3" class="headerlink" title="一些例子"></a>一些例子</h3><p>针对不同位运算 我们需要构造出不同的c([0,1],[0,1]) 再结合上面的推导 问题就得到了解决</p>
<h4 id="Or卷积-3"><a href="#Or卷积-3" class="headerlink" title="Or卷积"></a>Or卷积</h4><p>c([0&#x2F;1],[0&#x2F;1])的矩阵<br>$$<br>\begin{bmatrix}<br>c(0,0)&amp;c(0,1)\<br>c(1,0)&amp;c(1,1)<br>\end{bmatrix}<br>$$</p>
<p>应满足条件 $c(i,j)c(i,k)&#x3D;c(i,j|k)$ </p>
<ul>
<li>$c(0,0)&#x3D;c(0,0|0)\Rightarrow c(0,0)&#x3D;1或0$</li>
<li>$c(0,1)c(0,0)&#x3D; c(0,1|0)\Rightarrow c(0,1)&#x3D;0或c(0,0)&#x3D;c(0,1)&#x3D;1$</li>
<li>$c(1,1)c(1,0)&#x3D;c(1,1|0)\Rightarrow c(1,1)&#x3D;0或c(1,0)&#x3D;c(1,1)&#x3D;1$</li>
</ul>
<p>并且这个矩阵应当是有逆的 否则就无法回去 我们最终选取</p>
<p>$c(0,0)&#x3D;1,c(0,1)&#x3D;0,c(1,0)&#x3D;1,c(1,1)&#x3D;1$</p>
<p>逆变换其实只需矩阵求逆即可 </p>
<p>或者考虑算式的反算式即可</p>
<p>那么同理对于</p>
<h4 id="And卷积-3"><a href="#And卷积-3" class="headerlink" title="And卷积"></a>And卷积</h4><p>有矩阵<br>$$<br>\begin{bmatrix}<br>1&amp;1\<br>0&amp;1<br>\end{bmatrix}<br>$$</p>
<p>和</p>
<h4 id="Xor卷积-3"><a href="#Xor卷积-3" class="headerlink" title="Xor卷积"></a>Xor卷积</h4><p>有矩阵<br>$$<br>\begin{bmatrix}<br>1&amp;1\<br>1&amp;-1<br>\end{bmatrix}<br>$$<br>既得易见平凡 仿照上例显然 留作习题答案略 读者自证不难</p>
<p>反之亦然同理 推论自然成立 略去过程Q E D  由上可知证毕 </p>
<p>​	西江月&#x2F;证明</p>
<h2 id="多项式乘法逆-3"><a href="#多项式乘法逆-3" class="headerlink" title="多项式乘法逆"></a>多项式乘法逆</h2><p>多项式求逆即对于多项式$f(x)$</p>
<p>我们求一个$g(x)$</p>
<p>使得<br>$$<br>g(x)*f(x)\equiv1 \pmod {x^n}<br>$$</p>
<h3 id="倍增法-6"><a href="#倍增法-6" class="headerlink" title="倍增法"></a>倍增法</h3><h4 id="边界-3"><a href="#边界-3" class="headerlink" title="边界"></a>边界</h4><p>当界为$\pmod{x^1}$ 即多项式只有常数项时 直接数字逆元即可</p>
<h4 id="转移-3"><a href="#转移-3" class="headerlink" title="转移"></a>转移</h4><p>假设我们得到了$T(x)\equiv F(x)^{-1} \pmod {x^{n&#x2F;2}}$</p>
<p>显然有$G(x)\equiv T(x)\pmod{x^{n&#x2F;2}}$</p>
<p>那么 $(G(x)-T(x))^2\equiv0\pmod{x^n}$</p>
<p>$G(x)^2-2G(x)T(x)+T(x)^2\equiv0\pmod{x^n}$</p>
<p>同乘$F(x)$</p>
<p>$R(x)-2G(x)-G(x)^2F(x)\equiv0\pmod{x^n}$</p>
<p>运用多项式乘法倍增即可</p>
<h2 id="多项式开根-3"><a href="#多项式开根-3" class="headerlink" title="多项式开根"></a>多项式开根</h2><p>给定$g(x)$ 求$f(x)$满足<br>$$<br>f^2(x)\equiv g(x)\pmod{x^n}<br>$$</p>
<h3 id="倍增法-7"><a href="#倍增法-7" class="headerlink" title="倍增法"></a>倍增法</h3><p>假设已求出$g(x)$在模$x^{[n&#x2F;2]}$意义下的平方根$f_0(x)$ 则有<br>$$<br>f_0^2(x)\equiv g(x) \pmod{x^{[n&#x2F;2]}}<br>\<br>f_0^2(x)-g(x)\equiv 0\pmod{x^{[n&#x2F;2]}}<br>\<br>(f_0^2(x)-g(x))^2\equiv 0\pmod{x^{n}}<br>\<br>(f_0^2(x)+g(x))^2\equiv 4f_0^2(x)g(x)\pmod{x^{n}}<br>\<br>(\frac{f_0^2(x)+g(x)}{2f_0(x)})\equiv g(x)\pmod{x^{n}}<br>\<br>\frac{f_0^2(x)+g(x)}{2f_0(x)}\equiv f(x) \pmod{x^n}<br>\<br>\frac 1 2f_0(x)+2^{-1}f_0^{-1}(x)g(x)\equiv f(x) \pmod{x^n}<br>$$</p>
<h2 id="多项式除法-3"><a href="#多项式除法-3" class="headerlink" title="多项式除法"></a>多项式除法</h2><p>给定多项式$f(x),g(x)$ 求$g(x)$除$f(x)$的商$q(x)$和余数$r(x)$</p>
<p>若能消去$r(x)$的影响则可直接多项式乘法逆</p>
<p>考虑构造<br>$$<br>f_r(x)&#x3D;x^nf(\frac 1 x)<br>$$<br>容易发现其为反转$f(x)$系数</p>
<p>设$n&#x3D;\deg f,m&#x3D;\deg g$</p>
<p>则<br>$$<br>f(x)&#x3D;q(x)g(x)+r(x)\Rightarrow<br>\<br>x^nf(\frac 1 x)&#x3D;x^{n-m}q(\frac 1 x)x^mg(\frac 1 x)+x^{n-m+1}x^{m-1}r(\frac 1 x)<br>\<br>f_r(x)&#x3D;q_r(x)g_r(x)+x^{n-m+1}r_r(x)<br>\<br>于是<br>\<br>f_r(x)\equiv q_r(x)g_r(x)\pmod{x^{n-m+1}}<br>$$<br>多项式求逆$g_r(x)$即可 然后求出$q_r(x)$和$r_r(x)$</p>
<h2 id="多项式ln-3"><a href="#多项式ln-3" class="headerlink" title="多项式ln"></a>多项式ln</h2><p>给定多项式$f(x)$ 求模$x^n$意义下$lnf(x)$</p>
<p>解法本质就是暴力</p>
<p>对多项式先求导再积分即可<br>$$<br>\frac {\text{d}\ln f(x)}{dx}\equiv \frac {1}{f(x)} f’(x)\pmod{x^n}<br>$$</p>
<h2 id="多项式牛顿迭代-3"><a href="#多项式牛顿迭代-3" class="headerlink" title="多项式牛顿迭代"></a>多项式牛顿迭代</h2><p>对于给定$g(x)$ 求$f(x)$ 使得其满足$g(f(x))\equiv 0 \pmod{ x^n}$</p>
<p>假设已经得到了模$x^{[n&#x2F;2]}$次方的解$f_0(x)$ 要求模$x^n$的解$f(x)$</p>
<p>跟据定义我们知道 $f(x)$与$f_0(x)$在前$[n&#x2F;2]-1$位上相等 </p>
<p>那么我们写出$g(f(x))$在$f_0(x)$处的泰勒展开 </p>
<p><img src="https://i.loli.net/2021/07/10/AreopyjgdDlhbU6.png" alt="image-20210710085546653"></p>
<p>发现从第三项往后全部被模掉了 没有意义 我们即可直接用牛顿迭代式计算</p>
<p><img src="https://i.loli.net/2021/07/10/jq9MTVmktfgHaus.png" alt="image-20210710085712805"></p>
<h3 id="应用-3"><a href="#应用-3" class="headerlink" title="应用"></a>应用</h3><h4 id="多项式求逆-3"><a href="#多项式求逆-3" class="headerlink" title="多项式求逆"></a>多项式求逆</h4><p>给定多项式$h(x)$ 有方程<br>$$<br>g(f(x))&#x3D;\frac1 {f(x)}-h(x)\equiv0\pmod0<br>$$<br>应用牛顿迭代有<br>$$<br>\begin{aligned}<br>    f\left(x\right)&amp;\equiv f_{0}\left(x\right)-\frac{\frac{1}{f_{0}\left(x\right)}-h\left(x\right)}{-\frac{1}{f_{0}^{2}\left(x\right)}}&amp;\pmod{x^{n}}\<br>    &amp;\equiv 2f_{0}\left(x\right)-f_{0}^{2}\left(x\right)h\left(x\right)&amp;\pmod{x^{n}}<br>\end{aligned}<br>$$</p>
<h4 id="多项式开方-3"><a href="#多项式开方-3" class="headerlink" title="多项式开方"></a>多项式开方</h4><p>给定多项式$h(x)$ 有方程<br>$$<br>g(f(x))&#x3D;f^2(x)-h(x)\equiv0\pmod{x^n}<br>$$<br>应用牛顿迭代有<br>$$<br>f(x)\equiv f_0(x)-\frac{f_0^2(x)-h(x)}{2f_0(x)}\pmod{x^n}<br>\<br>\equiv\frac{f_0^2(x)+h(x)}{2f_0(x)}\pmod{x^n}<br>$$</p>
<h4 id="多项式exp-3"><a href="#多项式exp-3" class="headerlink" title="多项式exp"></a>多项式exp</h4><p>给定多项式$h(x)$ 有方程<br>$$<br>g(f(x))&#x3D;\ln f(x)-h(x)\pmod {x^n}<br>$$<br>应用牛顿迭代有.<br>$$<br>f(x)\equiv f_0(x)-\frac{\ln f_0(x)-h(x)}{\frac1{f_0(x)}}<br>\<br>f_0(x)(1-ln f_0(x)+h(x))\pmod{x^n}<br>$$</p>
<h1 id="可能是多项式模板全家桶-4"><a href="#可能是多项式模板全家桶-4" class="headerlink" title="可能是多项式模板全家桶"></a>可能是多项式模板全家桶</h1><h1 id="不到-万字长文-4"><a href="#不到-万字长文-4" class="headerlink" title="(不到)万字长文"></a>(不到)万字长文</h1><h1 id="或许是较好理解的板子讲解-4"><a href="#或许是较好理解的板子讲解-4" class="headerlink" title="或许是较好理解的板子讲解"></a>或许是较好理解的板子讲解</h1><p>本文无代码 否则您将学习每天一个常数爆炸小技巧</p>
<p>qwq</p>
<p>阅读本文约需9分钟:</p>
<p><img src="https://i.loli.net/2021/07/10/5n41cEs3UOlhH69.png" alt="image-20210710093833431"></p>
<h2 id="前置知识-4"><a href="#前置知识-4" class="headerlink" title="前置知识:"></a>前置知识:</h2><h3 id="复数-4"><a href="#复数-4" class="headerlink" title="复数"></a>复数</h3><h4 id="虚数单位-4"><a href="#虚数单位-4" class="headerlink" title="虚数单位"></a>虚数单位</h4><p>虚数单位$i&#x3D;\sqrt{(-1)}$</p>
<h4 id="定义-8"><a href="#定义-8" class="headerlink" title="定义"></a>定义</h4><p>复数是形如$a+bi$的数</p>
<h4 id="运算-4"><a href="#运算-4" class="headerlink" title="运算"></a>运算</h4><h5 id="加法-4"><a href="#加法-4" class="headerlink" title="加法"></a>加法</h5><p>复数 $x&#x3D;(a+bi),y&#x3D;(c+di)$的和定义为 $x+y&#x3D;(a+bi)+(c+di)&#x3D;a+c+(d+b)i$</p>
<h5 id="乘法-4"><a href="#乘法-4" class="headerlink" title="乘法"></a>乘法</h5><p>复数 $x&#x3D;(a+bi),y&#x3D;(c+di)$的积定义为$xy&#x3D;(a+bi)(c+di)&#x3D;ac-bd+(ad+cb)i$</p>
<p>发现复数可以用座标表示 如$x&#x3D;(a+bi)$可表示为$(a,b)$ 这样也可以表示为向量 我们记模长为$r&#x3D;\sqrt{a^2+b^2}$ 俯角为$\alpha$ 于是向量表示为$(rcos\alpha,rsin\alpha)$ 发现一个性质 两向量的积$(rcos\alpha,rsin\alpha)(Rcos\beta,Rsin\beta)$等于$(rRcos(\alpha+\beta),rRsin(\alpha+\beta))$ 模长相乘俯角相加</p>
<h3 id="单位根-4"><a href="#单位根-4" class="headerlink" title="单位根"></a>单位根</h3><p>单位根是形如这样的方程的所有的根:<br>$$<br>x^n&#x3D;1<br>$$<br>根据算数基本定理 这样的根在复数域上有n个</p>
<p>我们记第一个为$w_n$ 它应当是某个复数 我们知道 复数乘法满足模长相差俯角相加 那么它在复数域上的几何表示就是单位圆$n$等分后从(0,1)开始转的第一份</p>
<p>我么发现 第一个单位根的k次方$(0&lt;&#x3D;k&lt;&#x3D;n-1)$也是一个单位根</p>
<p>单位根具有以下性质 希望读者自行验证:</p>
<p>1 $w_n^k&#x3D;w_{n&#x2F;2}^{k&#x2F;2}$</p>
<p>2 $w_n^{k+n}&#x3D;w_n^k$</p>
<p>3 $w_n^{k+n&#x2F;2}&#x3D;-w_n^k$</p>
<p>4 $w_n^0&#x3D;w_n^n&#x3D;1$</p>
<h3 id="原根-4"><a href="#原根-4" class="headerlink" title="原根"></a>原根</h3><h4 id="阶-4"><a href="#阶-4" class="headerlink" title="阶"></a>阶</h4><p>对于一个数 a 一个模数 p 存在最小的 y使得<br>$$<br>a^y\equiv1\pmod p<br>$$</p>
<h4 id="定义-9"><a href="#定义-9" class="headerlink" title="定义"></a>定义</h4><p>若对于一个模数p 存在一个a使得a对p的阶等于phi(p) 那么a就叫做p的原根</p>
<h4 id="性质-4"><a href="#性质-4" class="headerlink" title="性质"></a>性质</h4><p>$a^0,a^1,a^2,⋯,a^{\varphi(p)}$ 模 p 两两不同余，且 $a^k\equiv a^{k+\varphi(p)}\pmod p$</p>
<h3 id="泰勒展开-4"><a href="#泰勒展开-4" class="headerlink" title="泰勒展开"></a>泰勒展开</h3><p>回忆微分法</p>
<p>熟知对于一点$x_0$ 我们试图寻找其邻域的某点$x$及其函数值$f(x)$ 我们应该构造关于$(x-x_0)$的一次多项式 $p(x)&#x3D;f(x_0)+f’(x_0)(x-x_0)$  使得$p’(x-x_0)&#x3D;f’(x_0)$</p>
<p>发现该微分法存在以下突出问题:</p>
<ul>
<li>精度损失不确定</li>
<li>精度损失较大</li>
</ul>
<p>于是我们期望能够得到一个多项式$p(x)$ 使得<br>$$<br>p(x)&#x3D;\sum_{i&#x3D;0}^{n}a_i(x-x_0)^i<br>$$<br>并且$p^{(i)}(x-x_0)&#x3D;f^{(n)}(x_0)$</p>
<p>于是设x&#x3D;0连续求导后 $a_i&#x3D;\frac{f^{(i)}(x)}{i!}$</p>
<h3 id="牛顿迭代-4"><a href="#牛顿迭代-4" class="headerlink" title="牛顿迭代"></a>牛顿迭代</h3><p>发现我们在对精度要求不高时可以使用导数(直线)近似代替原函数来近似求解函数根</p>
<p>若对精度要求更高重复使用即可 </p>
<p>这样我们引出迭代公式<br>$$<br>在(x_0,f(x_0))处的切线方程为y-f(x_0)&#x3D;f’(x_0)(x-x_0)<br>\<br>于是x&#x3D;x_0-\frac{f(x_0)}{f’(x_0)}<br>$$</p>
<h2 id="FFT-4"><a href="#FFT-4" class="headerlink" title="FFT"></a>FFT</h2><p>fft是解决多项式乘法(加法卷积)的一种方法</p>
<p>我们发现加法卷积复杂度极高 这是不能被我们承受的</p>
<p>考虑讲要卷的两个多项式求出点值表示 然后把点值相乘 然后插值回答案多项式</p>
<h3 id="DFT-4"><a href="#DFT-4" class="headerlink" title="DFT"></a>DFT</h3><p>dft是进行多项式多点求值的算法 我们发现多项式<br>$$<br>f(x)&#x3D;a_0+a_1x^1+a_2x^2+a_3x^3+a_4x^4+a_5x^5…<br>\<br>可以拆分为<br>\<br>fl(x)&#x3D;a_0+a_2x^1+a_4x^2+a_6x^3…<br>\和\<br>fr(x)&#x3D;a_1+a_3x^1+a_5x^2+a7x^3…<br>\于是\<br>f(x)&#x3D;fl(x^2)+xfr(x^2)<br>\我们试着将单位根带入\<br>f(w_n^k)&#x3D;fl(w_n^{2k})+w_n^kfr(w_n^{2k})&#x3D;fl(w_{n&#x2F;2}^{k})+w_n^kfr(w_{n&#x2F;2}^{k})<br>\并且有\<br>f(w_n^{k+n&#x2F;2})&#x3D;fl(w_n^{2k+n})+w_n^{k+n&#x2F;2}fr(w_n^{2k+n})&#x3D;fl(w_{n&#x2F;2}^{k})-w_n^kfr(w_{n&#x2F;2}^{k})<br>$$<br>我们可以分治求解 复杂度$O(nlogn)$</p>
<h3 id="IDFT-4"><a href="#IDFT-4" class="headerlink" title="IDFT"></a>IDFT</h3><p>idft是进行多项式多点插值的算法</p>
<p>$(y_0,y_1,y_2…y_{n-1})$为$(a_0,a_1,a_2,…a_{n-1})$的点值表示</p>
<p>那么设另一组数列${c_k}$满足$c_k&#x3D;\sum_{i&#x3D;0}^{n-1}y_i(w_n^{-k})^i$</p>
<p>那么<br>$$<br>c_k&#x3D;\sum_{i&#x3D;0}^{n-1}y_i(w_n^{-k})^i<br>\<br>&#x3D;\sum^{n-1}<em>{i&#x3D;0}(\sum^{n-1}</em>{j&#x3D;0}a_j(w^i_n)^j)(w_n^{-k})^i<br>\<br>&#x3D;\sum^{n-1}<em>{i&#x3D;0}(\sum^{n-1}</em>{j&#x3D;0}a_j(w^j_n)^i)(w_n^{-k})^i<br>\<br>&#x3D;\sum^{n-1}<em>{i&#x3D;0}\sum^{n-1}</em>{j&#x3D;0}a_j(w^{j-k}<em>n)^i<br>\<br>&#x3D;\sum^{n-1}</em>{j&#x3D;0}a_j(\sum^{n-1}_{i&#x3D;0}(w^{j-k}_n)^i)<br>$$</p>
<p>那么 我们发现 对于后半个合式 若$j&#x3D;k$ 取值为$n$</p>
<p>若不等呢:</p>
<p>设$j-k&#x3D;s$</p>
<p>利用等比数列求和公式 </p>
<p>后半个合式等于$\frac{(w_n^s)^n-1}{w_n^s}$</p>
<p>上半部等于0</p>
<p>于是$c_k&#x3D;na_k$</p>
<p>把n除过去即可</p>
<h2 id="NTT-4"><a href="#NTT-4" class="headerlink" title="NTT"></a>NTT</h2><p>发现整个fft的过程中都是在做实数运算 精度误差存在且不小 并且复数运算很慢 甚至某些时候需要蝴蝶优化减少递归带来的巨大常数 我们的推导用到了单位根的如下性质:</p>
<p>1 $w_n^k&#x3D;w_{n&#x2F;2}^{k&#x2F;2}$</p>
<p>2 $w_n^{k+n}&#x3D;w_n^k$</p>
<p>3 $w_n^{k+n&#x2F;2}&#x3D;-w_n^k$</p>
<p>4 $w_n^0&#x3D;w_n^n&#x3D;1$</p>
<p>5 n次方内互不相等</p>
<p>惊喜的发现这些性质在模意义下的时原根也具有 </p>
<p>于是在代码中将复数全部换为原根即可</p>
<h2 id="FWT-4"><a href="#FWT-4" class="headerlink" title="FWT"></a>FWT</h2><p>fwt是用于解决一类位运算卷积的算法</p>
<h3 id="基本思想与概览-4"><a href="#基本思想与概览-4" class="headerlink" title="基本思想与概览"></a>基本思想与概览</h3><p>熟知fft是线性的 我们期望fwt也可以得到一个线性函数</p>
<p>我们首先写出位运算卷积的一般形式:<br>$$<br>S[k]&#x3D;\sum_{i\oplus j&#x3D;k}A[i]B[j]<br>$$<br>记作<br>$$<br>S&#x3D;A*B<br>$$<br>其中$\oplus$是某种位运算</p>
<p>设FWT变换系数为$c(i,j)$ 我们设FWT(A)是A经过FWT变换后的数列</p>
<p>需满足:<br>$$<br>A*B&#x3D;C \iff FWT(A)\cdot FWT(B)&#x3D;FWT(B)<br>$$<br>于是<br>$$<br>FWT(A)[i]&#x3D;\sum^{n-1}<em>{j&#x3D;0}c(i,j)A_j<br>$$<br>依<br>$$<br>FWT(A)\cdot FWT(B)&#x3D;FWT(B)<br>$$<br>得<br>$$<br>FWT(A)[i]FWT(B)[i]&#x3D;FWT(c)[I]<br>\<br>\sum^{n-1}</em>{j&#x3D;0}c(i,j)A[j]\sum^{n-1}<em>{k&#x3D;0}c(i,k)B[k]&#x3D;\sum^{n-1}</em>{p&#x3D;0}c(i,p)C[p]<br>\<br>\sum^{n-1}<em>{j&#x3D;0}\sum^{n-1}</em>{k&#x3D;0}c(i,j)c(i,k)A[j]B[k]&#x3D;\sum^{n-1}<em>{p&#x3D;0}c(i,p)C[p]<br>$$<br>依<br>$$<br>C[p]&#x3D;\sum</em>{t_1\oplus t_2&#x3D;p}A[t_1]B[t_2]<br>$$<br>又得<br>$$<br>\sum^{n-1}<em>{p&#x3D;0}c(i,p)C[p]&#x3D;\sum^{n-1}</em>{p&#x3D;0}c(i,p)\sum_{t_1\oplus t_2&#x3D;p}A[t_1]B[t_2]<br>\<br>\sum^{n-1}<em>{j&#x3D;0}\sum^{n-1}</em>{k&#x3D;0}c(i,j)c(i,k)A[j]B[k]&#x3D;\sum^{n-1}<em>{p&#x3D;0}c(i,p)\sum</em>{t_1\oplus t_2&#x3D;p}A[t_1]B[t_2]<br>\<br>\sum^{n-1}<em>{j&#x3D;0}\sum^{n-1}</em>{k&#x3D;0}c(i,j)c(i,k)A[j]B[k]&#x3D;\sum^{n-1}<em>{t_1&#x3D;0}\sum</em>{t_2&#x3D;0}^{n-1}A[t_1]B[t_2]c(i,t_1\oplus t_2)<br>$$<br>对比发现只需使$c(i,j)c(i,k)&#x3D;c(i,j\oplus k)$</p>
<p>另外 由位运算只考虑独立位的特殊性 我们有:</p>
<p>对于一个二进制数a 它的每一位表示为$a_0,a_1,a_2,a_3,a_4,….$</p>
<p>设我们已经知道所有满足要求的c([0,1],[0,1])</p>
<p>那么<br>$$<br>c(i,j)&#x3D;c(i_0,j_0)c(i_1,j_1)c(i_2,j_2),…<br>$$<br>于是<br>$$<br>\prod_p c(i_p,j_p)c(i_p,k_p)&#x3D;\prod_p c(i_p,j_p\oplus k_p)<br>\<br>c(i,j)c(i,k)&#x3D;c(i,j\oplus k)<br>$$<br>由此 只要我们构造出单位的c函数 我们就可以构造出所有数的c函数</p>
<p>我们如何快速求位运算卷积呢</p>
<p>依然考虑分治</p>
<p>首先折半<br>$$<br>FWT(A)[i]&#x3D;\sum_{j&#x3D;0}^{(n&#x2F;2)-1}c(i,j)A[j]+\sum_{j&#x3D;(n&#x2F;2)}^{n-1}c(i,j)A[j]<br>$$<br>对于i,j的首位 我们分开考虑 设i’为i去掉二进制首位的数</p>
<p>于是<br>$$<br>&#x3D;\sum_{j&#x3D;0}^{(n&#x2F;2)-1}c(i_0,j_0)c(i’,j’)A[j]+\sum_{j&#x3D;(n&#x2F;2)}^{n-1}c(i_0,j_0)c(i’,j’)A[j]<br>\<br>&#x3D;c(i_0,0)\sum_{j&#x3D;0}^{(n&#x2F;2)-1}c(i’,j’)A[j]+c(i_0,1)\sum_{j&#x3D;(n&#x2F;2)}^{n-1}c(i_0,j_0)c(i’,j’)A[j]<br>$$<br>加号两边柿子分别递归处理 我们成功缩小了问题的规模</p>
<h3 id="一些例子-4"><a href="#一些例子-4" class="headerlink" title="一些例子"></a>一些例子</h3><p>针对不同位运算 我们需要构造出不同的c([0,1],[0,1]) 再结合上面的推导 问题就得到了解决</p>
<h4 id="Or卷积-4"><a href="#Or卷积-4" class="headerlink" title="Or卷积"></a>Or卷积</h4><p>c([0&#x2F;1],[0&#x2F;1])的矩阵<br>$$<br>\begin{bmatrix}<br>c(0,0)&amp;c(0,1)\<br>c(1,0)&amp;c(1,1)<br>\end{bmatrix}<br>$$</p>
<p>应满足条件 $c(i,j)c(i,k)&#x3D;c(i,j|k)$ </p>
<ul>
<li>$c(0,0)&#x3D;c(0,0|0)\Rightarrow c(0,0)&#x3D;1或0$</li>
<li>$c(0,1)c(0,0)&#x3D; c(0,1|0)\Rightarrow c(0,1)&#x3D;0或c(0,0)&#x3D;c(0,1)&#x3D;1$</li>
<li>$c(1,1)c(1,0)&#x3D;c(1,1|0)\Rightarrow c(1,1)&#x3D;0或c(1,0)&#x3D;c(1,1)&#x3D;1$</li>
</ul>
<p>并且这个矩阵应当是有逆的 否则就无法回去 我们最终选取</p>
<p>$c(0,0)&#x3D;1,c(0,1)&#x3D;0,c(1,0)&#x3D;1,c(1,1)&#x3D;1$</p>
<p>逆变换其实只需矩阵求逆即可 </p>
<p>或者考虑算式的反算式即可</p>
<p>那么同理对于</p>
<h4 id="And卷积-4"><a href="#And卷积-4" class="headerlink" title="And卷积"></a>And卷积</h4><p>有矩阵<br>$$<br>\begin{bmatrix}<br>1&amp;1\<br>0&amp;1<br>\end{bmatrix}<br>$$</p>
<p>和</p>
<h4 id="Xor卷积-4"><a href="#Xor卷积-4" class="headerlink" title="Xor卷积"></a>Xor卷积</h4><p>有矩阵<br>$$<br>\begin{bmatrix}<br>1&amp;1\<br>1&amp;-1<br>\end{bmatrix}<br>$$<br>既得易见平凡 仿照上例显然 留作习题答案略 读者自证不难</p>
<p>反之亦然同理 推论自然成立 略去过程Q E D  由上可知证毕 </p>
<p>​	西江月&#x2F;证明</p>
<h2 id="多项式乘法逆-4"><a href="#多项式乘法逆-4" class="headerlink" title="多项式乘法逆"></a>多项式乘法逆</h2><p>多项式求逆即对于多项式$f(x)$</p>
<p>我们求一个$g(x)$</p>
<p>使得<br>$$<br>g(x)*f(x)\equiv1 \pmod {x^n}<br>$$</p>
<h3 id="倍增法-8"><a href="#倍增法-8" class="headerlink" title="倍增法"></a>倍增法</h3><h4 id="边界-4"><a href="#边界-4" class="headerlink" title="边界"></a>边界</h4><p>当界为$\pmod{x^1}$ 即多项式只有常数项时 直接数字逆元即可</p>
<h4 id="转移-4"><a href="#转移-4" class="headerlink" title="转移"></a>转移</h4><p>假设我们得到了$T(x)\equiv F(x)^{-1} \pmod {x^{n&#x2F;2}}$</p>
<p>显然有$G(x)\equiv T(x)\pmod{x^{n&#x2F;2}}$</p>
<p>那么 $(G(x)-T(x))^2\equiv0\pmod{x^n}$</p>
<p>$G(x)^2-2G(x)T(x)+T(x)^2\equiv0\pmod{x^n}$</p>
<p>同乘$F(x)$</p>
<p>$R(x)-2G(x)-G(x)^2F(x)\equiv0\pmod{x^n}$</p>
<p>运用多项式乘法倍增即可</p>
<h2 id="多项式开根-4"><a href="#多项式开根-4" class="headerlink" title="多项式开根"></a>多项式开根</h2><p>给定$g(x)$ 求$f(x)$满足<br>$$<br>f^2(x)\equiv g(x)\pmod{x^n}<br>$$</p>
<h3 id="倍增法-9"><a href="#倍增法-9" class="headerlink" title="倍增法"></a>倍增法</h3><p>假设已求出$g(x)$在模$x^{[n&#x2F;2]}$意义下的平方根$f_0(x)$ 则有<br>$$<br>f_0^2(x)\equiv g(x) \pmod{x^{[n&#x2F;2]}}<br>\<br>f_0^2(x)-g(x)\equiv 0\pmod{x^{[n&#x2F;2]}}<br>\<br>(f_0^2(x)-g(x))^2\equiv 0\pmod{x^{n}}<br>\<br>(f_0^2(x)+g(x))^2\equiv 4f_0^2(x)g(x)\pmod{x^{n}}<br>\<br>(\frac{f_0^2(x)+g(x)}{2f_0(x)})\equiv g(x)\pmod{x^{n}}<br>\<br>\frac{f_0^2(x)+g(x)}{2f_0(x)}\equiv f(x) \pmod{x^n}<br>\<br>\frac 1 2f_0(x)+2^{-1}f_0^{-1}(x)g(x)\equiv f(x) \pmod{x^n}<br>$$</p>
<h2 id="多项式除法-4"><a href="#多项式除法-4" class="headerlink" title="多项式除法"></a>多项式除法</h2><p>给定多项式$f(x),g(x)$ 求$g(x)$除$f(x)$的商$q(x)$和余数$r(x)$</p>
<p>若能消去$r(x)$的影响则可直接多项式乘法逆</p>
<p>考虑构造<br>$$<br>f_r(x)&#x3D;x^nf(\frac 1 x)<br>$$<br>容易发现其为反转$f(x)$系数</p>
<p>设$n&#x3D;\deg f,m&#x3D;\deg g$</p>
<p>则<br>$$<br>f(x)&#x3D;q(x)g(x)+r(x)\Rightarrow<br>\<br>x^nf(\frac 1 x)&#x3D;x^{n-m}q(\frac 1 x)x^mg(\frac 1 x)+x^{n-m+1}x^{m-1}r(\frac 1 x)<br>\<br>f_r(x)&#x3D;q_r(x)g_r(x)+x^{n-m+1}r_r(x)<br>\<br>于是<br>\<br>f_r(x)\equiv q_r(x)g_r(x)\pmod{x^{n-m+1}}<br>$$<br>多项式求逆$g_r(x)$即可 然后求出$q_r(x)$和$r_r(x)$</p>
<h2 id="多项式ln-4"><a href="#多项式ln-4" class="headerlink" title="多项式ln"></a>多项式ln</h2><p>给定多项式$f(x)$ 求模$x^n$意义下$lnf(x)$</p>
<p>解法本质就是暴力</p>
<p>对多项式先求导再积分即可<br>$$<br>\frac {\text{d}\ln f(x)}{dx}\equiv \frac {1}{f(x)} f’(x)\pmod{x^n}<br>$$</p>
<h2 id="多项式牛顿迭代-4"><a href="#多项式牛顿迭代-4" class="headerlink" title="多项式牛顿迭代"></a>多项式牛顿迭代</h2><p>对于给定$g(x)$ 求$f(x)$ 使得其满足$g(f(x))\equiv 0 \pmod{ x^n}$</p>
<p>假设已经得到了模$x^{[n&#x2F;2]}$次方的解$f_0(x)$ 要求模$x^n$的解$f(x)$</p>
<p>跟据定义我们知道 $f(x)$与$f_0(x)$在前$[n&#x2F;2]-1$位上相等 </p>
<p>那么我们写出$g(f(x))$在$f_0(x)$处的泰勒展开 </p>
<p><img src="https://i.loli.net/2021/07/10/AreopyjgdDlhbU6.png" alt="image-20210710085546653"></p>
<p>发现从第三项往后全部被模掉了 没有意义 我们即可直接用牛顿迭代式计算</p>
<p><img src="https://i.loli.net/2021/07/10/jq9MTVmktfgHaus.png" alt="image-20210710085712805"></p>
<h3 id="应用-4"><a href="#应用-4" class="headerlink" title="应用"></a>应用</h3><h4 id="多项式求逆-4"><a href="#多项式求逆-4" class="headerlink" title="多项式求逆"></a>多项式求逆</h4><p>给定多项式$h(x)$ 有方程<br>$$<br>g(f(x))&#x3D;\frac1 {f(x)}-h(x)\equiv0\pmod0<br>$$<br>应用牛顿迭代有<br>$$<br>\begin{aligned}<br>    f\left(x\right)&amp;\equiv f_{0}\left(x\right)-\frac{\frac{1}{f_{0}\left(x\right)}-h\left(x\right)}{-\frac{1}{f_{0}^{2}\left(x\right)}}&amp;\pmod{x^{n}}\<br>    &amp;\equiv 2f_{0}\left(x\right)-f_{0}^{2}\left(x\right)h\left(x\right)&amp;\pmod{x^{n}}<br>\end{aligned}<br>$$</p>
<h4 id="多项式开方-4"><a href="#多项式开方-4" class="headerlink" title="多项式开方"></a>多项式开方</h4><p>给定多项式$h(x)$ 有方程<br>$$<br>g(f(x))&#x3D;f^2(x)-h(x)\equiv0\pmod{x^n}<br>$$<br>应用牛顿迭代有<br>$$<br>f(x)\equiv f_0(x)-\frac{f_0^2(x)-h(x)}{2f_0(x)}\pmod{x^n}<br>\<br>\equiv\frac{f_0^2(x)+h(x)}{2f_0(x)}\pmod{x^n}<br>$$</p>
<h4 id="多项式exp-4"><a href="#多项式exp-4" class="headerlink" title="多项式exp"></a>多项式exp</h4><p>给定多项式$h(x)$ 有方程<br>$$<br>g(f(x))&#x3D;\ln f(x)-h(x)\pmod {x^n}<br>$$<br>应用牛顿迭代有.<br>$$<br>f(x)\equiv f_0(x)-\frac{\ln f_0(x)-h(x)}{\frac1{f_0(x)}}<br>\<br>f_0(x)(1-ln f_0(x)+h(x))\pmod{x^n}<br>$$</p>
<h1 id="可能是多项式模板全家桶-5"><a href="#可能是多项式模板全家桶-5" class="headerlink" title="可能是多项式模板全家桶"></a>可能是多项式模板全家桶</h1><h1 id="不到-万字长文-5"><a href="#不到-万字长文-5" class="headerlink" title="(不到)万字长文"></a>(不到)万字长文</h1><h1 id="或许是较好理解的板子讲解-5"><a href="#或许是较好理解的板子讲解-5" class="headerlink" title="或许是较好理解的板子讲解"></a>或许是较好理解的板子讲解</h1><p>本文无代码 否则您将学习每天一个常数爆炸小技巧</p>
<p>qwq</p>
<p>阅读本文约需9分钟:</p>
<p><img src="https://i.loli.net/2021/07/10/5n41cEs3UOlhH69.png" alt="image-20210710093833431"></p>
<h2 id="前置知识-5"><a href="#前置知识-5" class="headerlink" title="前置知识:"></a>前置知识:</h2><h3 id="复数-5"><a href="#复数-5" class="headerlink" title="复数"></a>复数</h3><h4 id="虚数单位-5"><a href="#虚数单位-5" class="headerlink" title="虚数单位"></a>虚数单位</h4><p>虚数单位$i&#x3D;\sqrt{(-1)}$</p>
<h4 id="定义-10"><a href="#定义-10" class="headerlink" title="定义"></a>定义</h4><p>复数是形如$a+bi$的数</p>
<h4 id="运算-5"><a href="#运算-5" class="headerlink" title="运算"></a>运算</h4><h5 id="加法-5"><a href="#加法-5" class="headerlink" title="加法"></a>加法</h5><p>复数 $x&#x3D;(a+bi),y&#x3D;(c+di)$的和定义为 $x+y&#x3D;(a+bi)+(c+di)&#x3D;a+c+(d+b)i$</p>
<h5 id="乘法-5"><a href="#乘法-5" class="headerlink" title="乘法"></a>乘法</h5><p>复数 $x&#x3D;(a+bi),y&#x3D;(c+di)$的积定义为$xy&#x3D;(a+bi)(c+di)&#x3D;ac-bd+(ad+cb)i$</p>
<p>发现复数可以用座标表示 如$x&#x3D;(a+bi)$可表示为$(a,b)$ 这样也可以表示为向量 我们记模长为$r&#x3D;\sqrt{a^2+b^2}$ 俯角为$\alpha$ 于是向量表示为$(rcos\alpha,rsin\alpha)$ 发现一个性质 两向量的积$(rcos\alpha,rsin\alpha)(Rcos\beta,Rsin\beta)$等于$(rRcos(\alpha+\beta),rRsin(\alpha+\beta))$ 模长相乘俯角相加</p>
<h3 id="单位根-5"><a href="#单位根-5" class="headerlink" title="单位根"></a>单位根</h3><p>单位根是形如这样的方程的所有的根:<br>$$<br>x^n&#x3D;1<br>$$<br>根据算数基本定理 这样的根在复数域上有n个</p>
<p>我们记第一个为$w_n$ 它应当是某个复数 我们知道 复数乘法满足模长相差俯角相加 那么它在复数域上的几何表示就是单位圆$n$等分后从(0,1)开始转的第一份</p>
<p>我么发现 第一个单位根的k次方$(0&lt;&#x3D;k&lt;&#x3D;n-1)$也是一个单位根</p>
<p>单位根具有以下性质 希望读者自行验证:</p>
<p>1 $w_n^k&#x3D;w_{n&#x2F;2}^{k&#x2F;2}$</p>
<p>2 $w_n^{k+n}&#x3D;w_n^k$</p>
<p>3 $w_n^{k+n&#x2F;2}&#x3D;-w_n^k$</p>
<p>4 $w_n^0&#x3D;w_n^n&#x3D;1$</p>
<h3 id="原根-5"><a href="#原根-5" class="headerlink" title="原根"></a>原根</h3><h4 id="阶-5"><a href="#阶-5" class="headerlink" title="阶"></a>阶</h4><p>对于一个数 a 一个模数 p 存在最小的 y使得<br>$$<br>a^y\equiv1\pmod p<br>$$</p>
<h4 id="定义-11"><a href="#定义-11" class="headerlink" title="定义"></a>定义</h4><p>若对于一个模数p 存在一个a使得a对p的阶等于phi(p) 那么a就叫做p的原根</p>
<h4 id="性质-5"><a href="#性质-5" class="headerlink" title="性质"></a>性质</h4><p>$a^0,a^1,a^2,⋯,a^{\varphi(p)}$ 模 p 两两不同余，且 $a^k\equiv a^{k+\varphi(p)}\pmod p$</p>
<h3 id="泰勒展开-5"><a href="#泰勒展开-5" class="headerlink" title="泰勒展开"></a>泰勒展开</h3><p>回忆微分法</p>
<p>熟知对于一点$x_0$ 我们试图寻找其邻域的某点$x$及其函数值$f(x)$ 我们应该构造关于$(x-x_0)$的一次多项式 $p(x)&#x3D;f(x_0)+f’(x_0)(x-x_0)$  使得$p’(x-x_0)&#x3D;f’(x_0)$</p>
<p>发现该微分法存在以下突出问题:</p>
<ul>
<li>精度损失不确定</li>
<li>精度损失较大</li>
</ul>
<p>于是我们期望能够得到一个多项式$p(x)$ 使得<br>$$<br>p(x)&#x3D;\sum_{i&#x3D;0}^{n}a_i(x-x_0)^i<br>$$<br>并且$p^{(i)}(x-x_0)&#x3D;f^{(n)}(x_0)$</p>
<p>于是设x&#x3D;0连续求导后 $a_i&#x3D;\frac{f^{(i)}(x)}{i!}$</p>
<h3 id="牛顿迭代-5"><a href="#牛顿迭代-5" class="headerlink" title="牛顿迭代"></a>牛顿迭代</h3><p>发现我们在对精度要求不高时可以使用导数(直线)近似代替原函数来近似求解函数根</p>
<p>若对精度要求更高重复使用即可 </p>
<p>这样我们引出迭代公式<br>$$<br>在(x_0,f(x_0))处的切线方程为y-f(x_0)&#x3D;f’(x_0)(x-x_0)<br>\<br>于是x&#x3D;x_0-\frac{f(x_0)}{f’(x_0)}<br>$$</p>
<h2 id="FFT-5"><a href="#FFT-5" class="headerlink" title="FFT"></a>FFT</h2><p>fft是解决多项式乘法(加法卷积)的一种方法</p>
<p>我们发现加法卷积复杂度极高 这是不能被我们承受的</p>
<p>考虑讲要卷的两个多项式求出点值表示 然后把点值相乘 然后插值回答案多项式</p>
<h3 id="DFT-5"><a href="#DFT-5" class="headerlink" title="DFT"></a>DFT</h3><p>dft是进行多项式多点求值的算法 我们发现多项式<br>$$<br>f(x)&#x3D;a_0+a_1x^1+a_2x^2+a_3x^3+a_4x^4+a_5x^5…<br>\<br>可以拆分为<br>\<br>fl(x)&#x3D;a_0+a_2x^1+a_4x^2+a_6x^3…<br>\和\<br>fr(x)&#x3D;a_1+a_3x^1+a_5x^2+a7x^3…<br>\于是\<br>f(x)&#x3D;fl(x^2)+xfr(x^2)<br>\我们试着将单位根带入\<br>f(w_n^k)&#x3D;fl(w_n^{2k})+w_n^kfr(w_n^{2k})&#x3D;fl(w_{n&#x2F;2}^{k})+w_n^kfr(w_{n&#x2F;2}^{k})<br>\并且有\<br>f(w_n^{k+n&#x2F;2})&#x3D;fl(w_n^{2k+n})+w_n^{k+n&#x2F;2}fr(w_n^{2k+n})&#x3D;fl(w_{n&#x2F;2}^{k})-w_n^kfr(w_{n&#x2F;2}^{k})<br>$$<br>我们可以分治求解 复杂度$O(nlogn)$</p>
<h3 id="IDFT-5"><a href="#IDFT-5" class="headerlink" title="IDFT"></a>IDFT</h3><p>idft是进行多项式多点插值的算法</p>
<p>$(y_0,y_1,y_2…y_{n-1})$为$(a_0,a_1,a_2,…a_{n-1})$的点值表示</p>
<p>那么设另一组数列${c_k}$满足$c_k&#x3D;\sum_{i&#x3D;0}^{n-1}y_i(w_n^{-k})^i$</p>
<p>那么<br>$$<br>c_k&#x3D;\sum_{i&#x3D;0}^{n-1}y_i(w_n^{-k})^i<br>\<br>&#x3D;\sum^{n-1}<em>{i&#x3D;0}(\sum^{n-1}</em>{j&#x3D;0}a_j(w^i_n)^j)(w_n^{-k})^i<br>\<br>&#x3D;\sum^{n-1}<em>{i&#x3D;0}(\sum^{n-1}</em>{j&#x3D;0}a_j(w^j_n)^i)(w_n^{-k})^i<br>\<br>&#x3D;\sum^{n-1}<em>{i&#x3D;0}\sum^{n-1}</em>{j&#x3D;0}a_j(w^{j-k}<em>n)^i<br>\<br>&#x3D;\sum^{n-1}</em>{j&#x3D;0}a_j(\sum^{n-1}_{i&#x3D;0}(w^{j-k}_n)^i)<br>$$</p>
<p>那么 我们发现 对于后半个合式 若$j&#x3D;k$ 取值为$n$</p>
<p>若不等呢:</p>
<p>设$j-k&#x3D;s$</p>
<p>利用等比数列求和公式 </p>
<p>后半个合式等于$\frac{(w_n^s)^n-1}{w_n^s}$</p>
<p>上半部等于0</p>
<p>于是$c_k&#x3D;na_k$</p>
<p>把n除过去即可</p>
<h2 id="NTT-5"><a href="#NTT-5" class="headerlink" title="NTT"></a>NTT</h2><p>发现整个fft的过程中都是在做实数运算 精度误差存在且不小 并且复数运算很慢 甚至某些时候需要蝴蝶优化减少递归带来的巨大常数 我们的推导用到了单位根的如下性质:</p>
<p>1 $w_n^k&#x3D;w_{n&#x2F;2}^{k&#x2F;2}$</p>
<p>2 $w_n^{k+n}&#x3D;w_n^k$</p>
<p>3 $w_n^{k+n&#x2F;2}&#x3D;-w_n^k$</p>
<p>4 $w_n^0&#x3D;w_n^n&#x3D;1$</p>
<p>5 n次方内互不相等</p>
<p>惊喜的发现这些性质在模意义下的时原根也具有 </p>
<p>于是在代码中将复数全部换为原根即可</p>
<h2 id="FWT-5"><a href="#FWT-5" class="headerlink" title="FWT"></a>FWT</h2><p>fwt是用于解决一类位运算卷积的算法</p>
<h3 id="基本思想与概览-5"><a href="#基本思想与概览-5" class="headerlink" title="基本思想与概览"></a>基本思想与概览</h3><p>熟知fft是线性的 我们期望fwt也可以得到一个线性函数</p>
<p>我们首先写出位运算卷积的一般形式:<br>$$<br>S[k]&#x3D;\sum_{i\oplus j&#x3D;k}A[i]B[j]<br>$$<br>记作<br>$$<br>S&#x3D;A*B<br>$$<br>其中$\oplus$是某种位运算</p>
<p>设FWT变换系数为$c(i,j)$ 我们设FWT(A)是A经过FWT变换后的数列</p>
<p>需满足:<br>$$<br>A*B&#x3D;C \iff FWT(A)\cdot FWT(B)&#x3D;FWT(B)<br>$$<br>于是<br>$$<br>FWT(A)[i]&#x3D;\sum^{n-1}<em>{j&#x3D;0}c(i,j)A_j<br>$$<br>依<br>$$<br>FWT(A)\cdot FWT(B)&#x3D;FWT(B)<br>$$<br>得<br>$$<br>FWT(A)[i]FWT(B)[i]&#x3D;FWT(c)[I]<br>\<br>\sum^{n-1}</em>{j&#x3D;0}c(i,j)A[j]\sum^{n-1}<em>{k&#x3D;0}c(i,k)B[k]&#x3D;\sum^{n-1}</em>{p&#x3D;0}c(i,p)C[p]<br>\<br>\sum^{n-1}<em>{j&#x3D;0}\sum^{n-1}</em>{k&#x3D;0}c(i,j)c(i,k)A[j]B[k]&#x3D;\sum^{n-1}<em>{p&#x3D;0}c(i,p)C[p]<br>$$<br>依<br>$$<br>C[p]&#x3D;\sum</em>{t_1\oplus t_2&#x3D;p}A[t_1]B[t_2]<br>$$<br>又得<br>$$<br>\sum^{n-1}<em>{p&#x3D;0}c(i,p)C[p]&#x3D;\sum^{n-1}</em>{p&#x3D;0}c(i,p)\sum_{t_1\oplus t_2&#x3D;p}A[t_1]B[t_2]<br>\<br>\sum^{n-1}<em>{j&#x3D;0}\sum^{n-1}</em>{k&#x3D;0}c(i,j)c(i,k)A[j]B[k]&#x3D;\sum^{n-1}<em>{p&#x3D;0}c(i,p)\sum</em>{t_1\oplus t_2&#x3D;p}A[t_1]B[t_2]<br>\<br>\sum^{n-1}<em>{j&#x3D;0}\sum^{n-1}</em>{k&#x3D;0}c(i,j)c(i,k)A[j]B[k]&#x3D;\sum^{n-1}<em>{t_1&#x3D;0}\sum</em>{t_2&#x3D;0}^{n-1}A[t_1]B[t_2]c(i,t_1\oplus t_2)<br>$$<br>对比发现只需使$c(i,j)c(i,k)&#x3D;c(i,j\oplus k)$</p>
<p>另外 由位运算只考虑独立位的特殊性 我们有:</p>
<p>对于一个二进制数a 它的每一位表示为$a_0,a_1,a_2,a_3,a_4,….$</p>
<p>设我们已经知道所有满足要求的c([0,1],[0,1])</p>
<p>那么<br>$$<br>c(i,j)&#x3D;c(i_0,j_0)c(i_1,j_1)c(i_2,j_2),…<br>$$<br>于是<br>$$<br>\prod_p c(i_p,j_p)c(i_p,k_p)&#x3D;\prod_p c(i_p,j_p\oplus k_p)<br>\<br>c(i,j)c(i,k)&#x3D;c(i,j\oplus k)<br>$$<br>由此 只要我们构造出单位的c函数 我们就可以构造出所有数的c函数</p>
<p>我们如何快速求位运算卷积呢</p>
<p>依然考虑分治</p>
<p>首先折半<br>$$<br>FWT(A)[i]&#x3D;\sum_{j&#x3D;0}^{(n&#x2F;2)-1}c(i,j)A[j]+\sum_{j&#x3D;(n&#x2F;2)}^{n-1}c(i,j)A[j]<br>$$<br>对于i,j的首位 我们分开考虑 设i’为i去掉二进制首位的数</p>
<p>于是<br>$$<br>&#x3D;\sum_{j&#x3D;0}^{(n&#x2F;2)-1}c(i_0,j_0)c(i’,j’)A[j]+\sum_{j&#x3D;(n&#x2F;2)}^{n-1}c(i_0,j_0)c(i’,j’)A[j]<br>\<br>&#x3D;c(i_0,0)\sum_{j&#x3D;0}^{(n&#x2F;2)-1}c(i’,j’)A[j]+c(i_0,1)\sum_{j&#x3D;(n&#x2F;2)}^{n-1}c(i_0,j_0)c(i’,j’)A[j]<br>$$<br>加号两边柿子分别递归处理 我们成功缩小了问题的规模</p>
<h3 id="一些例子-5"><a href="#一些例子-5" class="headerlink" title="一些例子"></a>一些例子</h3><p>针对不同位运算 我们需要构造出不同的c([0,1],[0,1]) 再结合上面的推导 问题就得到了解决</p>
<h4 id="Or卷积-5"><a href="#Or卷积-5" class="headerlink" title="Or卷积"></a>Or卷积</h4><p>c([0&#x2F;1],[0&#x2F;1])的矩阵<br>$$<br>\begin{bmatrix}<br>c(0,0)&amp;c(0,1)\<br>c(1,0)&amp;c(1,1)<br>\end{bmatrix}<br>$$</p>
<p>应满足条件 $c(i,j)c(i,k)&#x3D;c(i,j|k)$ </p>
<ul>
<li>$c(0,0)&#x3D;c(0,0|0)\Rightarrow c(0,0)&#x3D;1或0$</li>
<li>$c(0,1)c(0,0)&#x3D; c(0,1|0)\Rightarrow c(0,1)&#x3D;0或c(0,0)&#x3D;c(0,1)&#x3D;1$</li>
<li>$c(1,1)c(1,0)&#x3D;c(1,1|0)\Rightarrow c(1,1)&#x3D;0或c(1,0)&#x3D;c(1,1)&#x3D;1$</li>
</ul>
<p>并且这个矩阵应当是有逆的 否则就无法回去 我们最终选取</p>
<p>$c(0,0)&#x3D;1,c(0,1)&#x3D;0,c(1,0)&#x3D;1,c(1,1)&#x3D;1$</p>
<p>逆变换其实只需矩阵求逆即可 </p>
<p>或者考虑算式的反算式即可</p>
<p>那么同理对于</p>
<h4 id="And卷积-5"><a href="#And卷积-5" class="headerlink" title="And卷积"></a>And卷积</h4><p>有矩阵<br>$$<br>\begin{bmatrix}<br>1&amp;1\<br>0&amp;1<br>\end{bmatrix}<br>$$</p>
<p>和</p>
<h4 id="Xor卷积-5"><a href="#Xor卷积-5" class="headerlink" title="Xor卷积"></a>Xor卷积</h4><p>有矩阵<br>$$<br>\begin{bmatrix}<br>1&amp;1\<br>1&amp;-1<br>\end{bmatrix}<br>$$<br>既得易见平凡 仿照上例显然 留作习题答案略 读者自证不难</p>
<p>反之亦然同理 推论自然成立 略去过程Q E D  由上可知证毕 </p>
<p>​	西江月&#x2F;证明</p>
<h2 id="多项式乘法逆-5"><a href="#多项式乘法逆-5" class="headerlink" title="多项式乘法逆"></a>多项式乘法逆</h2><p>多项式求逆即对于多项式$f(x)$</p>
<p>我们求一个$g(x)$</p>
<p>使得<br>$$<br>g(x)*f(x)\equiv1 \pmod {x^n}<br>$$</p>
<h3 id="倍增法-10"><a href="#倍增法-10" class="headerlink" title="倍增法"></a>倍增法</h3><h4 id="边界-5"><a href="#边界-5" class="headerlink" title="边界"></a>边界</h4><p>当界为$\pmod{x^1}$ 即多项式只有常数项时 直接数字逆元即可</p>
<h4 id="转移-5"><a href="#转移-5" class="headerlink" title="转移"></a>转移</h4><p>假设我们得到了$T(x)\equiv F(x)^{-1} \pmod {x^{n&#x2F;2}}$</p>
<p>显然有$G(x)\equiv T(x)\pmod{x^{n&#x2F;2}}$</p>
<p>那么 $(G(x)-T(x))^2\equiv0\pmod{x^n}$</p>
<p>$G(x)^2-2G(x)T(x)+T(x)^2\equiv0\pmod{x^n}$</p>
<p>同乘$F(x)$</p>
<p>$R(x)-2G(x)-G(x)^2F(x)\equiv0\pmod{x^n}$</p>
<p>运用多项式乘法倍增即可</p>
<h2 id="多项式开根-5"><a href="#多项式开根-5" class="headerlink" title="多项式开根"></a>多项式开根</h2><p>给定$g(x)$ 求$f(x)$满足<br>$$<br>f^2(x)\equiv g(x)\pmod{x^n}<br>$$</p>
<h3 id="倍增法-11"><a href="#倍增法-11" class="headerlink" title="倍增法"></a>倍增法</h3><p>假设已求出$g(x)$在模$x^{[n&#x2F;2]}$意义下的平方根$f_0(x)$ 则有<br>$$<br>f_0^2(x)\equiv g(x) \pmod{x^{[n&#x2F;2]}}<br>\<br>f_0^2(x)-g(x)\equiv 0\pmod{x^{[n&#x2F;2]}}<br>\<br>(f_0^2(x)-g(x))^2\equiv 0\pmod{x^{n}}<br>\<br>(f_0^2(x)+g(x))^2\equiv 4f_0^2(x)g(x)\pmod{x^{n}}<br>\<br>(\frac{f_0^2(x)+g(x)}{2f_0(x)})\equiv g(x)\pmod{x^{n}}<br>\<br>\frac{f_0^2(x)+g(x)}{2f_0(x)}\equiv f(x) \pmod{x^n}<br>\<br>\frac 1 2f_0(x)+2^{-1}f_0^{-1}(x)g(x)\equiv f(x) \pmod{x^n}<br>$$</p>
<h2 id="多项式除法-5"><a href="#多项式除法-5" class="headerlink" title="多项式除法"></a>多项式除法</h2><p>给定多项式$f(x),g(x)$ 求$g(x)$除$f(x)$的商$q(x)$和余数$r(x)$</p>
<p>若能消去$r(x)$的影响则可直接多项式乘法逆</p>
<p>考虑构造<br>$$<br>f_r(x)&#x3D;x^nf(\frac 1 x)<br>$$<br>容易发现其为反转$f(x)$系数</p>
<p>设$n&#x3D;\deg f,m&#x3D;\deg g$</p>
<p>则<br>$$<br>f(x)&#x3D;q(x)g(x)+r(x)\Rightarrow<br>\<br>x^nf(\frac 1 x)&#x3D;x^{n-m}q(\frac 1 x)x^mg(\frac 1 x)+x^{n-m+1}x^{m-1}r(\frac 1 x)<br>\<br>f_r(x)&#x3D;q_r(x)g_r(x)+x^{n-m+1}r_r(x)<br>\<br>于是<br>\<br>f_r(x)\equiv q_r(x)g_r(x)\pmod{x^{n-m+1}}<br>$$<br>多项式求逆$g_r(x)$即可 然后求出$q_r(x)$和$r_r(x)$</p>
<h2 id="多项式ln-5"><a href="#多项式ln-5" class="headerlink" title="多项式ln"></a>多项式ln</h2><p>给定多项式$f(x)$ 求模$x^n$意义下$lnf(x)$</p>
<p>解法本质就是暴力</p>
<p>对多项式先求导再积分即可<br>$$<br>\frac {\text{d}\ln f(x)}{dx}\equiv \frac {1}{f(x)} f’(x)\pmod{x^n}<br>$$</p>
<h2 id="多项式牛顿迭代-5"><a href="#多项式牛顿迭代-5" class="headerlink" title="多项式牛顿迭代"></a>多项式牛顿迭代</h2><p>对于给定$g(x)$ 求$f(x)$ 使得其满足$g(f(x))\equiv 0 \pmod{ x^n}$</p>
<p>假设已经得到了模$x^{[n&#x2F;2]}$次方的解$f_0(x)$ 要求模$x^n$的解$f(x)$</p>
<p>跟据定义我们知道 $f(x)$与$f_0(x)$在前$[n&#x2F;2]-1$位上相等 </p>
<p>那么我们写出$g(f(x))$在$f_0(x)$处的泰勒展开 </p>
<p><img src="https://i.loli.net/2021/07/10/AreopyjgdDlhbU6.png" alt="image-20210710085546653"></p>
<p>发现从第三项往后全部被模掉了 没有意义 我们即可直接用牛顿迭代式计算</p>
<p><img src="https://i.loli.net/2021/07/10/jq9MTVmktfgHaus.png" alt="image-20210710085712805"></p>
<h3 id="应用-5"><a href="#应用-5" class="headerlink" title="应用"></a>应用</h3><h4 id="多项式求逆-5"><a href="#多项式求逆-5" class="headerlink" title="多项式求逆"></a>多项式求逆</h4><p>给定多项式$h(x)$ 有方程<br>$$<br>g(f(x))&#x3D;\frac1 {f(x)}-h(x)\equiv0\pmod0<br>$$<br>应用牛顿迭代有<br>$$<br>\begin{aligned}<br>    f\left(x\right)&amp;\equiv f_{0}\left(x\right)-\frac{\frac{1}{f_{0}\left(x\right)}-h\left(x\right)}{-\frac{1}{f_{0}^{2}\left(x\right)}}&amp;\pmod{x^{n}}\<br>    &amp;\equiv 2f_{0}\left(x\right)-f_{0}^{2}\left(x\right)h\left(x\right)&amp;\pmod{x^{n}}<br>\end{aligned}<br>$$</p>
<h4 id="多项式开方-5"><a href="#多项式开方-5" class="headerlink" title="多项式开方"></a>多项式开方</h4><p>给定多项式$h(x)$ 有方程<br>$$<br>g(f(x))&#x3D;f^2(x)-h(x)\equiv0\pmod{x^n}<br>$$<br>应用牛顿迭代有<br>$$<br>f(x)\equiv f_0(x)-\frac{f_0^2(x)-h(x)}{2f_0(x)}\pmod{x^n}<br>\<br>\equiv\frac{f_0^2(x)+h(x)}{2f_0(x)}\pmod{x^n}<br>$$</p>
<h4 id="多项式exp-5"><a href="#多项式exp-5" class="headerlink" title="多项式exp"></a>多项式exp</h4><p>给定多项式$h(x)$ 有方程<br>$$<br>g(f(x))&#x3D;\ln f(x)-h(x)\pmod {x^n}<br>$$<br>应用牛顿迭代有.<br>$$<br>f(x)\equiv f_0(x)-\frac{\ln f_0(x)-h(x)}{\frac1{f_0(x)}}<br>\<br>f_0(x)(1-ln f_0(x)+h(x))\pmod{x^n}<br>$$</p>
<h1 id="可能是多项式模板全家桶-6"><a href="#可能是多项式模板全家桶-6" class="headerlink" title="可能是多项式模板全家桶"></a>可能是多项式模板全家桶</h1><h1 id="不到-万字长文-6"><a href="#不到-万字长文-6" class="headerlink" title="(不到)万字长文"></a>(不到)万字长文</h1><h1 id="或许是较好理解的板子讲解-6"><a href="#或许是较好理解的板子讲解-6" class="headerlink" title="或许是较好理解的板子讲解"></a>或许是较好理解的板子讲解</h1><p>本文无代码 否则您将学习每天一个常数爆炸小技巧</p>
<p>qwq</p>
<p>阅读本文约需9分钟:</p>
<p><img src="https://i.loli.net/2021/07/10/5n41cEs3UOlhH69.png" alt="image-20210710093833431"></p>
<h2 id="前置知识-6"><a href="#前置知识-6" class="headerlink" title="前置知识:"></a>前置知识:</h2><h3 id="复数-6"><a href="#复数-6" class="headerlink" title="复数"></a>复数</h3><h4 id="虚数单位-6"><a href="#虚数单位-6" class="headerlink" title="虚数单位"></a>虚数单位</h4><p>虚数单位$i&#x3D;\sqrt{(-1)}$</p>
<h4 id="定义-12"><a href="#定义-12" class="headerlink" title="定义"></a>定义</h4><p>复数是形如$a+bi$的数</p>
<h4 id="运算-6"><a href="#运算-6" class="headerlink" title="运算"></a>运算</h4><h5 id="加法-6"><a href="#加法-6" class="headerlink" title="加法"></a>加法</h5><p>复数 $x&#x3D;(a+bi),y&#x3D;(c+di)$的和定义为 $x+y&#x3D;(a+bi)+(c+di)&#x3D;a+c+(d+b)i$</p>
<h5 id="乘法-6"><a href="#乘法-6" class="headerlink" title="乘法"></a>乘法</h5><p>复数 $x&#x3D;(a+bi),y&#x3D;(c+di)$的积定义为$xy&#x3D;(a+bi)(c+di)&#x3D;ac-bd+(ad+cb)i$</p>
<p>发现复数可以用座标表示 如$x&#x3D;(a+bi)$可表示为$(a,b)$ 这样也可以表示为向量 我们记模长为$r&#x3D;\sqrt{a^2+b^2}$ 俯角为$\alpha$ 于是向量表示为$(rcos\alpha,rsin\alpha)$ 发现一个性质 两向量的积$(rcos\alpha,rsin\alpha)(Rcos\beta,Rsin\beta)$等于$(rRcos(\alpha+\beta),rRsin(\alpha+\beta))$ 模长相乘俯角相加</p>
<h3 id="单位根-6"><a href="#单位根-6" class="headerlink" title="单位根"></a>单位根</h3><p>单位根是形如这样的方程的所有的根:<br>$$<br>x^n&#x3D;1<br>$$<br>根据算数基本定理 这样的根在复数域上有n个</p>
<p>我们记第一个为$w_n$ 它应当是某个复数 我们知道 复数乘法满足模长相差俯角相加 那么它在复数域上的几何表示就是单位圆$n$等分后从(0,1)开始转的第一份</p>
<p>我么发现 第一个单位根的k次方$(0&lt;&#x3D;k&lt;&#x3D;n-1)$也是一个单位根</p>
<p>单位根具有以下性质 希望读者自行验证:</p>
<p>1 $w_n^k&#x3D;w_{n&#x2F;2}^{k&#x2F;2}$</p>
<p>2 $w_n^{k+n}&#x3D;w_n^k$</p>
<p>3 $w_n^{k+n&#x2F;2}&#x3D;-w_n^k$</p>
<p>4 $w_n^0&#x3D;w_n^n&#x3D;1$</p>
<h3 id="原根-6"><a href="#原根-6" class="headerlink" title="原根"></a>原根</h3><h4 id="阶-6"><a href="#阶-6" class="headerlink" title="阶"></a>阶</h4><p>对于一个数 a 一个模数 p 存在最小的 y使得<br>$$<br>a^y\equiv1\pmod p<br>$$</p>
<h4 id="定义-13"><a href="#定义-13" class="headerlink" title="定义"></a>定义</h4><p>若对于一个模数p 存在一个a使得a对p的阶等于phi(p) 那么a就叫做p的原根</p>
<h4 id="性质-6"><a href="#性质-6" class="headerlink" title="性质"></a>性质</h4><p>$a^0,a^1,a^2,⋯,a^{\varphi(p)}$ 模 p 两两不同余，且 $a^k\equiv a^{k+\varphi(p)}\pmod p$</p>
<h3 id="泰勒展开-6"><a href="#泰勒展开-6" class="headerlink" title="泰勒展开"></a>泰勒展开</h3><p>回忆微分法</p>
<p>熟知对于一点$x_0$ 我们试图寻找其邻域的某点$x$及其函数值$f(x)$ 我们应该构造关于$(x-x_0)$的一次多项式 $p(x)&#x3D;f(x_0)+f’(x_0)(x-x_0)$  使得$p’(x-x_0)&#x3D;f’(x_0)$</p>
<p>发现该微分法存在以下突出问题:</p>
<ul>
<li>精度损失不确定</li>
<li>精度损失较大</li>
</ul>
<p>于是我们期望能够得到一个多项式$p(x)$ 使得<br>$$<br>p(x)&#x3D;\sum_{i&#x3D;0}^{n}a_i(x-x_0)^i<br>$$<br>并且$p^{(i)}(x-x_0)&#x3D;f^{(n)}(x_0)$</p>
<p>于是设x&#x3D;0连续求导后 $a_i&#x3D;\frac{f^{(i)}(x)}{i!}$</p>
<h3 id="牛顿迭代-6"><a href="#牛顿迭代-6" class="headerlink" title="牛顿迭代"></a>牛顿迭代</h3><p>发现我们在对精度要求不高时可以使用导数(直线)近似代替原函数来近似求解函数根</p>
<p>若对精度要求更高重复使用即可 </p>
<p>这样我们引出迭代公式<br>$$<br>在(x_0,f(x_0))处的切线方程为y-f(x_0)&#x3D;f’(x_0)(x-x_0)<br>\<br>于是x&#x3D;x_0-\frac{f(x_0)}{f’(x_0)}<br>$$</p>
<h2 id="FFT-6"><a href="#FFT-6" class="headerlink" title="FFT"></a>FFT</h2><p>fft是解决多项式乘法(加法卷积)的一种方法</p>
<p>我们发现加法卷积复杂度极高 这是不能被我们承受的</p>
<p>考虑讲要卷的两个多项式求出点值表示 然后把点值相乘 然后插值回答案多项式</p>
<h3 id="DFT-6"><a href="#DFT-6" class="headerlink" title="DFT"></a>DFT</h3><p>dft是进行多项式多点求值的算法 我们发现多项式<br>$$<br>f(x)&#x3D;a_0+a_1x^1+a_2x^2+a_3x^3+a_4x^4+a_5x^5…<br>\<br>可以拆分为<br>\<br>fl(x)&#x3D;a_0+a_2x^1+a_4x^2+a_6x^3…<br>\和\<br>fr(x)&#x3D;a_1+a_3x^1+a_5x^2+a7x^3…<br>\于是\<br>f(x)&#x3D;fl(x^2)+xfr(x^2)<br>\我们试着将单位根带入\<br>f(w_n^k)&#x3D;fl(w_n^{2k})+w_n^kfr(w_n^{2k})&#x3D;fl(w_{n&#x2F;2}^{k})+w_n^kfr(w_{n&#x2F;2}^{k})<br>\并且有\<br>f(w_n^{k+n&#x2F;2})&#x3D;fl(w_n^{2k+n})+w_n^{k+n&#x2F;2}fr(w_n^{2k+n})&#x3D;fl(w_{n&#x2F;2}^{k})-w_n^kfr(w_{n&#x2F;2}^{k})<br>$$<br>我们可以分治求解 复杂度$O(nlogn)$</p>
<h3 id="IDFT-6"><a href="#IDFT-6" class="headerlink" title="IDFT"></a>IDFT</h3><p>idft是进行多项式多点插值的算法</p>
<p>$(y_0,y_1,y_2…y_{n-1})$为$(a_0,a_1,a_2,…a_{n-1})$的点值表示</p>
<p>那么设另一组数列${c_k}$满足$c_k&#x3D;\sum_{i&#x3D;0}^{n-1}y_i(w_n^{-k})^i$</p>
<p>那么<br>$$<br>c_k&#x3D;\sum_{i&#x3D;0}^{n-1}y_i(w_n^{-k})^i<br>\<br>&#x3D;\sum^{n-1}<em>{i&#x3D;0}(\sum^{n-1}</em>{j&#x3D;0}a_j(w^i_n)^j)(w_n^{-k})^i<br>\<br>&#x3D;\sum^{n-1}<em>{i&#x3D;0}(\sum^{n-1}</em>{j&#x3D;0}a_j(w^j_n)^i)(w_n^{-k})^i<br>\<br>&#x3D;\sum^{n-1}<em>{i&#x3D;0}\sum^{n-1}</em>{j&#x3D;0}a_j(w^{j-k}<em>n)^i<br>\<br>&#x3D;\sum^{n-1}</em>{j&#x3D;0}a_j(\sum^{n-1}_{i&#x3D;0}(w^{j-k}_n)^i)<br>$$</p>
<p>那么 我们发现 对于后半个合式 若$j&#x3D;k$ 取值为$n$</p>
<p>若不等呢:</p>
<p>设$j-k&#x3D;s$</p>
<p>利用等比数列求和公式 </p>
<p>后半个合式等于$\frac{(w_n^s)^n-1}{w_n^s}$</p>
<p>上半部等于0</p>
<p>于是$c_k&#x3D;na_k$</p>
<p>把n除过去即可</p>
<h2 id="NTT-6"><a href="#NTT-6" class="headerlink" title="NTT"></a>NTT</h2><p>发现整个fft的过程中都是在做实数运算 精度误差存在且不小 并且复数运算很慢 甚至某些时候需要蝴蝶优化减少递归带来的巨大常数 我们的推导用到了单位根的如下性质:</p>
<p>1 $w_n^k&#x3D;w_{n&#x2F;2}^{k&#x2F;2}$</p>
<p>2 $w_n^{k+n}&#x3D;w_n^k$</p>
<p>3 $w_n^{k+n&#x2F;2}&#x3D;-w_n^k$</p>
<p>4 $w_n^0&#x3D;w_n^n&#x3D;1$</p>
<p>5 n次方内互不相等</p>
<p>惊喜的发现这些性质在模意义下的时原根也具有 </p>
<p>于是在代码中将复数全部换为原根即可</p>
<h2 id="FWT-6"><a href="#FWT-6" class="headerlink" title="FWT"></a>FWT</h2><p>fwt是用于解决一类位运算卷积的算法</p>
<h3 id="基本思想与概览-6"><a href="#基本思想与概览-6" class="headerlink" title="基本思想与概览"></a>基本思想与概览</h3><p>熟知fft是线性的 我们期望fwt也可以得到一个线性函数</p>
<p>我们首先写出位运算卷积的一般形式:<br>$$<br>S[k]&#x3D;\sum_{i\oplus j&#x3D;k}A[i]B[j]<br>$$<br>记作<br>$$<br>S&#x3D;A*B<br>$$<br>其中$\oplus$是某种位运算</p>
<p>设FWT变换系数为$c(i,j)$ 我们设FWT(A)是A经过FWT变换后的数列</p>
<p>需满足:<br>$$<br>A*B&#x3D;C \iff FWT(A)\cdot FWT(B)&#x3D;FWT(B)<br>$$<br>于是<br>$$<br>FWT(A)[i]&#x3D;\sum^{n-1}<em>{j&#x3D;0}c(i,j)A_j<br>$$<br>依<br>$$<br>FWT(A)\cdot FWT(B)&#x3D;FWT(B)<br>$$<br>得<br>$$<br>FWT(A)[i]FWT(B)[i]&#x3D;FWT(c)[I]<br>\<br>\sum^{n-1}</em>{j&#x3D;0}c(i,j)A[j]\sum^{n-1}<em>{k&#x3D;0}c(i,k)B[k]&#x3D;\sum^{n-1}</em>{p&#x3D;0}c(i,p)C[p]<br>\<br>\sum^{n-1}<em>{j&#x3D;0}\sum^{n-1}</em>{k&#x3D;0}c(i,j)c(i,k)A[j]B[k]&#x3D;\sum^{n-1}<em>{p&#x3D;0}c(i,p)C[p]<br>$$<br>依<br>$$<br>C[p]&#x3D;\sum</em>{t_1\oplus t_2&#x3D;p}A[t_1]B[t_2]<br>$$<br>又得<br>$$<br>\sum^{n-1}<em>{p&#x3D;0}c(i,p)C[p]&#x3D;\sum^{n-1}</em>{p&#x3D;0}c(i,p)\sum_{t_1\oplus t_2&#x3D;p}A[t_1]B[t_2]<br>\<br>\sum^{n-1}<em>{j&#x3D;0}\sum^{n-1}</em>{k&#x3D;0}c(i,j)c(i,k)A[j]B[k]&#x3D;\sum^{n-1}<em>{p&#x3D;0}c(i,p)\sum</em>{t_1\oplus t_2&#x3D;p}A[t_1]B[t_2]<br>\<br>\sum^{n-1}<em>{j&#x3D;0}\sum^{n-1}</em>{k&#x3D;0}c(i,j)c(i,k)A[j]B[k]&#x3D;\sum^{n-1}<em>{t_1&#x3D;0}\sum</em>{t_2&#x3D;0}^{n-1}A[t_1]B[t_2]c(i,t_1\oplus t_2)<br>$$<br>对比发现只需使$c(i,j)c(i,k)&#x3D;c(i,j\oplus k)$</p>
<p>另外 由位运算只考虑独立位的特殊性 我们有:</p>
<p>对于一个二进制数a 它的每一位表示为$a_0,a_1,a_2,a_3,a_4,….$</p>
<p>设我们已经知道所有满足要求的c([0,1],[0,1])</p>
<p>那么<br>$$<br>c(i,j)&#x3D;c(i_0,j_0)c(i_1,j_1)c(i_2,j_2),…<br>$$<br>于是<br>$$<br>\prod_p c(i_p,j_p)c(i_p,k_p)&#x3D;\prod_p c(i_p,j_p\oplus k_p)<br>\<br>c(i,j)c(i,k)&#x3D;c(i,j\oplus k)<br>$$<br>由此 只要我们构造出单位的c函数 我们就可以构造出所有数的c函数</p>
<p>我们如何快速求位运算卷积呢</p>
<p>依然考虑分治</p>
<p>首先折半<br>$$<br>FWT(A)[i]&#x3D;\sum_{j&#x3D;0}^{(n&#x2F;2)-1}c(i,j)A[j]+\sum_{j&#x3D;(n&#x2F;2)}^{n-1}c(i,j)A[j]<br>$$<br>对于i,j的首位 我们分开考虑 设i’为i去掉二进制首位的数</p>
<p>于是<br>$$<br>&#x3D;\sum_{j&#x3D;0}^{(n&#x2F;2)-1}c(i_0,j_0)c(i’,j’)A[j]+\sum_{j&#x3D;(n&#x2F;2)}^{n-1}c(i_0,j_0)c(i’,j’)A[j]<br>\<br>&#x3D;c(i_0,0)\sum_{j&#x3D;0}^{(n&#x2F;2)-1}c(i’,j’)A[j]+c(i_0,1)\sum_{j&#x3D;(n&#x2F;2)}^{n-1}c(i_0,j_0)c(i’,j’)A[j]<br>$$<br>加号两边柿子分别递归处理 我们成功缩小了问题的规模</p>
<h3 id="一些例子-6"><a href="#一些例子-6" class="headerlink" title="一些例子"></a>一些例子</h3><p>针对不同位运算 我们需要构造出不同的c([0,1],[0,1]) 再结合上面的推导 问题就得到了解决</p>
<h4 id="Or卷积-6"><a href="#Or卷积-6" class="headerlink" title="Or卷积"></a>Or卷积</h4><p>c([0&#x2F;1],[0&#x2F;1])的矩阵<br>$$<br>\begin{bmatrix}<br>c(0,0)&amp;c(0,1)\<br>c(1,0)&amp;c(1,1)<br>\end{bmatrix}<br>$$</p>
<p>应满足条件 $c(i,j)c(i,k)&#x3D;c(i,j|k)$ </p>
<ul>
<li>$c(0,0)&#x3D;c(0,0|0)\Rightarrow c(0,0)&#x3D;1或0$</li>
<li>$c(0,1)c(0,0)&#x3D; c(0,1|0)\Rightarrow c(0,1)&#x3D;0或c(0,0)&#x3D;c(0,1)&#x3D;1$</li>
<li>$c(1,1)c(1,0)&#x3D;c(1,1|0)\Rightarrow c(1,1)&#x3D;0或c(1,0)&#x3D;c(1,1)&#x3D;1$</li>
</ul>
<p>并且这个矩阵应当是有逆的 否则就无法回去 我们最终选取</p>
<p>$c(0,0)&#x3D;1,c(0,1)&#x3D;0,c(1,0)&#x3D;1,c(1,1)&#x3D;1$</p>
<p>逆变换其实只需矩阵求逆即可 </p>
<p>或者考虑算式的反算式即可</p>
<p>那么同理对于</p>
<h4 id="And卷积-6"><a href="#And卷积-6" class="headerlink" title="And卷积"></a>And卷积</h4><p>有矩阵<br>$$<br>\begin{bmatrix}<br>1&amp;1\<br>0&amp;1<br>\end{bmatrix}<br>$$</p>
<p>和</p>
<h4 id="Xor卷积-6"><a href="#Xor卷积-6" class="headerlink" title="Xor卷积"></a>Xor卷积</h4><p>有矩阵<br>$$<br>\begin{bmatrix}<br>1&amp;1\<br>1&amp;-1<br>\end{bmatrix}<br>$$<br>既得易见平凡 仿照上例显然 留作习题答案略 读者自证不难</p>
<p>反之亦然同理 推论自然成立 略去过程Q E D  由上可知证毕 </p>
<p>​	西江月&#x2F;证明</p>
<h2 id="多项式乘法逆-6"><a href="#多项式乘法逆-6" class="headerlink" title="多项式乘法逆"></a>多项式乘法逆</h2><p>多项式求逆即对于多项式$f(x)$</p>
<p>我们求一个$g(x)$</p>
<p>使得<br>$$<br>g(x)*f(x)\equiv1 \pmod {x^n}<br>$$</p>
<h3 id="倍增法-12"><a href="#倍增法-12" class="headerlink" title="倍增法"></a>倍增法</h3><h4 id="边界-6"><a href="#边界-6" class="headerlink" title="边界"></a>边界</h4><p>当界为$\pmod{x^1}$ 即多项式只有常数项时 直接数字逆元即可</p>
<h4 id="转移-6"><a href="#转移-6" class="headerlink" title="转移"></a>转移</h4><p>假设我们得到了$T(x)\equiv F(x)^{-1} \pmod {x^{n&#x2F;2}}$</p>
<p>显然有$G(x)\equiv T(x)\pmod{x^{n&#x2F;2}}$</p>
<p>那么 $(G(x)-T(x))^2\equiv0\pmod{x^n}$</p>
<p>$G(x)^2-2G(x)T(x)+T(x)^2\equiv0\pmod{x^n}$</p>
<p>同乘$F(x)$</p>
<p>$R(x)-2G(x)-G(x)^2F(x)\equiv0\pmod{x^n}$</p>
<p>运用多项式乘法倍增即可</p>
<h2 id="多项式开根-6"><a href="#多项式开根-6" class="headerlink" title="多项式开根"></a>多项式开根</h2><p>给定$g(x)$ 求$f(x)$满足<br>$$<br>f^2(x)\equiv g(x)\pmod{x^n}<br>$$</p>
<h3 id="倍增法-13"><a href="#倍增法-13" class="headerlink" title="倍增法"></a>倍增法</h3><p>假设已求出$g(x)$在模$x^{[n&#x2F;2]}$意义下的平方根$f_0(x)$ 则有<br>$$<br>f_0^2(x)\equiv g(x) \pmod{x^{[n&#x2F;2]}}<br>\<br>f_0^2(x)-g(x)\equiv 0\pmod{x^{[n&#x2F;2]}}<br>\<br>(f_0^2(x)-g(x))^2\equiv 0\pmod{x^{n}}<br>\<br>(f_0^2(x)+g(x))^2\equiv 4f_0^2(x)g(x)\pmod{x^{n}}<br>\<br>(\frac{f_0^2(x)+g(x)}{2f_0(x)})\equiv g(x)\pmod{x^{n}}<br>\<br>\frac{f_0^2(x)+g(x)}{2f_0(x)}\equiv f(x) \pmod{x^n}<br>\<br>\frac 1 2f_0(x)+2^{-1}f_0^{-1}(x)g(x)\equiv f(x) \pmod{x^n}<br>$$</p>
<h2 id="多项式除法-6"><a href="#多项式除法-6" class="headerlink" title="多项式除法"></a>多项式除法</h2><p>给定多项式$f(x),g(x)$ 求$g(x)$除$f(x)$的商$q(x)$和余数$r(x)$</p>
<p>若能消去$r(x)$的影响则可直接多项式乘法逆</p>
<p>考虑构造<br>$$<br>f_r(x)&#x3D;x^nf(\frac 1 x)<br>$$<br>容易发现其为反转$f(x)$系数</p>
<p>设$n&#x3D;\deg f,m&#x3D;\deg g$</p>
<p>则<br>$$<br>f(x)&#x3D;q(x)g(x)+r(x)\Rightarrow<br>\<br>x^nf(\frac 1 x)&#x3D;x^{n-m}q(\frac 1 x)x^mg(\frac 1 x)+x^{n-m+1}x^{m-1}r(\frac 1 x)<br>\<br>f_r(x)&#x3D;q_r(x)g_r(x)+x^{n-m+1}r_r(x)<br>\<br>于是<br>\<br>f_r(x)\equiv q_r(x)g_r(x)\pmod{x^{n-m+1}}<br>$$<br>多项式求逆$g_r(x)$即可 然后求出$q_r(x)$和$r_r(x)$</p>
<h2 id="多项式ln-6"><a href="#多项式ln-6" class="headerlink" title="多项式ln"></a>多项式ln</h2><p>给定多项式$f(x)$ 求模$x^n$意义下$lnf(x)$</p>
<p>解法本质就是暴力</p>
<p>对多项式先求导再积分即可<br>$$<br>\frac {\text{d}\ln f(x)}{dx}\equiv \frac {1}{f(x)} f’(x)\pmod{x^n}<br>$$</p>
<h2 id="多项式牛顿迭代-6"><a href="#多项式牛顿迭代-6" class="headerlink" title="多项式牛顿迭代"></a>多项式牛顿迭代</h2><p>对于给定$g(x)$ 求$f(x)$ 使得其满足$g(f(x))\equiv 0 \pmod{ x^n}$</p>
<p>假设已经得到了模$x^{[n&#x2F;2]}$次方的解$f_0(x)$ 要求模$x^n$的解$f(x)$</p>
<p>跟据定义我们知道 $f(x)$与$f_0(x)$在前$[n&#x2F;2]-1$位上相等 </p>
<p>那么我们写出$g(f(x))$在$f_0(x)$处的泰勒展开 </p>
<p><img src="https://i.loli.net/2021/07/10/AreopyjgdDlhbU6.png" alt="image-20210710085546653"></p>
<p>发现从第三项往后全部被模掉了 没有意义 我们即可直接用牛顿迭代式计算</p>
<p><img src="https://i.loli.net/2021/07/10/jq9MTVmktfgHaus.png" alt="image-20210710085712805"></p>
<h3 id="应用-6"><a href="#应用-6" class="headerlink" title="应用"></a>应用</h3><h4 id="多项式求逆-6"><a href="#多项式求逆-6" class="headerlink" title="多项式求逆"></a>多项式求逆</h4><p>给定多项式$h(x)$ 有方程<br>$$<br>g(f(x))&#x3D;\frac1 {f(x)}-h(x)\equiv0\pmod0<br>$$<br>应用牛顿迭代有<br>$$<br>\begin{aligned}<br>    f\left(x\right)&amp;\equiv f_{0}\left(x\right)-\frac{\frac{1}{f_{0}\left(x\right)}-h\left(x\right)}{-\frac{1}{f_{0}^{2}\left(x\right)}}&amp;\pmod{x^{n}}\<br>    &amp;\equiv 2f_{0}\left(x\right)-f_{0}^{2}\left(x\right)h\left(x\right)&amp;\pmod{x^{n}}<br>\end{aligned}<br>$$</p>
<h4 id="多项式开方-6"><a href="#多项式开方-6" class="headerlink" title="多项式开方"></a>多项式开方</h4><p>给定多项式$h(x)$ 有方程<br>$$<br>g(f(x))&#x3D;f^2(x)-h(x)\equiv0\pmod{x^n}<br>$$<br>应用牛顿迭代有<br>$$<br>f(x)\equiv f_0(x)-\frac{f_0^2(x)-h(x)}{2f_0(x)}\pmod{x^n}<br>\<br>\equiv\frac{f_0^2(x)+h(x)}{2f_0(x)}\pmod{x^n}<br>$$</p>
<h4 id="多项式exp-6"><a href="#多项式exp-6" class="headerlink" title="多项式exp"></a>多项式exp</h4><p>给定多项式$h(x)$ 有方程<br>$$<br>g(f(x))&#x3D;\ln f(x)-h(x)\pmod {x^n}<br>$$<br>应用牛顿迭代有.<br>$$<br>f(x)\equiv f_0(x)-\frac{\ln f_0(x)-h(x)}{\frac1{f_0(x)}}<br>\<br>f_0(x)(1-ln f_0(x)+h(x))\pmod{x^n}<br>$$</p>
<h1 id="可能是多项式模板全家桶-7"><a href="#可能是多项式模板全家桶-7" class="headerlink" title="可能是多项式模板全家桶"></a>可能是多项式模板全家桶</h1><h1 id="不到-万字长文-7"><a href="#不到-万字长文-7" class="headerlink" title="(不到)万字长文"></a>(不到)万字长文</h1><h1 id="或许是较好理解的板子讲解-7"><a href="#或许是较好理解的板子讲解-7" class="headerlink" title="或许是较好理解的板子讲解"></a>或许是较好理解的板子讲解</h1><p>本文无代码 否则您将学习每天一个常数爆炸小技巧</p>
<p>qwq</p>
<p>阅读本文约需9分钟:</p>
<p><img src="https://i.loli.net/2021/07/10/5n41cEs3UOlhH69.png" alt="image-20210710093833431"></p>
<h2 id="前置知识-7"><a href="#前置知识-7" class="headerlink" title="前置知识:"></a>前置知识:</h2><h3 id="复数-7"><a href="#复数-7" class="headerlink" title="复数"></a>复数</h3><h4 id="虚数单位-7"><a href="#虚数单位-7" class="headerlink" title="虚数单位"></a>虚数单位</h4><p>虚数单位$i&#x3D;\sqrt{(-1)}$</p>
<h4 id="定义-14"><a href="#定义-14" class="headerlink" title="定义"></a>定义</h4><p>复数是形如$a+bi$的数</p>
<h4 id="运算-7"><a href="#运算-7" class="headerlink" title="运算"></a>运算</h4><h5 id="加法-7"><a href="#加法-7" class="headerlink" title="加法"></a>加法</h5><p>复数 $x&#x3D;(a+bi),y&#x3D;(c+di)$的和定义为 $x+y&#x3D;(a+bi)+(c+di)&#x3D;a+c+(d+b)i$</p>
<h5 id="乘法-7"><a href="#乘法-7" class="headerlink" title="乘法"></a>乘法</h5><p>复数 $x&#x3D;(a+bi),y&#x3D;(c+di)$的积定义为$xy&#x3D;(a+bi)(c+di)&#x3D;ac-bd+(ad+cb)i$</p>
<p>发现复数可以用座标表示 如$x&#x3D;(a+bi)$可表示为$(a,b)$ 这样也可以表示为向量 我们记模长为$r&#x3D;\sqrt{a^2+b^2}$ 俯角为$\alpha$ 于是向量表示为$(rcos\alpha,rsin\alpha)$ 发现一个性质 两向量的积$(rcos\alpha,rsin\alpha)(Rcos\beta,Rsin\beta)$等于$(rRcos(\alpha+\beta),rRsin(\alpha+\beta))$ 模长相乘俯角相加</p>
<h3 id="单位根-7"><a href="#单位根-7" class="headerlink" title="单位根"></a>单位根</h3><p>单位根是形如这样的方程的所有的根:<br>$$<br>x^n&#x3D;1<br>$$<br>根据算数基本定理 这样的根在复数域上有n个</p>
<p>我们记第一个为$w_n$ 它应当是某个复数 我们知道 复数乘法满足模长相差俯角相加 那么它在复数域上的几何表示就是单位圆$n$等分后从(0,1)开始转的第一份</p>
<p>我么发现 第一个单位根的k次方$(0&lt;&#x3D;k&lt;&#x3D;n-1)$也是一个单位根</p>
<p>单位根具有以下性质 希望读者自行验证:</p>
<p>1 $w_n^k&#x3D;w_{n&#x2F;2}^{k&#x2F;2}$</p>
<p>2 $w_n^{k+n}&#x3D;w_n^k$</p>
<p>3 $w_n^{k+n&#x2F;2}&#x3D;-w_n^k$</p>
<p>4 $w_n^0&#x3D;w_n^n&#x3D;1$</p>
<h3 id="原根-7"><a href="#原根-7" class="headerlink" title="原根"></a>原根</h3><h4 id="阶-7"><a href="#阶-7" class="headerlink" title="阶"></a>阶</h4><p>对于一个数 a 一个模数 p 存在最小的 y使得<br>$$<br>a^y\equiv1\pmod p<br>$$</p>
<h4 id="定义-15"><a href="#定义-15" class="headerlink" title="定义"></a>定义</h4><p>若对于一个模数p 存在一个a使得a对p的阶等于phi(p) 那么a就叫做p的原根</p>
<h4 id="性质-7"><a href="#性质-7" class="headerlink" title="性质"></a>性质</h4><p>$a^0,a^1,a^2,⋯,a^{\varphi(p)}$ 模 p 两两不同余，且 $a^k\equiv a^{k+\varphi(p)}\pmod p$</p>
<h3 id="泰勒展开-7"><a href="#泰勒展开-7" class="headerlink" title="泰勒展开"></a>泰勒展开</h3><p>回忆微分法</p>
<p>熟知对于一点$x_0$ 我们试图寻找其邻域的某点$x$及其函数值$f(x)$ 我们应该构造关于$(x-x_0)$的一次多项式 $p(x)&#x3D;f(x_0)+f’(x_0)(x-x_0)$  使得$p’(x-x_0)&#x3D;f’(x_0)$</p>
<p>发现该微分法存在以下突出问题:</p>
<ul>
<li>精度损失不确定</li>
<li>精度损失较大</li>
</ul>
<p>于是我们期望能够得到一个多项式$p(x)$ 使得<br>$$<br>p(x)&#x3D;\sum_{i&#x3D;0}^{n}a_i(x-x_0)^i<br>$$<br>并且$p^{(i)}(x-x_0)&#x3D;f^{(n)}(x_0)$</p>
<p>于是设x&#x3D;0连续求导后 $a_i&#x3D;\frac{f^{(i)}(x)}{i!}$</p>
<h3 id="牛顿迭代-7"><a href="#牛顿迭代-7" class="headerlink" title="牛顿迭代"></a>牛顿迭代</h3><p>发现我们在对精度要求不高时可以使用导数(直线)近似代替原函数来近似求解函数根</p>
<p>若对精度要求更高重复使用即可 </p>
<p>这样我们引出迭代公式<br>$$<br>在(x_0,f(x_0))处的切线方程为y-f(x_0)&#x3D;f’(x_0)(x-x_0)<br>\<br>于是x&#x3D;x_0-\frac{f(x_0)}{f’(x_0)}<br>$$</p>
<h2 id="FFT-7"><a href="#FFT-7" class="headerlink" title="FFT"></a>FFT</h2><p>fft是解决多项式乘法(加法卷积)的一种方法</p>
<p>我们发现加法卷积复杂度极高 这是不能被我们承受的</p>
<p>考虑讲要卷的两个多项式求出点值表示 然后把点值相乘 然后插值回答案多项式</p>
<h3 id="DFT-7"><a href="#DFT-7" class="headerlink" title="DFT"></a>DFT</h3><p>dft是进行多项式多点求值的算法 我们发现多项式<br>$$<br>f(x)&#x3D;a_0+a_1x^1+a_2x^2+a_3x^3+a_4x^4+a_5x^5…<br>\<br>可以拆分为<br>\<br>fl(x)&#x3D;a_0+a_2x^1+a_4x^2+a_6x^3…<br>\和\<br>fr(x)&#x3D;a_1+a_3x^1+a_5x^2+a7x^3…<br>\于是\<br>f(x)&#x3D;fl(x^2)+xfr(x^2)<br>\我们试着将单位根带入\<br>f(w_n^k)&#x3D;fl(w_n^{2k})+w_n^kfr(w_n^{2k})&#x3D;fl(w_{n&#x2F;2}^{k})+w_n^kfr(w_{n&#x2F;2}^{k})<br>\并且有\<br>f(w_n^{k+n&#x2F;2})&#x3D;fl(w_n^{2k+n})+w_n^{k+n&#x2F;2}fr(w_n^{2k+n})&#x3D;fl(w_{n&#x2F;2}^{k})-w_n^kfr(w_{n&#x2F;2}^{k})<br>$$<br>我们可以分治求解 复杂度$O(nlogn)$</p>
<h3 id="IDFT-7"><a href="#IDFT-7" class="headerlink" title="IDFT"></a>IDFT</h3><p>idft是进行多项式多点插值的算法</p>
<p>$(y_0,y_1,y_2…y_{n-1})$为$(a_0,a_1,a_2,…a_{n-1})$的点值表示</p>
<p>那么设另一组数列${c_k}$满足$c_k&#x3D;\sum_{i&#x3D;0}^{n-1}y_i(w_n^{-k})^i$</p>
<p>那么<br>$$<br>c_k&#x3D;\sum_{i&#x3D;0}^{n-1}y_i(w_n^{-k})^i<br>\<br>&#x3D;\sum^{n-1}<em>{i&#x3D;0}(\sum^{n-1}</em>{j&#x3D;0}a_j(w^i_n)^j)(w_n^{-k})^i<br>\<br>&#x3D;\sum^{n-1}<em>{i&#x3D;0}(\sum^{n-1}</em>{j&#x3D;0}a_j(w^j_n)^i)(w_n^{-k})^i<br>\<br>&#x3D;\sum^{n-1}<em>{i&#x3D;0}\sum^{n-1}</em>{j&#x3D;0}a_j(w^{j-k}<em>n)^i<br>\<br>&#x3D;\sum^{n-1}</em>{j&#x3D;0}a_j(\sum^{n-1}_{i&#x3D;0}(w^{j-k}_n)^i)<br>$$</p>
<p>那么 我们发现 对于后半个合式 若$j&#x3D;k$ 取值为$n$</p>
<p>若不等呢:</p>
<p>设$j-k&#x3D;s$</p>
<p>利用等比数列求和公式 </p>
<p>后半个合式等于$\frac{(w_n^s)^n-1}{w_n^s}$</p>
<p>上半部等于0</p>
<p>于是$c_k&#x3D;na_k$</p>
<p>把n除过去即可</p>
<h2 id="NTT-7"><a href="#NTT-7" class="headerlink" title="NTT"></a>NTT</h2><p>发现整个fft的过程中都是在做实数运算 精度误差存在且不小 并且复数运算很慢 甚至某些时候需要蝴蝶优化减少递归带来的巨大常数 我们的推导用到了单位根的如下性质:</p>
<p>1 $w_n^k&#x3D;w_{n&#x2F;2}^{k&#x2F;2}$</p>
<p>2 $w_n^{k+n}&#x3D;w_n^k$</p>
<p>3 $w_n^{k+n&#x2F;2}&#x3D;-w_n^k$</p>
<p>4 $w_n^0&#x3D;w_n^n&#x3D;1$</p>
<p>5 n次方内互不相等</p>
<p>惊喜的发现这些性质在模意义下的时原根也具有 </p>
<p>于是在代码中将复数全部换为原根即可</p>
<h2 id="FWT-7"><a href="#FWT-7" class="headerlink" title="FWT"></a>FWT</h2><p>fwt是用于解决一类位运算卷积的算法</p>
<h3 id="基本思想与概览-7"><a href="#基本思想与概览-7" class="headerlink" title="基本思想与概览"></a>基本思想与概览</h3><p>熟知fft是线性的 我们期望fwt也可以得到一个线性函数</p>
<p>我们首先写出位运算卷积的一般形式:<br>$$<br>S[k]&#x3D;\sum_{i\oplus j&#x3D;k}A[i]B[j]<br>$$<br>记作<br>$$<br>S&#x3D;A*B<br>$$<br>其中$\oplus$是某种位运算</p>
<p>设FWT变换系数为$c(i,j)$ 我们设FWT(A)是A经过FWT变换后的数列</p>
<p>需满足:<br>$$<br>A*B&#x3D;C \iff FWT(A)\cdot FWT(B)&#x3D;FWT(B)<br>$$<br>于是<br>$$<br>FWT(A)[i]&#x3D;\sum^{n-1}<em>{j&#x3D;0}c(i,j)A_j<br>$$<br>依<br>$$<br>FWT(A)\cdot FWT(B)&#x3D;FWT(B)<br>$$<br>得<br>$$<br>FWT(A)[i]FWT(B)[i]&#x3D;FWT(c)[I]<br>\<br>\sum^{n-1}</em>{j&#x3D;0}c(i,j)A[j]\sum^{n-1}<em>{k&#x3D;0}c(i,k)B[k]&#x3D;\sum^{n-1}</em>{p&#x3D;0}c(i,p)C[p]<br>\<br>\sum^{n-1}<em>{j&#x3D;0}\sum^{n-1}</em>{k&#x3D;0}c(i,j)c(i,k)A[j]B[k]&#x3D;\sum^{n-1}<em>{p&#x3D;0}c(i,p)C[p]<br>$$<br>依<br>$$<br>C[p]&#x3D;\sum</em>{t_1\oplus t_2&#x3D;p}A[t_1]B[t_2]<br>$$<br>又得<br>$$<br>\sum^{n-1}<em>{p&#x3D;0}c(i,p)C[p]&#x3D;\sum^{n-1}</em>{p&#x3D;0}c(i,p)\sum_{t_1\oplus t_2&#x3D;p}A[t_1]B[t_2]<br>\<br>\sum^{n-1}<em>{j&#x3D;0}\sum^{n-1}</em>{k&#x3D;0}c(i,j)c(i,k)A[j]B[k]&#x3D;\sum^{n-1}<em>{p&#x3D;0}c(i,p)\sum</em>{t_1\oplus t_2&#x3D;p}A[t_1]B[t_2]<br>\<br>\sum^{n-1}<em>{j&#x3D;0}\sum^{n-1}</em>{k&#x3D;0}c(i,j)c(i,k)A[j]B[k]&#x3D;\sum^{n-1}<em>{t_1&#x3D;0}\sum</em>{t_2&#x3D;0}^{n-1}A[t_1]B[t_2]c(i,t_1\oplus t_2)<br>$$<br>对比发现只需使$c(i,j)c(i,k)&#x3D;c(i,j\oplus k)$</p>
<p>另外 由位运算只考虑独立位的特殊性 我们有:</p>
<p>对于一个二进制数a 它的每一位表示为$a_0,a_1,a_2,a_3,a_4,….$</p>
<p>设我们已经知道所有满足要求的c([0,1],[0,1])</p>
<p>那么<br>$$<br>c(i,j)&#x3D;c(i_0,j_0)c(i_1,j_1)c(i_2,j_2),…<br>$$<br>于是<br>$$<br>\prod_p c(i_p,j_p)c(i_p,k_p)&#x3D;\prod_p c(i_p,j_p\oplus k_p)<br>\<br>c(i,j)c(i,k)&#x3D;c(i,j\oplus k)<br>$$<br>由此 只要我们构造出单位的c函数 我们就可以构造出所有数的c函数</p>
<p>我们如何快速求位运算卷积呢</p>
<p>依然考虑分治</p>
<p>首先折半<br>$$<br>FWT(A)[i]&#x3D;\sum_{j&#x3D;0}^{(n&#x2F;2)-1}c(i,j)A[j]+\sum_{j&#x3D;(n&#x2F;2)}^{n-1}c(i,j)A[j]<br>$$<br>对于i,j的首位 我们分开考虑 设i’为i去掉二进制首位的数</p>
<p>于是<br>$$<br>&#x3D;\sum_{j&#x3D;0}^{(n&#x2F;2)-1}c(i_0,j_0)c(i’,j’)A[j]+\sum_{j&#x3D;(n&#x2F;2)}^{n-1}c(i_0,j_0)c(i’,j’)A[j]<br>\<br>&#x3D;c(i_0,0)\sum_{j&#x3D;0}^{(n&#x2F;2)-1}c(i’,j’)A[j]+c(i_0,1)\sum_{j&#x3D;(n&#x2F;2)}^{n-1}c(i_0,j_0)c(i’,j’)A[j]<br>$$<br>加号两边柿子分别递归处理 我们成功缩小了问题的规模</p>
<h3 id="一些例子-7"><a href="#一些例子-7" class="headerlink" title="一些例子"></a>一些例子</h3><p>针对不同位运算 我们需要构造出不同的c([0,1],[0,1]) 再结合上面的推导 问题就得到了解决</p>
<h4 id="Or卷积-7"><a href="#Or卷积-7" class="headerlink" title="Or卷积"></a>Or卷积</h4><p>c([0&#x2F;1],[0&#x2F;1])的矩阵<br>$$<br>\begin{bmatrix}<br>c(0,0)&amp;c(0,1)\<br>c(1,0)&amp;c(1,1)<br>\end{bmatrix}<br>$$</p>
<p>应满足条件 $c(i,j)c(i,k)&#x3D;c(i,j|k)$ </p>
<ul>
<li>$c(0,0)&#x3D;c(0,0|0)\Rightarrow c(0,0)&#x3D;1或0$</li>
<li>$c(0,1)c(0,0)&#x3D; c(0,1|0)\Rightarrow c(0,1)&#x3D;0或c(0,0)&#x3D;c(0,1)&#x3D;1$</li>
<li>$c(1,1)c(1,0)&#x3D;c(1,1|0)\Rightarrow c(1,1)&#x3D;0或c(1,0)&#x3D;c(1,1)&#x3D;1$</li>
</ul>
<p>并且这个矩阵应当是有逆的 否则就无法回去 我们最终选取</p>
<p>$c(0,0)&#x3D;1,c(0,1)&#x3D;0,c(1,0)&#x3D;1,c(1,1)&#x3D;1$</p>
<p>逆变换其实只需矩阵求逆即可 </p>
<p>或者考虑算式的反算式即可</p>
<p>那么同理对于</p>
<h4 id="And卷积-7"><a href="#And卷积-7" class="headerlink" title="And卷积"></a>And卷积</h4><p>有矩阵<br>$$<br>\begin{bmatrix}<br>1&amp;1\<br>0&amp;1<br>\end{bmatrix}<br>$$</p>
<p>和</p>
<h4 id="Xor卷积-7"><a href="#Xor卷积-7" class="headerlink" title="Xor卷积"></a>Xor卷积</h4><p>有矩阵<br>$$<br>\begin{bmatrix}<br>1&amp;1\<br>1&amp;-1<br>\end{bmatrix}<br>$$<br>既得易见平凡 仿照上例显然 留作习题答案略 读者自证不难</p>
<p>反之亦然同理 推论自然成立 略去过程Q E D  由上可知证毕 </p>
<p>​	西江月&#x2F;证明</p>
<h2 id="多项式乘法逆-7"><a href="#多项式乘法逆-7" class="headerlink" title="多项式乘法逆"></a>多项式乘法逆</h2><p>多项式求逆即对于多项式$f(x)$</p>
<p>我们求一个$g(x)$</p>
<p>使得<br>$$<br>g(x)*f(x)\equiv1 \pmod {x^n}<br>$$</p>
<h3 id="倍增法-14"><a href="#倍增法-14" class="headerlink" title="倍增法"></a>倍增法</h3><h4 id="边界-7"><a href="#边界-7" class="headerlink" title="边界"></a>边界</h4><p>当界为$\pmod{x^1}$ 即多项式只有常数项时 直接数字逆元即可</p>
<h4 id="转移-7"><a href="#转移-7" class="headerlink" title="转移"></a>转移</h4><p>假设我们得到了$T(x)\equiv F(x)^{-1} \pmod {x^{n&#x2F;2}}$</p>
<p>显然有$G(x)\equiv T(x)\pmod{x^{n&#x2F;2}}$</p>
<p>那么 $(G(x)-T(x))^2\equiv0\pmod{x^n}$</p>
<p>$G(x)^2-2G(x)T(x)+T(x)^2\equiv0\pmod{x^n}$</p>
<p>同乘$F(x)$</p>
<p>$R(x)-2G(x)-G(x)^2F(x)\equiv0\pmod{x^n}$</p>
<p>运用多项式乘法倍增即可</p>
<h2 id="多项式开根-7"><a href="#多项式开根-7" class="headerlink" title="多项式开根"></a>多项式开根</h2><p>给定$g(x)$ 求$f(x)$满足<br>$$<br>f^2(x)\equiv g(x)\pmod{x^n}<br>$$</p>
<h3 id="倍增法-15"><a href="#倍增法-15" class="headerlink" title="倍增法"></a>倍增法</h3><p>假设已求出$g(x)$在模$x^{[n&#x2F;2]}$意义下的平方根$f_0(x)$ 则有<br>$$<br>f_0^2(x)\equiv g(x) \pmod{x^{[n&#x2F;2]}}<br>\<br>f_0^2(x)-g(x)\equiv 0\pmod{x^{[n&#x2F;2]}}<br>\<br>(f_0^2(x)-g(x))^2\equiv 0\pmod{x^{n}}<br>\<br>(f_0^2(x)+g(x))^2\equiv 4f_0^2(x)g(x)\pmod{x^{n}}<br>\<br>(\frac{f_0^2(x)+g(x)}{2f_0(x)})\equiv g(x)\pmod{x^{n}}<br>\<br>\frac{f_0^2(x)+g(x)}{2f_0(x)}\equiv f(x) \pmod{x^n}<br>\<br>\frac 1 2f_0(x)+2^{-1}f_0^{-1}(x)g(x)\equiv f(x) \pmod{x^n}<br>$$</p>
<h2 id="多项式除法-7"><a href="#多项式除法-7" class="headerlink" title="多项式除法"></a>多项式除法</h2><p>给定多项式$f(x),g(x)$ 求$g(x)$除$f(x)$的商$q(x)$和余数$r(x)$</p>
<p>若能消去$r(x)$的影响则可直接多项式乘法逆</p>
<p>考虑构造<br>$$<br>f_r(x)&#x3D;x^nf(\frac 1 x)<br>$$<br>容易发现其为反转$f(x)$系数</p>
<p>设$n&#x3D;\deg f,m&#x3D;\deg g$</p>
<p>则<br>$$<br>f(x)&#x3D;q(x)g(x)+r(x)\Rightarrow<br>\<br>x^nf(\frac 1 x)&#x3D;x^{n-m}q(\frac 1 x)x^mg(\frac 1 x)+x^{n-m+1}x^{m-1}r(\frac 1 x)<br>\<br>f_r(x)&#x3D;q_r(x)g_r(x)+x^{n-m+1}r_r(x)<br>\<br>于是<br>\<br>f_r(x)\equiv q_r(x)g_r(x)\pmod{x^{n-m+1}}<br>$$<br>多项式求逆$g_r(x)$即可 然后求出$q_r(x)$和$r_r(x)$</p>
<h2 id="多项式ln-7"><a href="#多项式ln-7" class="headerlink" title="多项式ln"></a>多项式ln</h2><p>给定多项式$f(x)$ 求模$x^n$意义下$lnf(x)$</p>
<p>解法本质就是暴力</p>
<p>对多项式先求导再积分即可<br>$$<br>\frac {\text{d}\ln f(x)}{dx}\equiv \frac {1}{f(x)} f’(x)\pmod{x^n}<br>$$</p>
<h2 id="多项式牛顿迭代-7"><a href="#多项式牛顿迭代-7" class="headerlink" title="多项式牛顿迭代"></a>多项式牛顿迭代</h2><p>对于给定$g(x)$ 求$f(x)$ 使得其满足$g(f(x))\equiv 0 \pmod{ x^n}$</p>
<p>假设已经得到了模$x^{[n&#x2F;2]}$次方的解$f_0(x)$ 要求模$x^n$的解$f(x)$</p>
<p>跟据定义我们知道 $f(x)$与$f_0(x)$在前$[n&#x2F;2]-1$位上相等 </p>
<p>那么我们写出$g(f(x))$在$f_0(x)$处的泰勒展开 </p>
<p><img src="https://i.loli.net/2021/07/10/AreopyjgdDlhbU6.png" alt="image-20210710085546653"></p>
<p>发现从第三项往后全部被模掉了 没有意义 我们即可直接用牛顿迭代式计算</p>
<p><img src="https://i.loli.net/2021/07/10/jq9MTVmktfgHaus.png" alt="image-20210710085712805"></p>
<h3 id="应用-7"><a href="#应用-7" class="headerlink" title="应用"></a>应用</h3><h4 id="多项式求逆-7"><a href="#多项式求逆-7" class="headerlink" title="多项式求逆"></a>多项式求逆</h4><p>给定多项式$h(x)$ 有方程<br>$$<br>g(f(x))&#x3D;\frac1 {f(x)}-h(x)\equiv0\pmod0<br>$$<br>应用牛顿迭代有<br>$$<br>\begin{aligned}<br>    f\left(x\right)&amp;\equiv f_{0}\left(x\right)-\frac{\frac{1}{f_{0}\left(x\right)}-h\left(x\right)}{-\frac{1}{f_{0}^{2}\left(x\right)}}&amp;\pmod{x^{n}}\<br>    &amp;\equiv 2f_{0}\left(x\right)-f_{0}^{2}\left(x\right)h\left(x\right)&amp;\pmod{x^{n}}<br>\end{aligned}<br>$$</p>
<h4 id="多项式开方-7"><a href="#多项式开方-7" class="headerlink" title="多项式开方"></a>多项式开方</h4><p>给定多项式$h(x)$ 有方程<br>$$<br>g(f(x))&#x3D;f^2(x)-h(x)\equiv0\pmod{x^n}<br>$$<br>应用牛顿迭代有<br>$$<br>f(x)\equiv f_0(x)-\frac{f_0^2(x)-h(x)}{2f_0(x)}\pmod{x^n}<br>\<br>\equiv\frac{f_0^2(x)+h(x)}{2f_0(x)}\pmod{x^n}<br>$$</p>
<h4 id="多项式exp-7"><a href="#多项式exp-7" class="headerlink" title="多项式exp"></a>多项式exp</h4><p>给定多项式$h(x)$ 有方程<br>$$<br>g(f(x))&#x3D;\ln f(x)-h(x)\pmod {x^n}<br>$$<br>应用牛顿迭代有.<br>$$<br>f(x)\equiv f_0(x)-\frac{\ln f_0(x)-h(x)}{\frac1{f_0(x)}}<br>\<br>f_0(x)(1-ln f_0(x)+h(x))\pmod{x^n}<br>$$</p>
<h1 id="可能是多项式模板全家桶-8"><a href="#可能是多项式模板全家桶-8" class="headerlink" title="可能是多项式模板全家桶"></a>可能是多项式模板全家桶</h1><h1 id="不到-万字长文-8"><a href="#不到-万字长文-8" class="headerlink" title="(不到)万字长文"></a>(不到)万字长文</h1><h1 id="或许是较好理解的板子讲解-8"><a href="#或许是较好理解的板子讲解-8" class="headerlink" title="或许是较好理解的板子讲解"></a>或许是较好理解的板子讲解</h1><p>本文无代码 否则您将学习每天一个常数爆炸小技巧</p>
<p>qwq</p>
<p>阅读本文约需9分钟:</p>
<p><img src="https://i.loli.net/2021/07/10/5n41cEs3UOlhH69.png" alt="image-20210710093833431"></p>
<h2 id="前置知识-8"><a href="#前置知识-8" class="headerlink" title="前置知识:"></a>前置知识:</h2><h3 id="复数-8"><a href="#复数-8" class="headerlink" title="复数"></a>复数</h3><h4 id="虚数单位-8"><a href="#虚数单位-8" class="headerlink" title="虚数单位"></a>虚数单位</h4><p>虚数单位$i&#x3D;\sqrt{(-1)}$</p>
<h4 id="定义-16"><a href="#定义-16" class="headerlink" title="定义"></a>定义</h4><p>复数是形如$a+bi$的数</p>
<h4 id="运算-8"><a href="#运算-8" class="headerlink" title="运算"></a>运算</h4><h5 id="加法-8"><a href="#加法-8" class="headerlink" title="加法"></a>加法</h5><p>复数 $x&#x3D;(a+bi),y&#x3D;(c+di)$的和定义为 $x+y&#x3D;(a+bi)+(c+di)&#x3D;a+c+(d+b)i$</p>
<h5 id="乘法-8"><a href="#乘法-8" class="headerlink" title="乘法"></a>乘法</h5><p>复数 $x&#x3D;(a+bi),y&#x3D;(c+di)$的积定义为$xy&#x3D;(a+bi)(c+di)&#x3D;ac-bd+(ad+cb)i$</p>
<p>发现复数可以用座标表示 如$x&#x3D;(a+bi)$可表示为$(a,b)$ 这样也可以表示为向量 我们记模长为$r&#x3D;\sqrt{a^2+b^2}$ 俯角为$\alpha$ 于是向量表示为$(rcos\alpha,rsin\alpha)$ 发现一个性质 两向量的积$(rcos\alpha,rsin\alpha)(Rcos\beta,Rsin\beta)$等于$(rRcos(\alpha+\beta),rRsin(\alpha+\beta))$ 模长相乘俯角相加</p>
<h3 id="单位根-8"><a href="#单位根-8" class="headerlink" title="单位根"></a>单位根</h3><p>单位根是形如这样的方程的所有的根:<br>$$<br>x^n&#x3D;1<br>$$<br>根据算数基本定理 这样的根在复数域上有n个</p>
<p>我们记第一个为$w_n$ 它应当是某个复数 我们知道 复数乘法满足模长相差俯角相加 那么它在复数域上的几何表示就是单位圆$n$等分后从(0,1)开始转的第一份</p>
<p>我么发现 第一个单位根的k次方$(0&lt;&#x3D;k&lt;&#x3D;n-1)$也是一个单位根</p>
<p>单位根具有以下性质 希望读者自行验证:</p>
<p>1 $w_n^k&#x3D;w_{n&#x2F;2}^{k&#x2F;2}$</p>
<p>2 $w_n^{k+n}&#x3D;w_n^k$</p>
<p>3 $w_n^{k+n&#x2F;2}&#x3D;-w_n^k$</p>
<p>4 $w_n^0&#x3D;w_n^n&#x3D;1$</p>
<h3 id="原根-8"><a href="#原根-8" class="headerlink" title="原根"></a>原根</h3><h4 id="阶-8"><a href="#阶-8" class="headerlink" title="阶"></a>阶</h4><p>对于一个数 a 一个模数 p 存在最小的 y使得<br>$$<br>a^y\equiv1\pmod p<br>$$</p>
<h4 id="定义-17"><a href="#定义-17" class="headerlink" title="定义"></a>定义</h4><p>若对于一个模数p 存在一个a使得a对p的阶等于phi(p) 那么a就叫做p的原根</p>
<h4 id="性质-8"><a href="#性质-8" class="headerlink" title="性质"></a>性质</h4><p>$a^0,a^1,a^2,⋯,a^{\varphi(p)}$ 模 p 两两不同余，且 $a^k\equiv a^{k+\varphi(p)}\pmod p$</p>
<h3 id="泰勒展开-8"><a href="#泰勒展开-8" class="headerlink" title="泰勒展开"></a>泰勒展开</h3><p>回忆微分法</p>
<p>熟知对于一点$x_0$ 我们试图寻找其邻域的某点$x$及其函数值$f(x)$ 我们应该构造关于$(x-x_0)$的一次多项式 $p(x)&#x3D;f(x_0)+f’(x_0)(x-x_0)$  使得$p’(x-x_0)&#x3D;f’(x_0)$</p>
<p>发现该微分法存在以下突出问题:</p>
<ul>
<li>精度损失不确定</li>
<li>精度损失较大</li>
</ul>
<p>于是我们期望能够得到一个多项式$p(x)$ 使得<br>$$<br>p(x)&#x3D;\sum_{i&#x3D;0}^{n}a_i(x-x_0)^i<br>$$<br>并且$p^{(i)}(x-x_0)&#x3D;f^{(n)}(x_0)$</p>
<p>于是设x&#x3D;0连续求导后 $a_i&#x3D;\frac{f^{(i)}(x)}{i!}$</p>
<h3 id="牛顿迭代-8"><a href="#牛顿迭代-8" class="headerlink" title="牛顿迭代"></a>牛顿迭代</h3><p>发现我们在对精度要求不高时可以使用导数(直线)近似代替原函数来近似求解函数根</p>
<p>若对精度要求更高重复使用即可 </p>
<p>这样我们引出迭代公式<br>$$<br>在(x_0,f(x_0))处的切线方程为y-f(x_0)&#x3D;f’(x_0)(x-x_0)<br>\<br>于是x&#x3D;x_0-\frac{f(x_0)}{f’(x_0)}<br>$$</p>
<h2 id="FFT-8"><a href="#FFT-8" class="headerlink" title="FFT"></a>FFT</h2><p>fft是解决多项式乘法(加法卷积)的一种方法</p>
<p>我们发现加法卷积复杂度极高 这是不能被我们承受的</p>
<p>考虑讲要卷的两个多项式求出点值表示 然后把点值相乘 然后插值回答案多项式</p>
<h3 id="DFT-8"><a href="#DFT-8" class="headerlink" title="DFT"></a>DFT</h3><p>dft是进行多项式多点求值的算法 我们发现多项式<br>$$<br>f(x)&#x3D;a_0+a_1x^1+a_2x^2+a_3x^3+a_4x^4+a_5x^5…<br>\<br>可以拆分为<br>\<br>fl(x)&#x3D;a_0+a_2x^1+a_4x^2+a_6x^3…<br>\和\<br>fr(x)&#x3D;a_1+a_3x^1+a_5x^2+a7x^3…<br>\于是\<br>f(x)&#x3D;fl(x^2)+xfr(x^2)<br>\我们试着将单位根带入\<br>f(w_n^k)&#x3D;fl(w_n^{2k})+w_n^kfr(w_n^{2k})&#x3D;fl(w_{n&#x2F;2}^{k})+w_n^kfr(w_{n&#x2F;2}^{k})<br>\并且有\<br>f(w_n^{k+n&#x2F;2})&#x3D;fl(w_n^{2k+n})+w_n^{k+n&#x2F;2}fr(w_n^{2k+n})&#x3D;fl(w_{n&#x2F;2}^{k})-w_n^kfr(w_{n&#x2F;2}^{k})<br>$$<br>我们可以分治求解 复杂度$O(nlogn)$</p>
<h3 id="IDFT-8"><a href="#IDFT-8" class="headerlink" title="IDFT"></a>IDFT</h3><p>idft是进行多项式多点插值的算法</p>
<p>$(y_0,y_1,y_2…y_{n-1})$为$(a_0,a_1,a_2,…a_{n-1})$的点值表示</p>
<p>那么设另一组数列${c_k}$满足$c_k&#x3D;\sum_{i&#x3D;0}^{n-1}y_i(w_n^{-k})^i$</p>
<p>那么<br>$$<br>c_k&#x3D;\sum_{i&#x3D;0}^{n-1}y_i(w_n^{-k})^i<br>\<br>&#x3D;\sum^{n-1}<em>{i&#x3D;0}(\sum^{n-1}</em>{j&#x3D;0}a_j(w^i_n)^j)(w_n^{-k})^i<br>\<br>&#x3D;\sum^{n-1}<em>{i&#x3D;0}(\sum^{n-1}</em>{j&#x3D;0}a_j(w^j_n)^i)(w_n^{-k})^i<br>\<br>&#x3D;\sum^{n-1}<em>{i&#x3D;0}\sum^{n-1}</em>{j&#x3D;0}a_j(w^{j-k}<em>n)^i<br>\<br>&#x3D;\sum^{n-1}</em>{j&#x3D;0}a_j(\sum^{n-1}_{i&#x3D;0}(w^{j-k}_n)^i)<br>$$</p>
<p>那么 我们发现 对于后半个合式 若$j&#x3D;k$ 取值为$n$</p>
<p>若不等呢:</p>
<p>设$j-k&#x3D;s$</p>
<p>利用等比数列求和公式 </p>
<p>后半个合式等于$\frac{(w_n^s)^n-1}{w_n^s}$</p>
<p>上半部等于0</p>
<p>于是$c_k&#x3D;na_k$</p>
<p>把n除过去即可</p>
<h2 id="NTT-8"><a href="#NTT-8" class="headerlink" title="NTT"></a>NTT</h2><p>发现整个fft的过程中都是在做实数运算 精度误差存在且不小 并且复数运算很慢 甚至某些时候需要蝴蝶优化减少递归带来的巨大常数 我们的推导用到了单位根的如下性质:</p>
<p>1 $w_n^k&#x3D;w_{n&#x2F;2}^{k&#x2F;2}$</p>
<p>2 $w_n^{k+n}&#x3D;w_n^k$</p>
<p>3 $w_n^{k+n&#x2F;2}&#x3D;-w_n^k$</p>
<p>4 $w_n^0&#x3D;w_n^n&#x3D;1$</p>
<p>5 n次方内互不相等</p>
<p>惊喜的发现这些性质在模意义下的时原根也具有 </p>
<p>于是在代码中将复数全部换为原根即可</p>
<h2 id="FWT-8"><a href="#FWT-8" class="headerlink" title="FWT"></a>FWT</h2><p>fwt是用于解决一类位运算卷积的算法</p>
<h3 id="基本思想与概览-8"><a href="#基本思想与概览-8" class="headerlink" title="基本思想与概览"></a>基本思想与概览</h3><p>熟知fft是线性的 我们期望fwt也可以得到一个线性函数</p>
<p>我们首先写出位运算卷积的一般形式:<br>$$<br>S[k]&#x3D;\sum_{i\oplus j&#x3D;k}A[i]B[j]<br>$$<br>记作<br>$$<br>S&#x3D;A*B<br>$$<br>其中$\oplus$是某种位运算</p>
<p>设FWT变换系数为$c(i,j)$ 我们设FWT(A)是A经过FWT变换后的数列</p>
<p>需满足:<br>$$<br>A*B&#x3D;C \iff FWT(A)\cdot FWT(B)&#x3D;FWT(B)<br>$$<br>于是<br>$$<br>FWT(A)[i]&#x3D;\sum^{n-1}<em>{j&#x3D;0}c(i,j)A_j<br>$$<br>依<br>$$<br>FWT(A)\cdot FWT(B)&#x3D;FWT(B)<br>$$<br>得<br>$$<br>FWT(A)[i]FWT(B)[i]&#x3D;FWT(c)[I]<br>\<br>\sum^{n-1}</em>{j&#x3D;0}c(i,j)A[j]\sum^{n-1}<em>{k&#x3D;0}c(i,k)B[k]&#x3D;\sum^{n-1}</em>{p&#x3D;0}c(i,p)C[p]<br>\<br>\sum^{n-1}<em>{j&#x3D;0}\sum^{n-1}</em>{k&#x3D;0}c(i,j)c(i,k)A[j]B[k]&#x3D;\sum^{n-1}<em>{p&#x3D;0}c(i,p)C[p]<br>$$<br>依<br>$$<br>C[p]&#x3D;\sum</em>{t_1\oplus t_2&#x3D;p}A[t_1]B[t_2]<br>$$<br>又得<br>$$<br>\sum^{n-1}<em>{p&#x3D;0}c(i,p)C[p]&#x3D;\sum^{n-1}</em>{p&#x3D;0}c(i,p)\sum_{t_1\oplus t_2&#x3D;p}A[t_1]B[t_2]<br>\<br>\sum^{n-1}<em>{j&#x3D;0}\sum^{n-1}</em>{k&#x3D;0}c(i,j)c(i,k)A[j]B[k]&#x3D;\sum^{n-1}<em>{p&#x3D;0}c(i,p)\sum</em>{t_1\oplus t_2&#x3D;p}A[t_1]B[t_2]<br>\<br>\sum^{n-1}<em>{j&#x3D;0}\sum^{n-1}</em>{k&#x3D;0}c(i,j)c(i,k)A[j]B[k]&#x3D;\sum^{n-1}<em>{t_1&#x3D;0}\sum</em>{t_2&#x3D;0}^{n-1}A[t_1]B[t_2]c(i,t_1\oplus t_2)<br>$$<br>对比发现只需使$c(i,j)c(i,k)&#x3D;c(i,j\oplus k)$</p>
<p>另外 由位运算只考虑独立位的特殊性 我们有:</p>
<p>对于一个二进制数a 它的每一位表示为$a_0,a_1,a_2,a_3,a_4,….$</p>
<p>设我们已经知道所有满足要求的c([0,1],[0,1])</p>
<p>那么<br>$$<br>c(i,j)&#x3D;c(i_0,j_0)c(i_1,j_1)c(i_2,j_2),…<br>$$<br>于是<br>$$<br>\prod_p c(i_p,j_p)c(i_p,k_p)&#x3D;\prod_p c(i_p,j_p\oplus k_p)<br>\<br>c(i,j)c(i,k)&#x3D;c(i,j\oplus k)<br>$$<br>由此 只要我们构造出单位的c函数 我们就可以构造出所有数的c函数</p>
<p>我们如何快速求位运算卷积呢</p>
<p>依然考虑分治</p>
<p>首先折半<br>$$<br>FWT(A)[i]&#x3D;\sum_{j&#x3D;0}^{(n&#x2F;2)-1}c(i,j)A[j]+\sum_{j&#x3D;(n&#x2F;2)}^{n-1}c(i,j)A[j]<br>$$<br>对于i,j的首位 我们分开考虑 设i’为i去掉二进制首位的数</p>
<p>于是<br>$$<br>&#x3D;\sum_{j&#x3D;0}^{(n&#x2F;2)-1}c(i_0,j_0)c(i’,j’)A[j]+\sum_{j&#x3D;(n&#x2F;2)}^{n-1}c(i_0,j_0)c(i’,j’)A[j]<br>\<br>&#x3D;c(i_0,0)\sum_{j&#x3D;0}^{(n&#x2F;2)-1}c(i’,j’)A[j]+c(i_0,1)\sum_{j&#x3D;(n&#x2F;2)}^{n-1}c(i_0,j_0)c(i’,j’)A[j]<br>$$<br>加号两边柿子分别递归处理 我们成功缩小了问题的规模</p>
<h3 id="一些例子-8"><a href="#一些例子-8" class="headerlink" title="一些例子"></a>一些例子</h3><p>针对不同位运算 我们需要构造出不同的c([0,1],[0,1]) 再结合上面的推导 问题就得到了解决</p>
<h4 id="Or卷积-8"><a href="#Or卷积-8" class="headerlink" title="Or卷积"></a>Or卷积</h4><p>c([0&#x2F;1],[0&#x2F;1])的矩阵<br>$$<br>\begin{bmatrix}<br>c(0,0)&amp;c(0,1)\<br>c(1,0)&amp;c(1,1)<br>\end{bmatrix}<br>$$</p>
<p>应满足条件 $c(i,j)c(i,k)&#x3D;c(i,j|k)$ </p>
<ul>
<li>$c(0,0)&#x3D;c(0,0|0)\Rightarrow c(0,0)&#x3D;1或0$</li>
<li>$c(0,1)c(0,0)&#x3D; c(0,1|0)\Rightarrow c(0,1)&#x3D;0或c(0,0)&#x3D;c(0,1)&#x3D;1$</li>
<li>$c(1,1)c(1,0)&#x3D;c(1,1|0)\Rightarrow c(1,1)&#x3D;0或c(1,0)&#x3D;c(1,1)&#x3D;1$</li>
</ul>
<p>并且这个矩阵应当是有逆的 否则就无法回去 我们最终选取</p>
<p>$c(0,0)&#x3D;1,c(0,1)&#x3D;0,c(1,0)&#x3D;1,c(1,1)&#x3D;1$</p>
<p>逆变换其实只需矩阵求逆即可 </p>
<p>或者考虑算式的反算式即可</p>
<p>那么同理对于</p>
<h4 id="And卷积-8"><a href="#And卷积-8" class="headerlink" title="And卷积"></a>And卷积</h4><p>有矩阵<br>$$<br>\begin{bmatrix}<br>1&amp;1\<br>0&amp;1<br>\end{bmatrix}<br>$$</p>
<p>和</p>
<h4 id="Xor卷积-8"><a href="#Xor卷积-8" class="headerlink" title="Xor卷积"></a>Xor卷积</h4><p>有矩阵<br>$$<br>\begin{bmatrix}<br>1&amp;1\<br>1&amp;-1<br>\end{bmatrix}<br>$$<br>既得易见平凡 仿照上例显然 留作习题答案略 读者自证不难</p>
<p>反之亦然同理 推论自然成立 略去过程Q E D  由上可知证毕 </p>
<p>​	西江月&#x2F;证明</p>
<h2 id="多项式乘法逆-8"><a href="#多项式乘法逆-8" class="headerlink" title="多项式乘法逆"></a>多项式乘法逆</h2><p>多项式求逆即对于多项式$f(x)$</p>
<p>我们求一个$g(x)$</p>
<p>使得<br>$$<br>g(x)*f(x)\equiv1 \pmod {x^n}<br>$$</p>
<h3 id="倍增法-16"><a href="#倍增法-16" class="headerlink" title="倍增法"></a>倍增法</h3><h4 id="边界-8"><a href="#边界-8" class="headerlink" title="边界"></a>边界</h4><p>当界为$\pmod{x^1}$ 即多项式只有常数项时 直接数字逆元即可</p>
<h4 id="转移-8"><a href="#转移-8" class="headerlink" title="转移"></a>转移</h4><p>假设我们得到了$T(x)\equiv F(x)^{-1} \pmod {x^{n&#x2F;2}}$</p>
<p>显然有$G(x)\equiv T(x)\pmod{x^{n&#x2F;2}}$</p>
<p>那么 $(G(x)-T(x))^2\equiv0\pmod{x^n}$</p>
<p>$G(x)^2-2G(x)T(x)+T(x)^2\equiv0\pmod{x^n}$</p>
<p>同乘$F(x)$</p>
<p>$R(x)-2G(x)-G(x)^2F(x)\equiv0\pmod{x^n}$</p>
<p>运用多项式乘法倍增即可</p>
<h2 id="多项式开根-8"><a href="#多项式开根-8" class="headerlink" title="多项式开根"></a>多项式开根</h2><p>给定$g(x)$ 求$f(x)$满足<br>$$<br>f^2(x)\equiv g(x)\pmod{x^n}<br>$$</p>
<h3 id="倍增法-17"><a href="#倍增法-17" class="headerlink" title="倍增法"></a>倍增法</h3><p>假设已求出$g(x)$在模$x^{[n&#x2F;2]}$意义下的平方根$f_0(x)$ 则有<br>$$<br>f_0^2(x)\equiv g(x) \pmod{x^{[n&#x2F;2]}}<br>\<br>f_0^2(x)-g(x)\equiv 0\pmod{x^{[n&#x2F;2]}}<br>\<br>(f_0^2(x)-g(x))^2\equiv 0\pmod{x^{n}}<br>\<br>(f_0^2(x)+g(x))^2\equiv 4f_0^2(x)g(x)\pmod{x^{n}}<br>\<br>(\frac{f_0^2(x)+g(x)}{2f_0(x)})\equiv g(x)\pmod{x^{n}}<br>\<br>\frac{f_0^2(x)+g(x)}{2f_0(x)}\equiv f(x) \pmod{x^n}<br>\<br>\frac 1 2f_0(x)+2^{-1}f_0^{-1}(x)g(x)\equiv f(x) \pmod{x^n}<br>$$</p>
<h2 id="多项式除法-8"><a href="#多项式除法-8" class="headerlink" title="多项式除法"></a>多项式除法</h2><p>给定多项式$f(x),g(x)$ 求$g(x)$除$f(x)$的商$q(x)$和余数$r(x)$</p>
<p>若能消去$r(x)$的影响则可直接多项式乘法逆</p>
<p>考虑构造<br>$$<br>f_r(x)&#x3D;x^nf(\frac 1 x)<br>$$<br>容易发现其为反转$f(x)$系数</p>
<p>设$n&#x3D;\deg f,m&#x3D;\deg g$</p>
<p>则<br>$$<br>f(x)&#x3D;q(x)g(x)+r(x)\Rightarrow<br>\<br>x^nf(\frac 1 x)&#x3D;x^{n-m}q(\frac 1 x)x^mg(\frac 1 x)+x^{n-m+1}x^{m-1}r(\frac 1 x)<br>\<br>f_r(x)&#x3D;q_r(x)g_r(x)+x^{n-m+1}r_r(x)<br>\<br>于是<br>\<br>f_r(x)\equiv q_r(x)g_r(x)\pmod{x^{n-m+1}}<br>$$<br>多项式求逆$g_r(x)$即可 然后求出$q_r(x)$和$r_r(x)$</p>
<h2 id="多项式ln-8"><a href="#多项式ln-8" class="headerlink" title="多项式ln"></a>多项式ln</h2><p>给定多项式$f(x)$ 求模$x^n$意义下$lnf(x)$</p>
<p>解法本质就是暴力</p>
<p>对多项式先求导再积分即可<br>$$<br>\frac {\text{d}\ln f(x)}{dx}\equiv \frac {1}{f(x)} f’(x)\pmod{x^n}<br>$$</p>
<h2 id="多项式牛顿迭代-8"><a href="#多项式牛顿迭代-8" class="headerlink" title="多项式牛顿迭代"></a>多项式牛顿迭代</h2><p>对于给定$g(x)$ 求$f(x)$ 使得其满足$g(f(x))\equiv 0 \pmod{ x^n}$</p>
<p>假设已经得到了模$x^{[n&#x2F;2]}$次方的解$f_0(x)$ 要求模$x^n$的解$f(x)$</p>
<p>跟据定义我们知道 $f(x)$与$f_0(x)$在前$[n&#x2F;2]-1$位上相等 </p>
<p>那么我们写出$g(f(x))$在$f_0(x)$处的泰勒展开 </p>
<p><img src="https://i.loli.net/2021/07/10/AreopyjgdDlhbU6.png" alt="image-20210710085546653"></p>
<p>发现从第三项往后全部被模掉了 没有意义 我们即可直接用牛顿迭代式计算</p>
<p><img src="https://i.loli.net/2021/07/10/jq9MTVmktfgHaus.png" alt="image-20210710085712805"></p>
<h3 id="应用-8"><a href="#应用-8" class="headerlink" title="应用"></a>应用</h3><h4 id="多项式求逆-8"><a href="#多项式求逆-8" class="headerlink" title="多项式求逆"></a>多项式求逆</h4><p>给定多项式$h(x)$ 有方程<br>$$<br>g(f(x))&#x3D;\frac1 {f(x)}-h(x)\equiv0\pmod0<br>$$<br>应用牛顿迭代有<br>$$<br>\begin{aligned}<br>    f\left(x\right)&amp;\equiv f_{0}\left(x\right)-\frac{\frac{1}{f_{0}\left(x\right)}-h\left(x\right)}{-\frac{1}{f_{0}^{2}\left(x\right)}}&amp;\pmod{x^{n}}\<br>    &amp;\equiv 2f_{0}\left(x\right)-f_{0}^{2}\left(x\right)h\left(x\right)&amp;\pmod{x^{n}}<br>\end{aligned}<br>$$</p>
<h4 id="多项式开方-8"><a href="#多项式开方-8" class="headerlink" title="多项式开方"></a>多项式开方</h4><p>给定多项式$h(x)$ 有方程<br>$$<br>g(f(x))&#x3D;f^2(x)-h(x)\equiv0\pmod{x^n}<br>$$<br>应用牛顿迭代有<br>$$<br>f(x)\equiv f_0(x)-\frac{f_0^2(x)-h(x)}{2f_0(x)}\pmod{x^n}<br>\<br>\equiv\frac{f_0^2(x)+h(x)}{2f_0(x)}\pmod{x^n}<br>$$</p>
<h4 id="多项式exp-8"><a href="#多项式exp-8" class="headerlink" title="多项式exp"></a>多项式exp</h4><p>给定多项式$h(x)$ 有方程<br>$$<br>g(f(x))&#x3D;\ln f(x)-h(x)\pmod {x^n}<br>$$<br>应用牛顿迭代有.<br>$$<br>f(x)\equiv f_0(x)-\frac{\ln f_0(x)-h(x)}{\frac1{f_0(x)}}<br>\<br>f_0(x)(1-ln f_0(x)+h(x))\pmod{x^n}<br>$$</p>
<h1 id="可能是多项式模板全家桶-9"><a href="#可能是多项式模板全家桶-9" class="headerlink" title="可能是多项式模板全家桶"></a>可能是多项式模板全家桶</h1><h1 id="不到-万字长文-9"><a href="#不到-万字长文-9" class="headerlink" title="(不到)万字长文"></a>(不到)万字长文</h1><h1 id="或许是较好理解的板子讲解-9"><a href="#或许是较好理解的板子讲解-9" class="headerlink" title="或许是较好理解的板子讲解"></a>或许是较好理解的板子讲解</h1><p>本文无代码 否则您将学习每天一个常数爆炸小技巧</p>
<p>qwq</p>
<p>阅读本文约需9分钟:</p>
<p><img src="https://i.loli.net/2021/07/10/5n41cEs3UOlhH69.png" alt="image-20210710093833431"></p>
<h2 id="前置知识-9"><a href="#前置知识-9" class="headerlink" title="前置知识:"></a>前置知识:</h2><h3 id="复数-9"><a href="#复数-9" class="headerlink" title="复数"></a>复数</h3><h4 id="虚数单位-9"><a href="#虚数单位-9" class="headerlink" title="虚数单位"></a>虚数单位</h4><p>虚数单位$i&#x3D;\sqrt{(-1)}$</p>
<h4 id="定义-18"><a href="#定义-18" class="headerlink" title="定义"></a>定义</h4><p>复数是形如$a+bi$的数</p>
<h4 id="运算-9"><a href="#运算-9" class="headerlink" title="运算"></a>运算</h4><h5 id="加法-9"><a href="#加法-9" class="headerlink" title="加法"></a>加法</h5><p>复数 $x&#x3D;(a+bi),y&#x3D;(c+di)$的和定义为 $x+y&#x3D;(a+bi)+(c+di)&#x3D;a+c+(d+b)i$</p>
<h5 id="乘法-9"><a href="#乘法-9" class="headerlink" title="乘法"></a>乘法</h5><p>复数 $x&#x3D;(a+bi),y&#x3D;(c+di)$的积定义为$xy&#x3D;(a+bi)(c+di)&#x3D;ac-bd+(ad+cb)i$</p>
<p>发现复数可以用座标表示 如$x&#x3D;(a+bi)$可表示为$(a,b)$ 这样也可以表示为向量 我们记模长为$r&#x3D;\sqrt{a^2+b^2}$ 俯角为$\alpha$ 于是向量表示为$(rcos\alpha,rsin\alpha)$ 发现一个性质 两向量的积$(rcos\alpha,rsin\alpha)(Rcos\beta,Rsin\beta)$等于$(rRcos(\alpha+\beta),rRsin(\alpha+\beta))$ 模长相乘俯角相加</p>
<h3 id="单位根-9"><a href="#单位根-9" class="headerlink" title="单位根"></a>单位根</h3><p>单位根是形如这样的方程的所有的根:<br>$$<br>x^n&#x3D;1<br>$$<br>根据算数基本定理 这样的根在复数域上有n个</p>
<p>我们记第一个为$w_n$ 它应当是某个复数 我们知道 复数乘法满足模长相差俯角相加 那么它在复数域上的几何表示就是单位圆$n$等分后从(0,1)开始转的第一份</p>
<p>我么发现 第一个单位根的k次方$(0&lt;&#x3D;k&lt;&#x3D;n-1)$也是一个单位根</p>
<p>单位根具有以下性质 希望读者自行验证:</p>
<p>1 $w_n^k&#x3D;w_{n&#x2F;2}^{k&#x2F;2}$</p>
<p>2 $w_n^{k+n}&#x3D;w_n^k$</p>
<p>3 $w_n^{k+n&#x2F;2}&#x3D;-w_n^k$</p>
<p>4 $w_n^0&#x3D;w_n^n&#x3D;1$</p>
<h3 id="原根-9"><a href="#原根-9" class="headerlink" title="原根"></a>原根</h3><h4 id="阶-9"><a href="#阶-9" class="headerlink" title="阶"></a>阶</h4><p>对于一个数 a 一个模数 p 存在最小的 y使得<br>$$<br>a^y\equiv1\pmod p<br>$$</p>
<h4 id="定义-19"><a href="#定义-19" class="headerlink" title="定义"></a>定义</h4><p>若对于一个模数p 存在一个a使得a对p的阶等于phi(p) 那么a就叫做p的原根</p>
<h4 id="性质-9"><a href="#性质-9" class="headerlink" title="性质"></a>性质</h4><p>$a^0,a^1,a^2,⋯,a^{\varphi(p)}$ 模 p 两两不同余，且 $a^k\equiv a^{k+\varphi(p)}\pmod p$</p>
<h3 id="泰勒展开-9"><a href="#泰勒展开-9" class="headerlink" title="泰勒展开"></a>泰勒展开</h3><p>回忆微分法</p>
<p>熟知对于一点$x_0$ 我们试图寻找其邻域的某点$x$及其函数值$f(x)$ 我们应该构造关于$(x-x_0)$的一次多项式 $p(x)&#x3D;f(x_0)+f’(x_0)(x-x_0)$  使得$p’(x-x_0)&#x3D;f’(x_0)$</p>
<p>发现该微分法存在以下突出问题:</p>
<ul>
<li>精度损失不确定</li>
<li>精度损失较大</li>
</ul>
<p>于是我们期望能够得到一个多项式$p(x)$ 使得<br>$$<br>p(x)&#x3D;\sum_{i&#x3D;0}^{n}a_i(x-x_0)^i<br>$$<br>并且$p^{(i)}(x-x_0)&#x3D;f^{(n)}(x_0)$</p>
<p>于是设x&#x3D;0连续求导后 $a_i&#x3D;\frac{f^{(i)}(x)}{i!}$</p>
<h3 id="牛顿迭代-9"><a href="#牛顿迭代-9" class="headerlink" title="牛顿迭代"></a>牛顿迭代</h3><p>发现我们在对精度要求不高时可以使用导数(直线)近似代替原函数来近似求解函数根</p>
<p>若对精度要求更高重复使用即可 </p>
<p>这样我们引出迭代公式<br>$$<br>在(x_0,f(x_0))处的切线方程为y-f(x_0)&#x3D;f’(x_0)(x-x_0)<br>\<br>于是x&#x3D;x_0-\frac{f(x_0)}{f’(x_0)}<br>$$</p>
<h2 id="FFT-9"><a href="#FFT-9" class="headerlink" title="FFT"></a>FFT</h2><p>fft是解决多项式乘法(加法卷积)的一种方法</p>
<p>我们发现加法卷积复杂度极高 这是不能被我们承受的</p>
<p>考虑讲要卷的两个多项式求出点值表示 然后把点值相乘 然后插值回答案多项式</p>
<h3 id="DFT-9"><a href="#DFT-9" class="headerlink" title="DFT"></a>DFT</h3><p>dft是进行多项式多点求值的算法 我们发现多项式<br>$$<br>f(x)&#x3D;a_0+a_1x^1+a_2x^2+a_3x^3+a_4x^4+a_5x^5…<br>\<br>可以拆分为<br>\<br>fl(x)&#x3D;a_0+a_2x^1+a_4x^2+a_6x^3…<br>\和\<br>fr(x)&#x3D;a_1+a_3x^1+a_5x^2+a7x^3…<br>\于是\<br>f(x)&#x3D;fl(x^2)+xfr(x^2)<br>\我们试着将单位根带入\<br>f(w_n^k)&#x3D;fl(w_n^{2k})+w_n^kfr(w_n^{2k})&#x3D;fl(w_{n&#x2F;2}^{k})+w_n^kfr(w_{n&#x2F;2}^{k})<br>\并且有\<br>f(w_n^{k+n&#x2F;2})&#x3D;fl(w_n^{2k+n})+w_n^{k+n&#x2F;2}fr(w_n^{2k+n})&#x3D;fl(w_{n&#x2F;2}^{k})-w_n^kfr(w_{n&#x2F;2}^{k})<br>$$<br>我们可以分治求解 复杂度$O(nlogn)$</p>
<h3 id="IDFT-9"><a href="#IDFT-9" class="headerlink" title="IDFT"></a>IDFT</h3><p>idft是进行多项式多点插值的算法</p>
<p>$(y_0,y_1,y_2…y_{n-1})$为$(a_0,a_1,a_2,…a_{n-1})$的点值表示</p>
<p>那么设另一组数列${c_k}$满足$c_k&#x3D;\sum_{i&#x3D;0}^{n-1}y_i(w_n^{-k})^i$</p>
<p>那么<br>$$<br>c_k&#x3D;\sum_{i&#x3D;0}^{n-1}y_i(w_n^{-k})^i<br>\<br>&#x3D;\sum^{n-1}<em>{i&#x3D;0}(\sum^{n-1}</em>{j&#x3D;0}a_j(w^i_n)^j)(w_n^{-k})^i<br>\<br>&#x3D;\sum^{n-1}<em>{i&#x3D;0}(\sum^{n-1}</em>{j&#x3D;0}a_j(w^j_n)^i)(w_n^{-k})^i<br>\<br>&#x3D;\sum^{n-1}<em>{i&#x3D;0}\sum^{n-1}</em>{j&#x3D;0}a_j(w^{j-k}<em>n)^i<br>\<br>&#x3D;\sum^{n-1}</em>{j&#x3D;0}a_j(\sum^{n-1}_{i&#x3D;0}(w^{j-k}_n)^i)<br>$$</p>
<p>那么 我们发现 对于后半个合式 若$j&#x3D;k$ 取值为$n$</p>
<p>若不等呢:</p>
<p>设$j-k&#x3D;s$</p>
<p>利用等比数列求和公式 </p>
<p>后半个合式等于$\frac{(w_n^s)^n-1}{w_n^s}$</p>
<p>上半部等于0</p>
<p>于是$c_k&#x3D;na_k$</p>
<p>把n除过去即可</p>
<h2 id="NTT-9"><a href="#NTT-9" class="headerlink" title="NTT"></a>NTT</h2><p>发现整个fft的过程中都是在做实数运算 精度误差存在且不小 并且复数运算很慢 甚至某些时候需要蝴蝶优化减少递归带来的巨大常数 我们的推导用到了单位根的如下性质:</p>
<p>1 $w_n^k&#x3D;w_{n&#x2F;2}^{k&#x2F;2}$</p>
<p>2 $w_n^{k+n}&#x3D;w_n^k$</p>
<p>3 $w_n^{k+n&#x2F;2}&#x3D;-w_n^k$</p>
<p>4 $w_n^0&#x3D;w_n^n&#x3D;1$</p>
<p>5 n次方内互不相等</p>
<p>惊喜的发现这些性质在模意义下的时原根也具有 </p>
<p>于是在代码中将复数全部换为原根即可</p>
<h2 id="FWT-9"><a href="#FWT-9" class="headerlink" title="FWT"></a>FWT</h2><p>fwt是用于解决一类位运算卷积的算法</p>
<h3 id="基本思想与概览-9"><a href="#基本思想与概览-9" class="headerlink" title="基本思想与概览"></a>基本思想与概览</h3><p>熟知fft是线性的 我们期望fwt也可以得到一个线性函数</p>
<p>我们首先写出位运算卷积的一般形式:<br>$$<br>S[k]&#x3D;\sum_{i\oplus j&#x3D;k}A[i]B[j]<br>$$<br>记作<br>$$<br>S&#x3D;A*B<br>$$<br>其中$\oplus$是某种位运算</p>
<p>设FWT变换系数为$c(i,j)$ 我们设FWT(A)是A经过FWT变换后的数列</p>
<p>需满足:<br>$$<br>A*B&#x3D;C \iff FWT(A)\cdot FWT(B)&#x3D;FWT(B)<br>$$<br>于是<br>$$<br>FWT(A)[i]&#x3D;\sum^{n-1}<em>{j&#x3D;0}c(i,j)A_j<br>$$<br>依<br>$$<br>FWT(A)\cdot FWT(B)&#x3D;FWT(B)<br>$$<br>得<br>$$<br>FWT(A)[i]FWT(B)[i]&#x3D;FWT(c)[I]<br>\<br>\sum^{n-1}</em>{j&#x3D;0}c(i,j)A[j]\sum^{n-1}<em>{k&#x3D;0}c(i,k)B[k]&#x3D;\sum^{n-1}</em>{p&#x3D;0}c(i,p)C[p]<br>\<br>\sum^{n-1}<em>{j&#x3D;0}\sum^{n-1}</em>{k&#x3D;0}c(i,j)c(i,k)A[j]B[k]&#x3D;\sum^{n-1}<em>{p&#x3D;0}c(i,p)C[p]<br>$$<br>依<br>$$<br>C[p]&#x3D;\sum</em>{t_1\oplus t_2&#x3D;p}A[t_1]B[t_2]<br>$$<br>又得<br>$$<br>\sum^{n-1}<em>{p&#x3D;0}c(i,p)C[p]&#x3D;\sum^{n-1}</em>{p&#x3D;0}c(i,p)\sum_{t_1\oplus t_2&#x3D;p}A[t_1]B[t_2]<br>\<br>\sum^{n-1}<em>{j&#x3D;0}\sum^{n-1}</em>{k&#x3D;0}c(i,j)c(i,k)A[j]B[k]&#x3D;\sum^{n-1}<em>{p&#x3D;0}c(i,p)\sum</em>{t_1\oplus t_2&#x3D;p}A[t_1]B[t_2]<br>\<br>\sum^{n-1}<em>{j&#x3D;0}\sum^{n-1}</em>{k&#x3D;0}c(i,j)c(i,k)A[j]B[k]&#x3D;\sum^{n-1}<em>{t_1&#x3D;0}\sum</em>{t_2&#x3D;0}^{n-1}A[t_1]B[t_2]c(i,t_1\oplus t_2)<br>$$<br>对比发现只需使$c(i,j)c(i,k)&#x3D;c(i,j\oplus k)$</p>
<p>另外 由位运算只考虑独立位的特殊性 我们有:</p>
<p>对于一个二进制数a 它的每一位表示为$a_0,a_1,a_2,a_3,a_4,….$</p>
<p>设我们已经知道所有满足要求的c([0,1],[0,1])</p>
<p>那么<br>$$<br>c(i,j)&#x3D;c(i_0,j_0)c(i_1,j_1)c(i_2,j_2),…<br>$$<br>于是<br>$$<br>\prod_p c(i_p,j_p)c(i_p,k_p)&#x3D;\prod_p c(i_p,j_p\oplus k_p)<br>\<br>c(i,j)c(i,k)&#x3D;c(i,j\oplus k)<br>$$<br>由此 只要我们构造出单位的c函数 我们就可以构造出所有数的c函数</p>
<p>我们如何快速求位运算卷积呢</p>
<p>依然考虑分治</p>
<p>首先折半<br>$$<br>FWT(A)[i]&#x3D;\sum_{j&#x3D;0}^{(n&#x2F;2)-1}c(i,j)A[j]+\sum_{j&#x3D;(n&#x2F;2)}^{n-1}c(i,j)A[j]<br>$$<br>对于i,j的首位 我们分开考虑 设i’为i去掉二进制首位的数</p>
<p>于是<br>$$<br>&#x3D;\sum_{j&#x3D;0}^{(n&#x2F;2)-1}c(i_0,j_0)c(i’,j’)A[j]+\sum_{j&#x3D;(n&#x2F;2)}^{n-1}c(i_0,j_0)c(i’,j’)A[j]<br>\<br>&#x3D;c(i_0,0)\sum_{j&#x3D;0}^{(n&#x2F;2)-1}c(i’,j’)A[j]+c(i_0,1)\sum_{j&#x3D;(n&#x2F;2)}^{n-1}c(i_0,j_0)c(i’,j’)A[j]<br>$$<br>加号两边柿子分别递归处理 我们成功缩小了问题的规模</p>
<h3 id="一些例子-9"><a href="#一些例子-9" class="headerlink" title="一些例子"></a>一些例子</h3><p>针对不同位运算 我们需要构造出不同的c([0,1],[0,1]) 再结合上面的推导 问题就得到了解决</p>
<h4 id="Or卷积-9"><a href="#Or卷积-9" class="headerlink" title="Or卷积"></a>Or卷积</h4><p>c([0&#x2F;1],[0&#x2F;1])的矩阵<br>$$<br>\begin{bmatrix}<br>c(0,0)&amp;c(0,1)\<br>c(1,0)&amp;c(1,1)<br>\end{bmatrix}<br>$$</p>
<p>应满足条件 $c(i,j)c(i,k)&#x3D;c(i,j|k)$ </p>
<ul>
<li>$c(0,0)&#x3D;c(0,0|0)\Rightarrow c(0,0)&#x3D;1或0$</li>
<li>$c(0,1)c(0,0)&#x3D; c(0,1|0)\Rightarrow c(0,1)&#x3D;0或c(0,0)&#x3D;c(0,1)&#x3D;1$</li>
<li>$c(1,1)c(1,0)&#x3D;c(1,1|0)\Rightarrow c(1,1)&#x3D;0或c(1,0)&#x3D;c(1,1)&#x3D;1$</li>
</ul>
<p>并且这个矩阵应当是有逆的 否则就无法回去 我们最终选取</p>
<p>$c(0,0)&#x3D;1,c(0,1)&#x3D;0,c(1,0)&#x3D;1,c(1,1)&#x3D;1$</p>
<p>逆变换其实只需矩阵求逆即可 </p>
<p>或者考虑算式的反算式即可</p>
<p>那么同理对于</p>
<h4 id="And卷积-9"><a href="#And卷积-9" class="headerlink" title="And卷积"></a>And卷积</h4><p>有矩阵<br>$$<br>\begin{bmatrix}<br>1&amp;1\<br>0&amp;1<br>\end{bmatrix}<br>$$</p>
<p>和</p>
<h4 id="Xor卷积-9"><a href="#Xor卷积-9" class="headerlink" title="Xor卷积"></a>Xor卷积</h4><p>有矩阵<br>$$<br>\begin{bmatrix}<br>1&amp;1\<br>1&amp;-1<br>\end{bmatrix}<br>$$<br>既得易见平凡 仿照上例显然 留作习题答案略 读者自证不难</p>
<p>反之亦然同理 推论自然成立 略去过程Q E D  由上可知证毕 </p>
<p>​	西江月&#x2F;证明</p>
<h2 id="多项式乘法逆-9"><a href="#多项式乘法逆-9" class="headerlink" title="多项式乘法逆"></a>多项式乘法逆</h2><p>多项式求逆即对于多项式$f(x)$</p>
<p>我们求一个$g(x)$</p>
<p>使得<br>$$<br>g(x)*f(x)\equiv1 \pmod {x^n}<br>$$</p>
<h3 id="倍增法-18"><a href="#倍增法-18" class="headerlink" title="倍增法"></a>倍增法</h3><h4 id="边界-9"><a href="#边界-9" class="headerlink" title="边界"></a>边界</h4><p>当界为$\pmod{x^1}$ 即多项式只有常数项时 直接数字逆元即可</p>
<h4 id="转移-9"><a href="#转移-9" class="headerlink" title="转移"></a>转移</h4><p>假设我们得到了$T(x)\equiv F(x)^{-1} \pmod {x^{n&#x2F;2}}$</p>
<p>显然有$G(x)\equiv T(x)\pmod{x^{n&#x2F;2}}$</p>
<p>那么 $(G(x)-T(x))^2\equiv0\pmod{x^n}$</p>
<p>$G(x)^2-2G(x)T(x)+T(x)^2\equiv0\pmod{x^n}$</p>
<p>同乘$F(x)$</p>
<p>$R(x)-2G(x)-G(x)^2F(x)\equiv0\pmod{x^n}$</p>
<p>运用多项式乘法倍增即可</p>
<h2 id="多项式开根-9"><a href="#多项式开根-9" class="headerlink" title="多项式开根"></a>多项式开根</h2><p>给定$g(x)$ 求$f(x)$满足<br>$$<br>f^2(x)\equiv g(x)\pmod{x^n}<br>$$</p>
<h3 id="倍增法-19"><a href="#倍增法-19" class="headerlink" title="倍增法"></a>倍增法</h3><p>假设已求出$g(x)$在模$x^{[n&#x2F;2]}$意义下的平方根$f_0(x)$ 则有<br>$$<br>f_0^2(x)\equiv g(x) \pmod{x^{[n&#x2F;2]}}<br>\<br>f_0^2(x)-g(x)\equiv 0\pmod{x^{[n&#x2F;2]}}<br>\<br>(f_0^2(x)-g(x))^2\equiv 0\pmod{x^{n}}<br>\<br>(f_0^2(x)+g(x))^2\equiv 4f_0^2(x)g(x)\pmod{x^{n}}<br>\<br>(\frac{f_0^2(x)+g(x)}{2f_0(x)})\equiv g(x)\pmod{x^{n}}<br>\<br>\frac{f_0^2(x)+g(x)}{2f_0(x)}\equiv f(x) \pmod{x^n}<br>\<br>\frac 1 2f_0(x)+2^{-1}f_0^{-1}(x)g(x)\equiv f(x) \pmod{x^n}<br>$$</p>
<h2 id="多项式除法-9"><a href="#多项式除法-9" class="headerlink" title="多项式除法"></a>多项式除法</h2><p>给定多项式$f(x),g(x)$ 求$g(x)$除$f(x)$的商$q(x)$和余数$r(x)$</p>
<p>若能消去$r(x)$的影响则可直接多项式乘法逆</p>
<p>考虑构造<br>$$<br>f_r(x)&#x3D;x^nf(\frac 1 x)<br>$$<br>容易发现其为反转$f(x)$系数</p>
<p>设$n&#x3D;\deg f,m&#x3D;\deg g$</p>
<p>则<br>$$<br>f(x)&#x3D;q(x)g(x)+r(x)\Rightarrow<br>\<br>x^nf(\frac 1 x)&#x3D;x^{n-m}q(\frac 1 x)x^mg(\frac 1 x)+x^{n-m+1}x^{m-1}r(\frac 1 x)<br>\<br>f_r(x)&#x3D;q_r(x)g_r(x)+x^{n-m+1}r_r(x)<br>\<br>于是<br>\<br>f_r(x)\equiv q_r(x)g_r(x)\pmod{x^{n-m+1}}<br>$$<br>多项式求逆$g_r(x)$即可 然后求出$q_r(x)$和$r_r(x)$</p>
<h2 id="多项式ln-9"><a href="#多项式ln-9" class="headerlink" title="多项式ln"></a>多项式ln</h2><p>给定多项式$f(x)$ 求模$x^n$意义下$lnf(x)$</p>
<p>解法本质就是暴力</p>
<p>对多项式先求导再积分即可<br>$$<br>\frac {\text{d}\ln f(x)}{dx}\equiv \frac {1}{f(x)} f’(x)\pmod{x^n}<br>$$</p>
<h2 id="多项式牛顿迭代-9"><a href="#多项式牛顿迭代-9" class="headerlink" title="多项式牛顿迭代"></a>多项式牛顿迭代</h2><p>对于给定$g(x)$ 求$f(x)$ 使得其满足$g(f(x))\equiv 0 \pmod{ x^n}$</p>
<p>假设已经得到了模$x^{[n&#x2F;2]}$次方的解$f_0(x)$ 要求模$x^n$的解$f(x)$</p>
<p>跟据定义我们知道 $f(x)$与$f_0(x)$在前$[n&#x2F;2]-1$位上相等 </p>
<p>那么我们写出$g(f(x))$在$f_0(x)$处的泰勒展开 </p>
<p><img src="https://i.loli.net/2021/07/10/AreopyjgdDlhbU6.png" alt="image-20210710085546653"></p>
<p>发现从第三项往后全部被模掉了 没有意义 我们即可直接用牛顿迭代式计算</p>
<p><img src="https://i.loli.net/2021/07/10/jq9MTVmktfgHaus.png" alt="image-20210710085712805"></p>
<h3 id="应用-9"><a href="#应用-9" class="headerlink" title="应用"></a>应用</h3><h4 id="多项式求逆-9"><a href="#多项式求逆-9" class="headerlink" title="多项式求逆"></a>多项式求逆</h4><p>给定多项式$h(x)$ 有方程<br>$$<br>g(f(x))&#x3D;\frac1 {f(x)}-h(x)\equiv0\pmod0<br>$$<br>应用牛顿迭代有<br>$$<br>\begin{aligned}<br>    f\left(x\right)&amp;\equiv f_{0}\left(x\right)-\frac{\frac{1}{f_{0}\left(x\right)}-h\left(x\right)}{-\frac{1}{f_{0}^{2}\left(x\right)}}&amp;\pmod{x^{n}}\<br>    &amp;\equiv 2f_{0}\left(x\right)-f_{0}^{2}\left(x\right)h\left(x\right)&amp;\pmod{x^{n}}<br>\end{aligned}<br>$$</p>
<h4 id="多项式开方-9"><a href="#多项式开方-9" class="headerlink" title="多项式开方"></a>多项式开方</h4><p>给定多项式$h(x)$ 有方程<br>$$<br>g(f(x))&#x3D;f^2(x)-h(x)\equiv0\pmod{x^n}<br>$$<br>应用牛顿迭代有<br>$$<br>f(x)\equiv f_0(x)-\frac{f_0^2(x)-h(x)}{2f_0(x)}\pmod{x^n}<br>\<br>\equiv\frac{f_0^2(x)+h(x)}{2f_0(x)}\pmod{x^n}<br>$$</p>
<h4 id="多项式exp-9"><a href="#多项式exp-9" class="headerlink" title="多项式exp"></a>多项式exp</h4><p>给定多项式$h(x)$ 有方程<br>$$<br>g(f(x))&#x3D;\ln f(x)-h(x)\pmod {x^n}<br>$$<br>应用牛顿迭代有.<br>$$<br>f(x)\equiv f_0(x)-\frac{\ln f_0(x)-h(x)}{\frac1{f_0(x)}}<br>\<br>f_0(x)(1-ln f_0(x)+h(x))\pmod{x^n}  </p>
</section>
    <!-- Tags START -->
    
    <!-- Tags END -->
    <!-- NAV START -->
    
  <div class="nav-container">
    <!-- reverse left and right to put prev and next in a more logic postition -->
    
      <a class="nav-left" href="/2022/07/24/%E6%97%A5%E8%AE%B0/">
        <span class="nav-arrow">← </span>
        
          (untitled)
        
      </a>
    
    
      <a class="nav-right" href="/2022/07/24/%E5%86%B3%E7%AD%96%E5%8D%95%E8%B0%83%E6%80%A7%E4%BC%98%E5%8C%96/">
        
          (untitled)
        
        <span class="nav-arrow"> →</span>
      </a>
    
  </div>

    <!-- NAV END -->
    <!-- 打赏 START -->
    
    <!-- 打赏 END -->
    <!-- 二维码 START -->
    
    <!-- 二维码 END -->
    
      <!-- Utterances START -->
      <div id="utterances"></div>
      <script src="https://utteranc.es/client.js"
        repo="iinattr/comitForBlogs"
        issue-term="pathname"
        theme="github-light"
        crossorigin="anonymous"
        async></script>    
      <!-- Utterances END -->
    
  </article>
  <!-- Article END -->
  <!-- Catalog START -->
  
    <aside class="catalog-container">
  <div class="toc-main">
    <strong class="toc-title">Catalog</strong>
    
      <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#%E5%8F%AF%E8%83%BD%E6%98%AF%E5%A4%9A%E9%A1%B9%E5%BC%8F%E6%A8%A1%E6%9D%BF%E5%85%A8%E5%AE%B6%E6%A1%B6"><span class="toc-nav-text">可能是多项式模板全家桶</span></a></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#%E4%B8%8D%E5%88%B0-%E4%B8%87%E5%AD%97%E9%95%BF%E6%96%87"><span class="toc-nav-text">(不到)万字长文</span></a></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#%E6%88%96%E8%AE%B8%E6%98%AF%E8%BE%83%E5%A5%BD%E7%90%86%E8%A7%A3%E7%9A%84%E6%9D%BF%E5%AD%90%E8%AE%B2%E8%A7%A3"><span class="toc-nav-text">或许是较好理解的板子讲解</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86"><span class="toc-nav-text">前置知识:</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%A4%8D%E6%95%B0"><span class="toc-nav-text">复数</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E8%99%9A%E6%95%B0%E5%8D%95%E4%BD%8D"><span class="toc-nav-text">虚数单位</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%AE%9A%E4%B9%89"><span class="toc-nav-text">定义</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E8%BF%90%E7%AE%97"><span class="toc-nav-text">运算</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E5%8A%A0%E6%B3%95"><span class="toc-nav-text">加法</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E4%B9%98%E6%B3%95"><span class="toc-nav-text">乘法</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%8D%95%E4%BD%8D%E6%A0%B9"><span class="toc-nav-text">单位根</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%8E%9F%E6%A0%B9"><span class="toc-nav-text">原根</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E9%98%B6"><span class="toc-nav-text">阶</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%AE%9A%E4%B9%89-1"><span class="toc-nav-text">定义</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%80%A7%E8%B4%A8"><span class="toc-nav-text">性质</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E6%B3%B0%E5%8B%92%E5%B1%95%E5%BC%80"><span class="toc-nav-text">泰勒展开</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E7%89%9B%E9%A1%BF%E8%BF%AD%E4%BB%A3"><span class="toc-nav-text">牛顿迭代</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#FFT"><span class="toc-nav-text">FFT</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#DFT"><span class="toc-nav-text">DFT</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#IDFT"><span class="toc-nav-text">IDFT</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#NTT"><span class="toc-nav-text">NTT</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#FWT"><span class="toc-nav-text">FWT</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%80%9D%E6%83%B3%E4%B8%8E%E6%A6%82%E8%A7%88"><span class="toc-nav-text">基本思想与概览</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E4%B8%80%E4%BA%9B%E4%BE%8B%E5%AD%90"><span class="toc-nav-text">一些例子</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#Or%E5%8D%B7%E7%A7%AF"><span class="toc-nav-text">Or卷积</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#And%E5%8D%B7%E7%A7%AF"><span class="toc-nav-text">And卷积</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#Xor%E5%8D%B7%E7%A7%AF"><span class="toc-nav-text">Xor卷积</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E4%B9%98%E6%B3%95%E9%80%86"><span class="toc-nav-text">多项式乘法逆</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%80%8D%E5%A2%9E%E6%B3%95"><span class="toc-nav-text">倍增法</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E8%BE%B9%E7%95%8C"><span class="toc-nav-text">边界</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E8%BD%AC%E7%A7%BB"><span class="toc-nav-text">转移</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E5%BC%80%E6%A0%B9"><span class="toc-nav-text">多项式开根</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%80%8D%E5%A2%9E%E6%B3%95-1"><span class="toc-nav-text">倍增法</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E9%99%A4%E6%B3%95"><span class="toc-nav-text">多项式除法</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8Fln"><span class="toc-nav-text">多项式ln</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E7%89%9B%E9%A1%BF%E8%BF%AD%E4%BB%A3"><span class="toc-nav-text">多项式牛顿迭代</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%BA%94%E7%94%A8"><span class="toc-nav-text">应用</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E6%B1%82%E9%80%86"><span class="toc-nav-text">多项式求逆</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E5%BC%80%E6%96%B9"><span class="toc-nav-text">多项式开方</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8Fexp"><span class="toc-nav-text">多项式exp</span></a></li></ol></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#%E5%8F%AF%E8%83%BD%E6%98%AF%E5%A4%9A%E9%A1%B9%E5%BC%8F%E6%A8%A1%E6%9D%BF%E5%85%A8%E5%AE%B6%E6%A1%B6-1"><span class="toc-nav-text">可能是多项式模板全家桶</span></a></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#%E4%B8%8D%E5%88%B0-%E4%B8%87%E5%AD%97%E9%95%BF%E6%96%87-1"><span class="toc-nav-text">(不到)万字长文</span></a></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#%E6%88%96%E8%AE%B8%E6%98%AF%E8%BE%83%E5%A5%BD%E7%90%86%E8%A7%A3%E7%9A%84%E6%9D%BF%E5%AD%90%E8%AE%B2%E8%A7%A3-1"><span class="toc-nav-text">或许是较好理解的板子讲解</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86-1"><span class="toc-nav-text">前置知识:</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%A4%8D%E6%95%B0-1"><span class="toc-nav-text">复数</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E8%99%9A%E6%95%B0%E5%8D%95%E4%BD%8D-1"><span class="toc-nav-text">虚数单位</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%AE%9A%E4%B9%89-2"><span class="toc-nav-text">定义</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E8%BF%90%E7%AE%97-1"><span class="toc-nav-text">运算</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E5%8A%A0%E6%B3%95-1"><span class="toc-nav-text">加法</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E4%B9%98%E6%B3%95-1"><span class="toc-nav-text">乘法</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%8D%95%E4%BD%8D%E6%A0%B9-1"><span class="toc-nav-text">单位根</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%8E%9F%E6%A0%B9-1"><span class="toc-nav-text">原根</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E9%98%B6-1"><span class="toc-nav-text">阶</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%AE%9A%E4%B9%89-3"><span class="toc-nav-text">定义</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%80%A7%E8%B4%A8-1"><span class="toc-nav-text">性质</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E6%B3%B0%E5%8B%92%E5%B1%95%E5%BC%80-1"><span class="toc-nav-text">泰勒展开</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E7%89%9B%E9%A1%BF%E8%BF%AD%E4%BB%A3-1"><span class="toc-nav-text">牛顿迭代</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#FFT-1"><span class="toc-nav-text">FFT</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#DFT-1"><span class="toc-nav-text">DFT</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#IDFT-1"><span class="toc-nav-text">IDFT</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#NTT-1"><span class="toc-nav-text">NTT</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#FWT-1"><span class="toc-nav-text">FWT</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%80%9D%E6%83%B3%E4%B8%8E%E6%A6%82%E8%A7%88-1"><span class="toc-nav-text">基本思想与概览</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E4%B8%80%E4%BA%9B%E4%BE%8B%E5%AD%90-1"><span class="toc-nav-text">一些例子</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#Or%E5%8D%B7%E7%A7%AF-1"><span class="toc-nav-text">Or卷积</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#And%E5%8D%B7%E7%A7%AF-1"><span class="toc-nav-text">And卷积</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#Xor%E5%8D%B7%E7%A7%AF-1"><span class="toc-nav-text">Xor卷积</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E4%B9%98%E6%B3%95%E9%80%86-1"><span class="toc-nav-text">多项式乘法逆</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%80%8D%E5%A2%9E%E6%B3%95-2"><span class="toc-nav-text">倍增法</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E8%BE%B9%E7%95%8C-1"><span class="toc-nav-text">边界</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E8%BD%AC%E7%A7%BB-1"><span class="toc-nav-text">转移</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E5%BC%80%E6%A0%B9-1"><span class="toc-nav-text">多项式开根</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%80%8D%E5%A2%9E%E6%B3%95-3"><span class="toc-nav-text">倍增法</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E9%99%A4%E6%B3%95-1"><span class="toc-nav-text">多项式除法</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8Fln-1"><span class="toc-nav-text">多项式ln</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E7%89%9B%E9%A1%BF%E8%BF%AD%E4%BB%A3-1"><span class="toc-nav-text">多项式牛顿迭代</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%BA%94%E7%94%A8-1"><span class="toc-nav-text">应用</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E6%B1%82%E9%80%86-1"><span class="toc-nav-text">多项式求逆</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E5%BC%80%E6%96%B9-1"><span class="toc-nav-text">多项式开方</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8Fexp-1"><span class="toc-nav-text">多项式exp</span></a></li></ol></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#%E5%8F%AF%E8%83%BD%E6%98%AF%E5%A4%9A%E9%A1%B9%E5%BC%8F%E6%A8%A1%E6%9D%BF%E5%85%A8%E5%AE%B6%E6%A1%B6-2"><span class="toc-nav-text">可能是多项式模板全家桶</span></a></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#%E4%B8%8D%E5%88%B0-%E4%B8%87%E5%AD%97%E9%95%BF%E6%96%87-2"><span class="toc-nav-text">(不到)万字长文</span></a></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#%E6%88%96%E8%AE%B8%E6%98%AF%E8%BE%83%E5%A5%BD%E7%90%86%E8%A7%A3%E7%9A%84%E6%9D%BF%E5%AD%90%E8%AE%B2%E8%A7%A3-2"><span class="toc-nav-text">或许是较好理解的板子讲解</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86-2"><span class="toc-nav-text">前置知识:</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%A4%8D%E6%95%B0-2"><span class="toc-nav-text">复数</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E8%99%9A%E6%95%B0%E5%8D%95%E4%BD%8D-2"><span class="toc-nav-text">虚数单位</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%AE%9A%E4%B9%89-4"><span class="toc-nav-text">定义</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E8%BF%90%E7%AE%97-2"><span class="toc-nav-text">运算</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E5%8A%A0%E6%B3%95-2"><span class="toc-nav-text">加法</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E4%B9%98%E6%B3%95-2"><span class="toc-nav-text">乘法</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%8D%95%E4%BD%8D%E6%A0%B9-2"><span class="toc-nav-text">单位根</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%8E%9F%E6%A0%B9-2"><span class="toc-nav-text">原根</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E9%98%B6-2"><span class="toc-nav-text">阶</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%AE%9A%E4%B9%89-5"><span class="toc-nav-text">定义</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%80%A7%E8%B4%A8-2"><span class="toc-nav-text">性质</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E6%B3%B0%E5%8B%92%E5%B1%95%E5%BC%80-2"><span class="toc-nav-text">泰勒展开</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E7%89%9B%E9%A1%BF%E8%BF%AD%E4%BB%A3-2"><span class="toc-nav-text">牛顿迭代</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#FFT-2"><span class="toc-nav-text">FFT</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#DFT-2"><span class="toc-nav-text">DFT</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#IDFT-2"><span class="toc-nav-text">IDFT</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#NTT-2"><span class="toc-nav-text">NTT</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#FWT-2"><span class="toc-nav-text">FWT</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%80%9D%E6%83%B3%E4%B8%8E%E6%A6%82%E8%A7%88-2"><span class="toc-nav-text">基本思想与概览</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E4%B8%80%E4%BA%9B%E4%BE%8B%E5%AD%90-2"><span class="toc-nav-text">一些例子</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#Or%E5%8D%B7%E7%A7%AF-2"><span class="toc-nav-text">Or卷积</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#And%E5%8D%B7%E7%A7%AF-2"><span class="toc-nav-text">And卷积</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#Xor%E5%8D%B7%E7%A7%AF-2"><span class="toc-nav-text">Xor卷积</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E4%B9%98%E6%B3%95%E9%80%86-2"><span class="toc-nav-text">多项式乘法逆</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%80%8D%E5%A2%9E%E6%B3%95-4"><span class="toc-nav-text">倍增法</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E8%BE%B9%E7%95%8C-2"><span class="toc-nav-text">边界</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E8%BD%AC%E7%A7%BB-2"><span class="toc-nav-text">转移</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E5%BC%80%E6%A0%B9-2"><span class="toc-nav-text">多项式开根</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%80%8D%E5%A2%9E%E6%B3%95-5"><span class="toc-nav-text">倍增法</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E9%99%A4%E6%B3%95-2"><span class="toc-nav-text">多项式除法</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8Fln-2"><span class="toc-nav-text">多项式ln</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E7%89%9B%E9%A1%BF%E8%BF%AD%E4%BB%A3-2"><span class="toc-nav-text">多项式牛顿迭代</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%BA%94%E7%94%A8-2"><span class="toc-nav-text">应用</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E6%B1%82%E9%80%86-2"><span class="toc-nav-text">多项式求逆</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E5%BC%80%E6%96%B9-2"><span class="toc-nav-text">多项式开方</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8Fexp-2"><span class="toc-nav-text">多项式exp</span></a></li></ol></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#%E5%8F%AF%E8%83%BD%E6%98%AF%E5%A4%9A%E9%A1%B9%E5%BC%8F%E6%A8%A1%E6%9D%BF%E5%85%A8%E5%AE%B6%E6%A1%B6-3"><span class="toc-nav-text">可能是多项式模板全家桶</span></a></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#%E4%B8%8D%E5%88%B0-%E4%B8%87%E5%AD%97%E9%95%BF%E6%96%87-3"><span class="toc-nav-text">(不到)万字长文</span></a></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#%E6%88%96%E8%AE%B8%E6%98%AF%E8%BE%83%E5%A5%BD%E7%90%86%E8%A7%A3%E7%9A%84%E6%9D%BF%E5%AD%90%E8%AE%B2%E8%A7%A3-3"><span class="toc-nav-text">或许是较好理解的板子讲解</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86-3"><span class="toc-nav-text">前置知识:</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%A4%8D%E6%95%B0-3"><span class="toc-nav-text">复数</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E8%99%9A%E6%95%B0%E5%8D%95%E4%BD%8D-3"><span class="toc-nav-text">虚数单位</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%AE%9A%E4%B9%89-6"><span class="toc-nav-text">定义</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E8%BF%90%E7%AE%97-3"><span class="toc-nav-text">运算</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E5%8A%A0%E6%B3%95-3"><span class="toc-nav-text">加法</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E4%B9%98%E6%B3%95-3"><span class="toc-nav-text">乘法</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%8D%95%E4%BD%8D%E6%A0%B9-3"><span class="toc-nav-text">单位根</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%8E%9F%E6%A0%B9-3"><span class="toc-nav-text">原根</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E9%98%B6-3"><span class="toc-nav-text">阶</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%AE%9A%E4%B9%89-7"><span class="toc-nav-text">定义</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%80%A7%E8%B4%A8-3"><span class="toc-nav-text">性质</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E6%B3%B0%E5%8B%92%E5%B1%95%E5%BC%80-3"><span class="toc-nav-text">泰勒展开</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E7%89%9B%E9%A1%BF%E8%BF%AD%E4%BB%A3-3"><span class="toc-nav-text">牛顿迭代</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#FFT-3"><span class="toc-nav-text">FFT</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#DFT-3"><span class="toc-nav-text">DFT</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#IDFT-3"><span class="toc-nav-text">IDFT</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#NTT-3"><span class="toc-nav-text">NTT</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#FWT-3"><span class="toc-nav-text">FWT</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%80%9D%E6%83%B3%E4%B8%8E%E6%A6%82%E8%A7%88-3"><span class="toc-nav-text">基本思想与概览</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E4%B8%80%E4%BA%9B%E4%BE%8B%E5%AD%90-3"><span class="toc-nav-text">一些例子</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#Or%E5%8D%B7%E7%A7%AF-3"><span class="toc-nav-text">Or卷积</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#And%E5%8D%B7%E7%A7%AF-3"><span class="toc-nav-text">And卷积</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#Xor%E5%8D%B7%E7%A7%AF-3"><span class="toc-nav-text">Xor卷积</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E4%B9%98%E6%B3%95%E9%80%86-3"><span class="toc-nav-text">多项式乘法逆</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%80%8D%E5%A2%9E%E6%B3%95-6"><span class="toc-nav-text">倍增法</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E8%BE%B9%E7%95%8C-3"><span class="toc-nav-text">边界</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E8%BD%AC%E7%A7%BB-3"><span class="toc-nav-text">转移</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E5%BC%80%E6%A0%B9-3"><span class="toc-nav-text">多项式开根</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%80%8D%E5%A2%9E%E6%B3%95-7"><span class="toc-nav-text">倍增法</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E9%99%A4%E6%B3%95-3"><span class="toc-nav-text">多项式除法</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8Fln-3"><span class="toc-nav-text">多项式ln</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E7%89%9B%E9%A1%BF%E8%BF%AD%E4%BB%A3-3"><span class="toc-nav-text">多项式牛顿迭代</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%BA%94%E7%94%A8-3"><span class="toc-nav-text">应用</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E6%B1%82%E9%80%86-3"><span class="toc-nav-text">多项式求逆</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E5%BC%80%E6%96%B9-3"><span class="toc-nav-text">多项式开方</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8Fexp-3"><span class="toc-nav-text">多项式exp</span></a></li></ol></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#%E5%8F%AF%E8%83%BD%E6%98%AF%E5%A4%9A%E9%A1%B9%E5%BC%8F%E6%A8%A1%E6%9D%BF%E5%85%A8%E5%AE%B6%E6%A1%B6-4"><span class="toc-nav-text">可能是多项式模板全家桶</span></a></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#%E4%B8%8D%E5%88%B0-%E4%B8%87%E5%AD%97%E9%95%BF%E6%96%87-4"><span class="toc-nav-text">(不到)万字长文</span></a></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#%E6%88%96%E8%AE%B8%E6%98%AF%E8%BE%83%E5%A5%BD%E7%90%86%E8%A7%A3%E7%9A%84%E6%9D%BF%E5%AD%90%E8%AE%B2%E8%A7%A3-4"><span class="toc-nav-text">或许是较好理解的板子讲解</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86-4"><span class="toc-nav-text">前置知识:</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%A4%8D%E6%95%B0-4"><span class="toc-nav-text">复数</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E8%99%9A%E6%95%B0%E5%8D%95%E4%BD%8D-4"><span class="toc-nav-text">虚数单位</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%AE%9A%E4%B9%89-8"><span class="toc-nav-text">定义</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E8%BF%90%E7%AE%97-4"><span class="toc-nav-text">运算</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E5%8A%A0%E6%B3%95-4"><span class="toc-nav-text">加法</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E4%B9%98%E6%B3%95-4"><span class="toc-nav-text">乘法</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%8D%95%E4%BD%8D%E6%A0%B9-4"><span class="toc-nav-text">单位根</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%8E%9F%E6%A0%B9-4"><span class="toc-nav-text">原根</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E9%98%B6-4"><span class="toc-nav-text">阶</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%AE%9A%E4%B9%89-9"><span class="toc-nav-text">定义</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%80%A7%E8%B4%A8-4"><span class="toc-nav-text">性质</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E6%B3%B0%E5%8B%92%E5%B1%95%E5%BC%80-4"><span class="toc-nav-text">泰勒展开</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E7%89%9B%E9%A1%BF%E8%BF%AD%E4%BB%A3-4"><span class="toc-nav-text">牛顿迭代</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#FFT-4"><span class="toc-nav-text">FFT</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#DFT-4"><span class="toc-nav-text">DFT</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#IDFT-4"><span class="toc-nav-text">IDFT</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#NTT-4"><span class="toc-nav-text">NTT</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#FWT-4"><span class="toc-nav-text">FWT</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%80%9D%E6%83%B3%E4%B8%8E%E6%A6%82%E8%A7%88-4"><span class="toc-nav-text">基本思想与概览</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E4%B8%80%E4%BA%9B%E4%BE%8B%E5%AD%90-4"><span class="toc-nav-text">一些例子</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#Or%E5%8D%B7%E7%A7%AF-4"><span class="toc-nav-text">Or卷积</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#And%E5%8D%B7%E7%A7%AF-4"><span class="toc-nav-text">And卷积</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#Xor%E5%8D%B7%E7%A7%AF-4"><span class="toc-nav-text">Xor卷积</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E4%B9%98%E6%B3%95%E9%80%86-4"><span class="toc-nav-text">多项式乘法逆</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%80%8D%E5%A2%9E%E6%B3%95-8"><span class="toc-nav-text">倍增法</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E8%BE%B9%E7%95%8C-4"><span class="toc-nav-text">边界</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E8%BD%AC%E7%A7%BB-4"><span class="toc-nav-text">转移</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E5%BC%80%E6%A0%B9-4"><span class="toc-nav-text">多项式开根</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%80%8D%E5%A2%9E%E6%B3%95-9"><span class="toc-nav-text">倍增法</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E9%99%A4%E6%B3%95-4"><span class="toc-nav-text">多项式除法</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8Fln-4"><span class="toc-nav-text">多项式ln</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E7%89%9B%E9%A1%BF%E8%BF%AD%E4%BB%A3-4"><span class="toc-nav-text">多项式牛顿迭代</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%BA%94%E7%94%A8-4"><span class="toc-nav-text">应用</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E6%B1%82%E9%80%86-4"><span class="toc-nav-text">多项式求逆</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E5%BC%80%E6%96%B9-4"><span class="toc-nav-text">多项式开方</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8Fexp-4"><span class="toc-nav-text">多项式exp</span></a></li></ol></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#%E5%8F%AF%E8%83%BD%E6%98%AF%E5%A4%9A%E9%A1%B9%E5%BC%8F%E6%A8%A1%E6%9D%BF%E5%85%A8%E5%AE%B6%E6%A1%B6-5"><span class="toc-nav-text">可能是多项式模板全家桶</span></a></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#%E4%B8%8D%E5%88%B0-%E4%B8%87%E5%AD%97%E9%95%BF%E6%96%87-5"><span class="toc-nav-text">(不到)万字长文</span></a></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#%E6%88%96%E8%AE%B8%E6%98%AF%E8%BE%83%E5%A5%BD%E7%90%86%E8%A7%A3%E7%9A%84%E6%9D%BF%E5%AD%90%E8%AE%B2%E8%A7%A3-5"><span class="toc-nav-text">或许是较好理解的板子讲解</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86-5"><span class="toc-nav-text">前置知识:</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%A4%8D%E6%95%B0-5"><span class="toc-nav-text">复数</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E8%99%9A%E6%95%B0%E5%8D%95%E4%BD%8D-5"><span class="toc-nav-text">虚数单位</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%AE%9A%E4%B9%89-10"><span class="toc-nav-text">定义</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E8%BF%90%E7%AE%97-5"><span class="toc-nav-text">运算</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E5%8A%A0%E6%B3%95-5"><span class="toc-nav-text">加法</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E4%B9%98%E6%B3%95-5"><span class="toc-nav-text">乘法</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%8D%95%E4%BD%8D%E6%A0%B9-5"><span class="toc-nav-text">单位根</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%8E%9F%E6%A0%B9-5"><span class="toc-nav-text">原根</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E9%98%B6-5"><span class="toc-nav-text">阶</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%AE%9A%E4%B9%89-11"><span class="toc-nav-text">定义</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%80%A7%E8%B4%A8-5"><span class="toc-nav-text">性质</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E6%B3%B0%E5%8B%92%E5%B1%95%E5%BC%80-5"><span class="toc-nav-text">泰勒展开</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E7%89%9B%E9%A1%BF%E8%BF%AD%E4%BB%A3-5"><span class="toc-nav-text">牛顿迭代</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#FFT-5"><span class="toc-nav-text">FFT</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#DFT-5"><span class="toc-nav-text">DFT</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#IDFT-5"><span class="toc-nav-text">IDFT</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#NTT-5"><span class="toc-nav-text">NTT</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#FWT-5"><span class="toc-nav-text">FWT</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%80%9D%E6%83%B3%E4%B8%8E%E6%A6%82%E8%A7%88-5"><span class="toc-nav-text">基本思想与概览</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E4%B8%80%E4%BA%9B%E4%BE%8B%E5%AD%90-5"><span class="toc-nav-text">一些例子</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#Or%E5%8D%B7%E7%A7%AF-5"><span class="toc-nav-text">Or卷积</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#And%E5%8D%B7%E7%A7%AF-5"><span class="toc-nav-text">And卷积</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#Xor%E5%8D%B7%E7%A7%AF-5"><span class="toc-nav-text">Xor卷积</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E4%B9%98%E6%B3%95%E9%80%86-5"><span class="toc-nav-text">多项式乘法逆</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%80%8D%E5%A2%9E%E6%B3%95-10"><span class="toc-nav-text">倍增法</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E8%BE%B9%E7%95%8C-5"><span class="toc-nav-text">边界</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E8%BD%AC%E7%A7%BB-5"><span class="toc-nav-text">转移</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E5%BC%80%E6%A0%B9-5"><span class="toc-nav-text">多项式开根</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%80%8D%E5%A2%9E%E6%B3%95-11"><span class="toc-nav-text">倍增法</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E9%99%A4%E6%B3%95-5"><span class="toc-nav-text">多项式除法</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8Fln-5"><span class="toc-nav-text">多项式ln</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E7%89%9B%E9%A1%BF%E8%BF%AD%E4%BB%A3-5"><span class="toc-nav-text">多项式牛顿迭代</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%BA%94%E7%94%A8-5"><span class="toc-nav-text">应用</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E6%B1%82%E9%80%86-5"><span class="toc-nav-text">多项式求逆</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E5%BC%80%E6%96%B9-5"><span class="toc-nav-text">多项式开方</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8Fexp-5"><span class="toc-nav-text">多项式exp</span></a></li></ol></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#%E5%8F%AF%E8%83%BD%E6%98%AF%E5%A4%9A%E9%A1%B9%E5%BC%8F%E6%A8%A1%E6%9D%BF%E5%85%A8%E5%AE%B6%E6%A1%B6-6"><span class="toc-nav-text">可能是多项式模板全家桶</span></a></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#%E4%B8%8D%E5%88%B0-%E4%B8%87%E5%AD%97%E9%95%BF%E6%96%87-6"><span class="toc-nav-text">(不到)万字长文</span></a></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#%E6%88%96%E8%AE%B8%E6%98%AF%E8%BE%83%E5%A5%BD%E7%90%86%E8%A7%A3%E7%9A%84%E6%9D%BF%E5%AD%90%E8%AE%B2%E8%A7%A3-6"><span class="toc-nav-text">或许是较好理解的板子讲解</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86-6"><span class="toc-nav-text">前置知识:</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%A4%8D%E6%95%B0-6"><span class="toc-nav-text">复数</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E8%99%9A%E6%95%B0%E5%8D%95%E4%BD%8D-6"><span class="toc-nav-text">虚数单位</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%AE%9A%E4%B9%89-12"><span class="toc-nav-text">定义</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E8%BF%90%E7%AE%97-6"><span class="toc-nav-text">运算</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E5%8A%A0%E6%B3%95-6"><span class="toc-nav-text">加法</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E4%B9%98%E6%B3%95-6"><span class="toc-nav-text">乘法</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%8D%95%E4%BD%8D%E6%A0%B9-6"><span class="toc-nav-text">单位根</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%8E%9F%E6%A0%B9-6"><span class="toc-nav-text">原根</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E9%98%B6-6"><span class="toc-nav-text">阶</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%AE%9A%E4%B9%89-13"><span class="toc-nav-text">定义</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%80%A7%E8%B4%A8-6"><span class="toc-nav-text">性质</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E6%B3%B0%E5%8B%92%E5%B1%95%E5%BC%80-6"><span class="toc-nav-text">泰勒展开</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E7%89%9B%E9%A1%BF%E8%BF%AD%E4%BB%A3-6"><span class="toc-nav-text">牛顿迭代</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#FFT-6"><span class="toc-nav-text">FFT</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#DFT-6"><span class="toc-nav-text">DFT</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#IDFT-6"><span class="toc-nav-text">IDFT</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#NTT-6"><span class="toc-nav-text">NTT</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#FWT-6"><span class="toc-nav-text">FWT</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%80%9D%E6%83%B3%E4%B8%8E%E6%A6%82%E8%A7%88-6"><span class="toc-nav-text">基本思想与概览</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E4%B8%80%E4%BA%9B%E4%BE%8B%E5%AD%90-6"><span class="toc-nav-text">一些例子</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#Or%E5%8D%B7%E7%A7%AF-6"><span class="toc-nav-text">Or卷积</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#And%E5%8D%B7%E7%A7%AF-6"><span class="toc-nav-text">And卷积</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#Xor%E5%8D%B7%E7%A7%AF-6"><span class="toc-nav-text">Xor卷积</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E4%B9%98%E6%B3%95%E9%80%86-6"><span class="toc-nav-text">多项式乘法逆</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%80%8D%E5%A2%9E%E6%B3%95-12"><span class="toc-nav-text">倍增法</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E8%BE%B9%E7%95%8C-6"><span class="toc-nav-text">边界</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E8%BD%AC%E7%A7%BB-6"><span class="toc-nav-text">转移</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E5%BC%80%E6%A0%B9-6"><span class="toc-nav-text">多项式开根</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%80%8D%E5%A2%9E%E6%B3%95-13"><span class="toc-nav-text">倍增法</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E9%99%A4%E6%B3%95-6"><span class="toc-nav-text">多项式除法</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8Fln-6"><span class="toc-nav-text">多项式ln</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E7%89%9B%E9%A1%BF%E8%BF%AD%E4%BB%A3-6"><span class="toc-nav-text">多项式牛顿迭代</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%BA%94%E7%94%A8-6"><span class="toc-nav-text">应用</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E6%B1%82%E9%80%86-6"><span class="toc-nav-text">多项式求逆</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E5%BC%80%E6%96%B9-6"><span class="toc-nav-text">多项式开方</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8Fexp-6"><span class="toc-nav-text">多项式exp</span></a></li></ol></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#%E5%8F%AF%E8%83%BD%E6%98%AF%E5%A4%9A%E9%A1%B9%E5%BC%8F%E6%A8%A1%E6%9D%BF%E5%85%A8%E5%AE%B6%E6%A1%B6-7"><span class="toc-nav-text">可能是多项式模板全家桶</span></a></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#%E4%B8%8D%E5%88%B0-%E4%B8%87%E5%AD%97%E9%95%BF%E6%96%87-7"><span class="toc-nav-text">(不到)万字长文</span></a></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#%E6%88%96%E8%AE%B8%E6%98%AF%E8%BE%83%E5%A5%BD%E7%90%86%E8%A7%A3%E7%9A%84%E6%9D%BF%E5%AD%90%E8%AE%B2%E8%A7%A3-7"><span class="toc-nav-text">或许是较好理解的板子讲解</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86-7"><span class="toc-nav-text">前置知识:</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%A4%8D%E6%95%B0-7"><span class="toc-nav-text">复数</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E8%99%9A%E6%95%B0%E5%8D%95%E4%BD%8D-7"><span class="toc-nav-text">虚数单位</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%AE%9A%E4%B9%89-14"><span class="toc-nav-text">定义</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E8%BF%90%E7%AE%97-7"><span class="toc-nav-text">运算</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E5%8A%A0%E6%B3%95-7"><span class="toc-nav-text">加法</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E4%B9%98%E6%B3%95-7"><span class="toc-nav-text">乘法</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%8D%95%E4%BD%8D%E6%A0%B9-7"><span class="toc-nav-text">单位根</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%8E%9F%E6%A0%B9-7"><span class="toc-nav-text">原根</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E9%98%B6-7"><span class="toc-nav-text">阶</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%AE%9A%E4%B9%89-15"><span class="toc-nav-text">定义</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%80%A7%E8%B4%A8-7"><span class="toc-nav-text">性质</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E6%B3%B0%E5%8B%92%E5%B1%95%E5%BC%80-7"><span class="toc-nav-text">泰勒展开</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E7%89%9B%E9%A1%BF%E8%BF%AD%E4%BB%A3-7"><span class="toc-nav-text">牛顿迭代</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#FFT-7"><span class="toc-nav-text">FFT</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#DFT-7"><span class="toc-nav-text">DFT</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#IDFT-7"><span class="toc-nav-text">IDFT</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#NTT-7"><span class="toc-nav-text">NTT</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#FWT-7"><span class="toc-nav-text">FWT</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%80%9D%E6%83%B3%E4%B8%8E%E6%A6%82%E8%A7%88-7"><span class="toc-nav-text">基本思想与概览</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E4%B8%80%E4%BA%9B%E4%BE%8B%E5%AD%90-7"><span class="toc-nav-text">一些例子</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#Or%E5%8D%B7%E7%A7%AF-7"><span class="toc-nav-text">Or卷积</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#And%E5%8D%B7%E7%A7%AF-7"><span class="toc-nav-text">And卷积</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#Xor%E5%8D%B7%E7%A7%AF-7"><span class="toc-nav-text">Xor卷积</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E4%B9%98%E6%B3%95%E9%80%86-7"><span class="toc-nav-text">多项式乘法逆</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%80%8D%E5%A2%9E%E6%B3%95-14"><span class="toc-nav-text">倍增法</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E8%BE%B9%E7%95%8C-7"><span class="toc-nav-text">边界</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E8%BD%AC%E7%A7%BB-7"><span class="toc-nav-text">转移</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E5%BC%80%E6%A0%B9-7"><span class="toc-nav-text">多项式开根</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%80%8D%E5%A2%9E%E6%B3%95-15"><span class="toc-nav-text">倍增法</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E9%99%A4%E6%B3%95-7"><span class="toc-nav-text">多项式除法</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8Fln-7"><span class="toc-nav-text">多项式ln</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E7%89%9B%E9%A1%BF%E8%BF%AD%E4%BB%A3-7"><span class="toc-nav-text">多项式牛顿迭代</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%BA%94%E7%94%A8-7"><span class="toc-nav-text">应用</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E6%B1%82%E9%80%86-7"><span class="toc-nav-text">多项式求逆</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E5%BC%80%E6%96%B9-7"><span class="toc-nav-text">多项式开方</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8Fexp-7"><span class="toc-nav-text">多项式exp</span></a></li></ol></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#%E5%8F%AF%E8%83%BD%E6%98%AF%E5%A4%9A%E9%A1%B9%E5%BC%8F%E6%A8%A1%E6%9D%BF%E5%85%A8%E5%AE%B6%E6%A1%B6-8"><span class="toc-nav-text">可能是多项式模板全家桶</span></a></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#%E4%B8%8D%E5%88%B0-%E4%B8%87%E5%AD%97%E9%95%BF%E6%96%87-8"><span class="toc-nav-text">(不到)万字长文</span></a></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#%E6%88%96%E8%AE%B8%E6%98%AF%E8%BE%83%E5%A5%BD%E7%90%86%E8%A7%A3%E7%9A%84%E6%9D%BF%E5%AD%90%E8%AE%B2%E8%A7%A3-8"><span class="toc-nav-text">或许是较好理解的板子讲解</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86-8"><span class="toc-nav-text">前置知识:</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%A4%8D%E6%95%B0-8"><span class="toc-nav-text">复数</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E8%99%9A%E6%95%B0%E5%8D%95%E4%BD%8D-8"><span class="toc-nav-text">虚数单位</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%AE%9A%E4%B9%89-16"><span class="toc-nav-text">定义</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E8%BF%90%E7%AE%97-8"><span class="toc-nav-text">运算</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E5%8A%A0%E6%B3%95-8"><span class="toc-nav-text">加法</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E4%B9%98%E6%B3%95-8"><span class="toc-nav-text">乘法</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%8D%95%E4%BD%8D%E6%A0%B9-8"><span class="toc-nav-text">单位根</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%8E%9F%E6%A0%B9-8"><span class="toc-nav-text">原根</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E9%98%B6-8"><span class="toc-nav-text">阶</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%AE%9A%E4%B9%89-17"><span class="toc-nav-text">定义</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%80%A7%E8%B4%A8-8"><span class="toc-nav-text">性质</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E6%B3%B0%E5%8B%92%E5%B1%95%E5%BC%80-8"><span class="toc-nav-text">泰勒展开</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E7%89%9B%E9%A1%BF%E8%BF%AD%E4%BB%A3-8"><span class="toc-nav-text">牛顿迭代</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#FFT-8"><span class="toc-nav-text">FFT</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#DFT-8"><span class="toc-nav-text">DFT</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#IDFT-8"><span class="toc-nav-text">IDFT</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#NTT-8"><span class="toc-nav-text">NTT</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#FWT-8"><span class="toc-nav-text">FWT</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%80%9D%E6%83%B3%E4%B8%8E%E6%A6%82%E8%A7%88-8"><span class="toc-nav-text">基本思想与概览</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E4%B8%80%E4%BA%9B%E4%BE%8B%E5%AD%90-8"><span class="toc-nav-text">一些例子</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#Or%E5%8D%B7%E7%A7%AF-8"><span class="toc-nav-text">Or卷积</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#And%E5%8D%B7%E7%A7%AF-8"><span class="toc-nav-text">And卷积</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#Xor%E5%8D%B7%E7%A7%AF-8"><span class="toc-nav-text">Xor卷积</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E4%B9%98%E6%B3%95%E9%80%86-8"><span class="toc-nav-text">多项式乘法逆</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%80%8D%E5%A2%9E%E6%B3%95-16"><span class="toc-nav-text">倍增法</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E8%BE%B9%E7%95%8C-8"><span class="toc-nav-text">边界</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E8%BD%AC%E7%A7%BB-8"><span class="toc-nav-text">转移</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E5%BC%80%E6%A0%B9-8"><span class="toc-nav-text">多项式开根</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%80%8D%E5%A2%9E%E6%B3%95-17"><span class="toc-nav-text">倍增法</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E9%99%A4%E6%B3%95-8"><span class="toc-nav-text">多项式除法</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8Fln-8"><span class="toc-nav-text">多项式ln</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E7%89%9B%E9%A1%BF%E8%BF%AD%E4%BB%A3-8"><span class="toc-nav-text">多项式牛顿迭代</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%BA%94%E7%94%A8-8"><span class="toc-nav-text">应用</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E6%B1%82%E9%80%86-8"><span class="toc-nav-text">多项式求逆</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E5%BC%80%E6%96%B9-8"><span class="toc-nav-text">多项式开方</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8Fexp-8"><span class="toc-nav-text">多项式exp</span></a></li></ol></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#%E5%8F%AF%E8%83%BD%E6%98%AF%E5%A4%9A%E9%A1%B9%E5%BC%8F%E6%A8%A1%E6%9D%BF%E5%85%A8%E5%AE%B6%E6%A1%B6-9"><span class="toc-nav-text">可能是多项式模板全家桶</span></a></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#%E4%B8%8D%E5%88%B0-%E4%B8%87%E5%AD%97%E9%95%BF%E6%96%87-9"><span class="toc-nav-text">(不到)万字长文</span></a></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#%E6%88%96%E8%AE%B8%E6%98%AF%E8%BE%83%E5%A5%BD%E7%90%86%E8%A7%A3%E7%9A%84%E6%9D%BF%E5%AD%90%E8%AE%B2%E8%A7%A3-9"><span class="toc-nav-text">或许是较好理解的板子讲解</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86-9"><span class="toc-nav-text">前置知识:</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%A4%8D%E6%95%B0-9"><span class="toc-nav-text">复数</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E8%99%9A%E6%95%B0%E5%8D%95%E4%BD%8D-9"><span class="toc-nav-text">虚数单位</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%AE%9A%E4%B9%89-18"><span class="toc-nav-text">定义</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E8%BF%90%E7%AE%97-9"><span class="toc-nav-text">运算</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E5%8A%A0%E6%B3%95-9"><span class="toc-nav-text">加法</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E4%B9%98%E6%B3%95-9"><span class="toc-nav-text">乘法</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%8D%95%E4%BD%8D%E6%A0%B9-9"><span class="toc-nav-text">单位根</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%8E%9F%E6%A0%B9-9"><span class="toc-nav-text">原根</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E9%98%B6-9"><span class="toc-nav-text">阶</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%AE%9A%E4%B9%89-19"><span class="toc-nav-text">定义</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%80%A7%E8%B4%A8-9"><span class="toc-nav-text">性质</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E6%B3%B0%E5%8B%92%E5%B1%95%E5%BC%80-9"><span class="toc-nav-text">泰勒展开</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E7%89%9B%E9%A1%BF%E8%BF%AD%E4%BB%A3-9"><span class="toc-nav-text">牛顿迭代</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#FFT-9"><span class="toc-nav-text">FFT</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#DFT-9"><span class="toc-nav-text">DFT</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#IDFT-9"><span class="toc-nav-text">IDFT</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#NTT-9"><span class="toc-nav-text">NTT</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#FWT-9"><span class="toc-nav-text">FWT</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%80%9D%E6%83%B3%E4%B8%8E%E6%A6%82%E8%A7%88-9"><span class="toc-nav-text">基本思想与概览</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E4%B8%80%E4%BA%9B%E4%BE%8B%E5%AD%90-9"><span class="toc-nav-text">一些例子</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#Or%E5%8D%B7%E7%A7%AF-9"><span class="toc-nav-text">Or卷积</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#And%E5%8D%B7%E7%A7%AF-9"><span class="toc-nav-text">And卷积</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#Xor%E5%8D%B7%E7%A7%AF-9"><span class="toc-nav-text">Xor卷积</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E4%B9%98%E6%B3%95%E9%80%86-9"><span class="toc-nav-text">多项式乘法逆</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%80%8D%E5%A2%9E%E6%B3%95-18"><span class="toc-nav-text">倍增法</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E8%BE%B9%E7%95%8C-9"><span class="toc-nav-text">边界</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E8%BD%AC%E7%A7%BB-9"><span class="toc-nav-text">转移</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E5%BC%80%E6%A0%B9-9"><span class="toc-nav-text">多项式开根</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%80%8D%E5%A2%9E%E6%B3%95-19"><span class="toc-nav-text">倍增法</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E9%99%A4%E6%B3%95-9"><span class="toc-nav-text">多项式除法</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8Fln-9"><span class="toc-nav-text">多项式ln</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E7%89%9B%E9%A1%BF%E8%BF%AD%E4%BB%A3-9"><span class="toc-nav-text">多项式牛顿迭代</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%BA%94%E7%94%A8-9"><span class="toc-nav-text">应用</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E6%B1%82%E9%80%86-9"><span class="toc-nav-text">多项式求逆</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E5%BC%80%E6%96%B9-9"><span class="toc-nav-text">多项式开方</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8Fexp-9"><span class="toc-nav-text">多项式exp</span></a></li></ol></li></ol></li></ol></li></ol>
    
  </div>
</aside>
  
  <!-- Catalog END -->
</main>

<script>
  (function () {
    var url = 'http://iinattr.username.github.io/2022/07/24/可能是多项式模板全家桶/';
    var banner = ''
    if (banner !== '' && banner !== 'undefined' && banner !== 'null') {
      $('#article-banner').css({
        'background-image': 'url(' + banner + ')'
      })
    } else {
      $('#article-banner').geopattern(url)
    }
    $('.header').removeClass('fixed-header')

    // error image
    $(".markdown-content img").on('error', function() {
      $(this).attr('src', '/css/images/error_icon.png')
      $(this).css({
        'cursor': 'default'
      })
    })

    // zoom image
    $(".markdown-content img").on('click', function() {
      var src = $(this).attr('src')
      if (src !== '/css/images/error_icon.png') {
        var imageW = $(this).width()
        var imageH = $(this).height()

        var zoom = ($(window).width() * 0.95 / imageW).toFixed(2)
        zoom = zoom < 1 ? 1 : zoom
        zoom = zoom > 2 ? 2 : zoom
        var transY = (($(window).height() - imageH) / 2).toFixed(2)

        $('body').append('<div class="image-view-wrap"><div class="image-view-inner"><img src="'+ src +'" /></div></div>')
        $('.image-view-wrap').addClass('wrap-active')
        $('.image-view-wrap img').css({
          'width': `${imageW}`,
          'transform': `translate3d(0, ${transY}px, 0) scale3d(${zoom}, ${zoom}, 1)`
        })
        $('html').css('overflow', 'hidden')

        $('.image-view-wrap').on('click', function() {
          $(this).remove()
          $('html').attr('style', '')
        })
      }
    })
  })();
</script>







    <div class="scroll-top">
  <span class="arrow-icon"></span>
</div>
    <footer class="app-footer">
  <p class="copyright">
    &copy; 2022 | Proudly powered by <a href="https://hexo.io" target="_blank">Hexo</a>
    <br>
    Theme by <a target="_blank" rel="noopener" href="https://github.com/yanm1ng">yanm1ng</a>
    
  </p>
</footer>

<script>
  function async(u, c) {
    var d = document, t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
    s.parentNode.insertBefore(o, s);
  }
</script>
<script>
  async("//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js", function(){
    FastClick.attach(document.body);
  })
</script>

<script>
  var hasLine = 'true';
  async("//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js", function(){
    $('figure pre').each(function(i, block) {
      var figure = $(this).parents('figure');
      if (hasLine === 'false') {
        figure.find('.gutter').hide();
      }
      hljs.configure({useBR: true});
      var lang = figure.attr('class').split(' ')[1] || 'code';
      var codeHtml = $(this).html();
      var codeTag = document.createElement('code');
      codeTag.className = lang;
      codeTag.innerHTML = codeHtml;
      $(this).attr('class', '').empty().html(codeTag);
      figure.attr('data-lang', lang.toUpperCase());
      hljs.highlightBlock(block);
    });
  })
</script>
<!-- Baidu Tongji -->


<script src="/js/script.js"></script>


  </body>
</html>